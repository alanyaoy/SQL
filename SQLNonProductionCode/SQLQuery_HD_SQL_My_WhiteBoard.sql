
 --------------------------------------  WhiteBoard  -----------------------------------------------

  ---=================How to Skip SQL Query --- Method 3   30/7/2018= ========================================= 
 --https://stackoverflow.com/questions/659188/sql-server-stop-or-break-execution-of-a-sql-script?noredirect=1&lq=1

print 'hi'
go

print 'Fatal error, script will not continue!'

set noexec on
print 'ho'
go


use JDE_DB_Alan
go


---  42.210.031   ---


SELECT c.local_net_address
FROM sys.dm_exec_connections AS c
WHERE c.session_id = @@SPID;

SELECT TOP(1) c.local_net_address
FROM sys.dm_exec_connections AS c
WHERE c.local_net_address IS NOT NULL;

SELECT @@SERVERNAME
select * from sys.servers where is_linked = 1

select * from HD_2016EXPAD.JDE_DB_Alan.dbo.t1
select * from RYDWS366.HD_2016EXPAD.JDE_DB_Alan.dbo.cj				-- does not work !

select * from [RYDWS366\HD_2016EXPAD].JDE_DB_Alan.dbo.cj			-- works !		--10/12/2019
select * from [RYDWS366\HD_2016EXPAD].JDE_DB_Alan.jde_db_alan.vw_Mast  -- works !

;select * from [hd-vm-bi-sql01].HDDW_PRD.star.d_product p where p.item_code in ('44.011.007')

select * from  Jde_db_alan.FCPRO_Fcst fc where fc.ItemNumber like ('%40.033.131%') and fc.Date in ('2020-06-01')
select * from Jde_db_alan.FCPRO_Fcst fc where fc.ItemNumber like ('%40.033.131%') and fc.Date in ('2020-06-01')

select * from dbo.cj			-- works !


---=======================================================================================
------ Check Data Upload status -------

select * from  JDE_DB_Alan.Jde_Item_Availability a
select * from JDE_DB_Alan.Master_ML345 a
select * from JDE_DB_Alan.Master_V4102A a
select * from JDE_DB_Alan.OpenPO a

--- Some Fancy code to get data your want from above table Like Rows count, Report time etc ---

--- To display last 3 rows using row_number in desc order to get your last 2 rows ---
select * from
(select *, row_number () over ( order by Short_Item_Num desc) as rn_desc
		 , row_number () over ( order by Short_Item_Num asc) as rn_asc 
		 ,count(*) over ( order by Short_Item_Num asc) as Totalrw from JDE_DB_Alan.Jde_Item_Availability ) a
where a.rn_desc < 3 order by Short_Item_Num asc

--- To display last 3 rows using Except syntax /or without order by  ---
select * from JDE_DB_Alan.Jde_Item_Availability except 
		(select top (( select count(*) from JDE_DB_Alan.Jde_Item_Availability ) - 4) * from JDE_DB_Alan.Jde_Item_Availability )

--------------------------------------------------------------------------------

----- 28/4/2020 -----

select * from JDE_DB_Alan.FCPRO_Fcst_History a where a.ItemNumber in ('42.210.031') and a.ReportDate > '2021-12-01'
--select f.ItemNumber,m.PrimarySupplier,m.SupplierName,m.PlannerNumber,m.Owner_   
--select distinct f.ItemNumber,m.StockingType,m.Leadtime_Mth,m.LeadtimeLevel,m.FamilyGroup_,m.SupplierName,m.PrimarySupplier,m.Family,m.Family_0,m.Description,c.Customer_Supplier_ItemNumber
--select distinct m.FamilyGroup_
--select distinct m.Family_0
--select distinct m.PrimarySupplier,m.SupplierName,m.ItemNumber,m.Description,m.Owner_,m.StockingType,m.FamilyGroup_,m.Family_0
select distinct f.ItemNumber,m.ShortItemNumber,m.Description,m.Colour,m.StandardCost,m.SupplierName,m.Owner_,m.FamilyGroup_,m.Leadtime_Mth,m.FamilyGroup,m.Family
--select f.ItemNumber,f.Value,f.Date,m.Description,m.Colour,m.FamilyGroup,m.Family,m.FamilyGroup_,m.Family_0,f.ReportDate,m.StandardCost,f.Value * m.StandardCost as FC_Dollars,m.SupplierName,m.UOM,m.PrimarySupplier
--  select distinct m.ShortItemNumber,f.ItemNumber,m.Description,m.FamilyGroup_,m.StockingType
--select f.ItemNumber,c.Customer_Supplier_ItemNumber,f.Value,f.Date,m.UOM,m.Description,m.Colour,m.FamilyGroup,m.Family,m.FamilyGroup_,m.Family_0,m.SupplierName,m.PrimarySupplier

 from JDE_DB_Alan.FCPRO_Fcst f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
--from JDE_DB_Alan.FCPRO_Fcst_History f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber

      left join JDE_DB_Alan.vw_Mast_Vendor_Item_CrossRef c on f.ItemNumber = c.ItemNumber   
where  --m.ItemNumber in ('46.508.500','46.508.700','46.521.500','46.521.700')
       -- m.ItemNumber like ('%4459') -- and m.SupplierName like ('Hunter%')
		--m.ItemNumber like ('46.%')
		--  m.ItemNumber like ('46.521%') or  m.ItemNumber like ('46.508%') or  m.ItemNumber like ('46.612%') or  m.ItemNumber like ('46.614%') 
		--  m.ItemNumber like ('82.%') 
		--m.ItemNumber in ('7494700001')
		-- m.ItemNumber in ('34.366.000','34.367.000','34.368.000','34.369.000','34.370.000')
	   -- m.ItemNumber in ('2801396048','2801396072','2801396095','2801396167','2801396245','2801396276','2801396324','2801396351','2801396354','2801396551','2801396609','2801396661','2801396669','2801396689','2801396785','2801396862','4600220133','4600220180','4600220320','4600220405','4600220486','4600220550','4600220661','4600220810')
		--m.ItemNumber in ('26.100.000','26.196.000')
		--m.ItemNumber in ('46.612.500','46.612.700','46.614.500','46.614.700','46.521.500','46.521.700','46.508.500','46.508.700')
		-- m.ItemNumber in ('87.100.001','87.501.010','87.200.001','87.201.001','87.225.910','87.502.001')
		--   m.ItemNumber in ('87.001.001','87.100.001','87.200.001','87.201.001','87.202.001','87.002.002','87.102.002','87.220.002','87.221.002','87.002.003','87.102.003','87.220.003','87.221.003','87.501.013','87.502.003','87.002.001','87.102.001','87.220.001','87.221.001','87.501.010','87.502.001','87.400.033','87.401.004','87.410.033','87.225.910','87.225.220','87.225.520','87.411.033','87.110.001')
		-- m.Family in ('89J','89K','89L')
		--  m.PrimarySupplier in ('1239')
		--m.PrimarySupplier in ('200160')
		--m.PrimarySupplier in ('2197653')					--- Hande China
	   -- m.PrimarySupplier in ('979516')			--- Helio screen Belgium
	   --m.PrimarySupplier in ('2239')					--- Blaze
	 --  m.StockingType in ('P')
		--m.StockingType in ('Q','M')
	--	 m.StockingType in ('Q')
     --  m.FamilyGroup in ('966')  and m.Family in ('635')
	 --m.FamilyGroup in ('900')  and m.Family in ('E22')
      --m.FamilyGroup in ('982') and m.Owner_ not like ('Lee%')
	-- and  m.FamilyGroup in ('989')
	-- and  m.FamilyGroup in ('965')
	--and m.FamilyGroup in ('992')
	--  m.FamilyGroup in ('977')	
	  --  m.FamilyGroup in ('981')
	 -- and m.Family in ('C04')
	  --  and m.Family in ('THC')
	  -- and    m.Family in ('X08')
       f.DataType1 = 'Adj_FC'
	  --and m.Family in ('191','190')
	  --and f.Date between '2020-04-01' and '2020-07-01'
	 -- and m.Colour like ('nocturnal%')
	 -- and m.Description like ('%mist%')
	 and m.Description like ('%40x40x2%')
	--   and m.Colour like ('plutol%')
	-- m.ItemNumber like ('82.%')		    	-- 26.% --> 971/977 (Venetian Alum/Timber); 24.%/25.%  --> 974 ( Roller); 27.%  --> 973/979( Duette/Silh); 28.% --> 972 ( Vertical )
											-- 82.% --> 982/981 ( Roller fab/Vertical fab ); 43.% --> 986 ( Internal fab - Environtech ); 44.% --> 989 ( External fab - Fibre glass - Stance) 
											-- how about Annual Volume/ $ ? 
      --and f.ReportDate > '2021-12-01' 
	  --  and f.ReportDate between '2022-04-15' and '2022-04-30'

--order by f.Date	 
order by f.ItemNumber,m.SupplierName asc
  --order by m.StockingType,m.FamilyGroup_,m.Family

--select 336/24,

select a.ItemNumber,a.ShortItemNumber,a.StockingType,a.Description,a.StandardCost,a.FamilyGroup_ from JDE_DB_Alan.vw_Mast a
--where a.ItemNumber in ('82700.3000.00.02','82700.3000.00.12','82700.3000.00.16','82700.3000.00.17','82700.3000.00.18','82700.3000.00.20','82700.3000.00.50','82700.3000.00.60','82700.3000.01.01','82700.3000.60.60','82700.3000.02.02','82700.3000.12.12','82700.3000.16.16','82700.3000.17.17','82700.3000.18.18','82700.3000.20.20','82700.3000.50.50','82336.3000.00.02','82336.3000.00.12','82336.3000.00.16','82336.3000.00.17','82336.3000.00.18','82336.3000.00.20','82336.3000.00.50','82336.3000.00.60','82336.3000.01.01','82336.3000.60.60','82336.3000.02.02','82336.3000.12.12','82336.3000.16.16','82336.3000.17.17','82336.3000.18.18','82336.3000.20.20','82336.3000.50.50')
--where a.ItemNumber in ('2801396048','2801396072','2801396095','2801396167','2801396245','2801396276','2801396324','2801396351','2801396354','2801396551','2801396609','2801396661','2801396669','2801396689','2801396785','2801396862','4600220133','4600220180','4600220320','4600220405','4600220486','4600220550','4600220661','4600220810')
--where a.ItemNumber in ('1032120','1032123','1032128','1032131','1032138','1032139','1032140','1032142','1032145','1032150','1032155','1032156','1032157','1032160','1032161','1032162','1031924','1031922','1031935','1031927','1031933','1031936','1031942','1031932')
where a.Description like ('%407')
where a.ItemNumber in ('1026932','1026933','1026937','1026952','1026961','1026962','1026965','1026967','1026841','1026842','1026846','1026861','1026870','1026871','1026874','1026876','1027628','1027623','1031831','1031676','1031674','1031671','1031675','1031830','1031672','1026660','1026661','1026662','1026663')

select a.*from JDE_DB_Alan.vw_Mast a
where a.ItemNumber in ('6001130009021H')
where a.ItemNumber in ('4150083133','4150083180','4150083320','4150083651','4150083765','4150083785','4150083862','4150083885','4150084133','4150084180','4150084320','4150084651','4150084765','4150084785','4150084862','4150084885','KIT2796','KIT2692','KIT2695','KIT2698','KIT2704','KIT2706','KIT2707','KIT2709','2989899000B','2989900000B','2989901000B','2989902000B')


select a.ItemNumber,a.UOM,a.ShortItemNumber,a.Description,a.FamilyGroup from JDE_DB_Alan.vw_Mast a where a.ShortItemNumber in ('1439980','1439998','1440008','1440016','1440024','1440032','1440041','1440059','1440067','1440075','1440083','1440091','1440104','1440112','1440121','1440139','1440147','1440155','1440163','1440171','1440180','1440198','1440201','1440219','1440227','1440235','1440243','1440251','1440260')
select * from JDE_DB_Alan.vw_Mast a where a.ItemNumber like  ('87.001.%')
select * from JDE_DB_Alan.vw_Mast a where a.ItemNumber like  ('34.376.000')

select a.ItemNumber,a.Description,a.FamilyGroup,b.FamilyGroup_,a.PackQty,a.StockingType,a.UOM from JDE_DB_Alan.Master_ML345 a left join JDE_DB_Alan.vw_Mast b on a.ShortItemNumber = b.ShortItemNumber
where a.ItemNumber in ('34.376.000','34.366.000','34.372.000','34.371.000','34.406.000','34.423.000','34.480.000','34.362.000','34.437.000','34.400.000','34.369.000','34.412.000','34.536.000','34.537.000','34.438.000','34.358.000','34.441.000','34.420.000','34.538.000','34.483.000','34.408.000','34.430.000','34.471.000','34.409.000','34.368.000','34.364.000','34.535.000','34.418.000','34.410.000','34.411.000','34.539.000','34.310.000','34.422.000','34.407.000','34.403.000','34.357.000','34.482.000','34.363.000','34.477.000','34.474.000','34.436.000','34.421.000','34.434.000','34.442.000','34.484.000','34.401.000','34.419.000','34.402.000','34.467.000','34.404.000','34.405.000','34.367.000','34.427.000','34.424.000','34.468.000','34.445.000','34.481.000','34.444.000','34.443.000','34.435.000','34.365.000','34.433.000','34.432.000','34.447.000','34.415.000','34.440.000','34.431.000','34.476.000','34.429.000','34.413.000','34.428.000','34.414.000','34.472.000','34.439.000','34.416.000','34.417.000','34.425.000','34.426.000','34.448.000','34.466.000','34.469.000','34.470.000','34.473.000','34.475.000','34.478.000','34.479.000','34.485.000','34.541.000','34.540.000','34.542.000','34.543.000','34.544.000','34.545.000','34.373.000','34.374.000','34.375.000')


select * from JDE_DB_Alan.vw_Mast a where a.ItemNumber in ('38.006.001','38.006.002','38.006.003','38.006.004','38.006.005','38.006.006','38.006.007','38.006.008','38.006.009','38.006.010','38.006.011','700000','18.010.035','18.010.036','18.013.089','18.615.007','24.5349.0204','24.5353.0204','24.5354.0204','24.5426.0204','24.7206.0000','28.601.030','28.602.000','28.603.000','28.606.000','28.607.000','28.608.000','28.614.000','28.615.131','28.615.858','28.615.886','28.617.002','28.617.131','28.617.462','28.619.131','28.619.858','28.619.886','28.621.000','28.621.858','28.624.000','28.625.000','28.627.000','28.636.000','28.645.000','28.646.000','28.647.000','28.647.858','28.665.002','28.665.131','28.665.388','28.665.462','28.669.063','28.670.000B','28.682.030','28.682.462','28.682.500','28.682.850','28.685.850','38.001.001','38.001.002','38.001.005','38.004.000S','38.006.001','38.006.002','38.006.005','38.006.006','38.011.001','38.013.001','38.013.006','38.014.003','4152336885B','KIT2350','38.007.001','38.007.003','38.007.004','38.012.003','38.001.006','28.645.858','4152336048B','28.627.858','24.5353.1858','28.665.858','28.617.858','28.682.858','24.5353.4459','24.5353.0952','28.682.114','28.627.462')

select a.ItemNumber,a.Description,a.FamilyGroup_,a.Family_0,a.Colour,a.StandardCost,a.SS_Adj_Jde from JDE_DB_Alan.vw_Mast a where a.Family in ('TMD')

select * from JDE_DB_Alan.vw_Mast a where a.Colour like ('pluto%') or a.Colour like ('ara%') or a.Colour like ('greysh%') or a.Colour like ('mart%')  order by a.Colour
select a.ItemNumber,a.StandardCost,a.WholeSalePrice from JDE_DB_Alan.vw_Mast a where a.ItemNumber in ('46.005.000','46.005.100','46.005.134','46.005.104','46.005.734','46.005.737','46.005.810','46.005.850','46.011.000','46.011.100','46.011.134','46.011.104','46.011.734','46.011.737','46.011.810','46.011.850','46.012.000','46.012.100','46.012.134','46.012.104','46.012.734','46.012.737','46.012.810','46.012.850','46.013.000','46.013.100','46.013.134','46.013.104','46.013.734','46.013.737','46.013.810','46.013.850','46.004.000','46.004.100','46.004.134','46.004.810','46.602.000','46.602.100','46.602.134','46.602.810','46.603.000','46.603.100','46.603.134','46.603.810','46.606.000','46.606.100','46.606.134','46.606.104','46.606.734','46.606.737','46.606.810','46.606.850','46.607.000','46.607.100','46.607.134','46.607.104','46.607.734','46.607.737','46.607.810','46.607.850','46.608.000','46.608.100','46.608.134','46.608.104','46.608.734','46.608.737','46.608.810','46.608.850','42.064.000','42.065.000','42.066.000','42.067.000','42.068.000','46.002.000','46.002.063','46.019.000','46.019.063','46.021.000','46.025.000','46.108.063','46.203.000','46.306.000','46.410.063','46.414.000','46.419.000','46.419.100','46.420.000','46.421.000','46.422.030','46.423.100','46.500.000','46.502.100','46.502.837','46.504.000','46.505.000','46.506.000','46.507.000','46.517.000','46.518.063','46.524.000','46.530.063','46.599.000','46.609.000','46.610.000','46.611.000','42.421.855')

select a.ShortItemNumber,a.ItemNumber,a.Description,a.FamilyGroup_,a.StandardCost,a.WholeSalePrice from JDE_DB_Alan.vw_Mast a where a.ItemNumber in ('34.366.000','34.367.000','34.368.000','34.369.000','34.370.000','34.376.000')
select a.ShortItemNumber,a.ItemNumber,a.Description,a.FamilyGroup_,a.StandardCost,a.WholeSalePrice from JDE_DB_Alan.vw_Mast a where a.ItemNumber in ('34.311.000','34.306.000','34.307.000','34.308.000','34.309.000')

select * from [JDE_DB_Alan].[SlsHist_Excp_FCPro_upload] a order by a.ReportDate desc
select dateadd(s,-1,dateadd(d, datediff(d,0, getdate()),o 0)) 

select * from JDE_DB_Alan.vw_Mast_Planning a where a.Item_Number in ('42.210.031','26.900.962','32.455.155')

select a.ItemNumber,a.Description,a.Family_0,a.FamilyGroup_,a.StandardCost,a.Pareto,a.Colour,a.StockingType
       ,case 		
			when a.Description  like ('%eclp%') then ('Eclipse')
			when a.Description  like  ('%prov%') then ('Provincial')
			when a.Description  like  ('%lux%') then ('Luxury')
			when a.Description  like  ('%mist%') then ('Mist')
			when a.Description  like  ('%std%') then ('Standard')
			else 'Others'
	    end as range	         
from JDE_DB_Alan.vw_Mast a where a.Family_0 like ('VE1%')
order by a.ItemNumber
--------------------------------------------------------------------------

select a.ItemNumber,a.Description,a.FamilyGroup_,a.StandardCost from JDE_DB_Alan.vw_Mast a where a.ItemNumber in ('24.5110.7178','24.5349.0204','24.5349.1858','24.5349.4459','24.5353.0204','24.5353.1858','24.5353.4459','24.5354.0204','24.5354.1858','24.5354.4459','24.5412.0000','24.5413.0000','24.5414.0000','24.5415.0000','24.5416.0000','24.5417.0000','24.5418.0000','24.5424.0204','24.5424.1858','24.5424.4459','24.5425.0204','24.5425.1858','24.5425.4459','24.5426.0204','24.5426.1858','24.5426.4459','24.5427.0204','24.5427.1858','24.5427.4459','24.7008.0199','24.7008.0952','24.7008.1858','24.7008.4459','24.7100.0199','24.7100.1858','24.7100.4459A','24.7100.7052A','24.7102.0199','24.7102.1858','24.7102.4459A','24.7102.7052A','24.7106.7060','24.7108.7060','24.7110.0155','24.7110.0952A','24.7110.1858','24.7110.4459A','24.7111.0155A','24.7111.0952A','24.7111.1858A','24.7111.4459A','24.7114.0155','24.7114.0952A','24.7114.1858','24.7114.4459A','24.7115.0155A','24.7115.0952A','24.7115.1858A','24.7115.4459A','24.7116.0952','24.7116.1858','24.7118.0952','24.7118.1858','24.7120.0155','24.7120.0952A','24.7120.1858','24.7120.4459A','24.7121.0155','24.7121.0952A','24.7121.1858','24.7121.4459A','24.7122.0155','24.7122.0952A','24.7122.1858','24.7122.4459A','24.7123.0155A','24.7123.0952A','24.7123.1858A','24.7123.4459A','24.7125.0155','24.7125.0952A','24.7125.1858','24.7125.4459A','24.7127.0155','24.7127.0952','24.7127.1858','24.7127.4459','24.7128.0155A','24.7128.0952A','24.7128.1858A','24.7128.4459A','24.7129.0155A','24.7129.0952A','24.7129.1858A','24.7129.4459A','24.7130.0000A','24.7131.0000A','24.7133.0155A','24.7133.0952A','24.7133.1858A','24.7133.4459A','24.7134.0155A','24.7134.0952A','24.7134.1858A','24.7134.4459A','24.7135.0000','24.7136.0155A','24.7136.1858A','24.7138.0155A','24.7138.1858A','24.7146.0155A','24.7146.0952A','24.7146.1858A','24.7146.4459A','24.7160.1858','24.7161.7060','24.7163.0000A','24.7168.0155A','24.7168.0952A','24.7168.1858A','24.7168.4459A','24.7169.0155A','24.7169.0952A','24.7169.1858A','24.7169.4459A','24.7175.7178','24.7185.0000','24.7193.0199A','24.7193.1858A','24.7195.0199A','24.7195.1858A','24.7196.7060A','24.7197.0000A','24.7202.0000','24.7202.0001','24.7203.0000','24.7203.0001','24.7206.0000','24.7207.0199','24.7207.0952','24.7207.1858','24.7207.4459','24.7208.0199','24.7208.0952','24.7208.1858','24.7208.4459','24.7209.0199','24.7209.0952','24.7209.1858','24.7209.4459','24.7210.0199','24.7210.0952','24.7210.1858','24.7210.4459','24.7218.0199','24.7218.0952','24.7218.1858','24.7218.4459','24.7218.4460','24.7218.4461','24.7218.4462','24.7218.4463','24.7218.4464','24.7218.4465','24.7219.0199','24.7219.0952','24.7219.1858','24.7219.4459','24.7219.4460','24.7219.4462','24.7219.4464','24.7219.4465','24.7240.0199','24.7240.0952','24.7240.1858','24.7240.4459','24.7250.0199','24.7250.0952','24.7250.1858','24.7250.4459','24.7251.0199','24.7251.0952','24.7251.1858','24.7251.4459','24.7252.0199','24.7252.0952','24.7252.1858','24.7252.4459','24.7253.0199','24.7253.0952','24.7253.1858','24.7254.0199','24.7254.0952','24.7254.1858','24.7254.4459','24.7255.1858','24.7300.7060','24.7302.1858A','24.7307.0952','24.7307.1858','24.7311.1858A','24.7326.0000','24.7332.1858','24.7353.0000','24.7355.0952A','24.7362.1858','24.7363.0199','24.7363.0952','24.7363.1858','24.7363.4459','24.7364.0199','24.7364.0952','24.7364.1858','24.7364.4459','24.7371.0005A','24.7398.1858A','24.7399.1858','26.045.134','26.045.406','26.045.712','26.045.834','26.045.0204','26.045.0292','26.045.0696','26.045.0952','26.045.1601','26.045.1650','26.045.1803','26.045.1858','26.045.4451','26.045.4499','26.045.4544','26.045.4642','26.045.4655','26.045.4806','26.045.7010','26.045.7113','26.045.9771','26.098.000','26.098.103','26.098.133','26.098.471','26.132.0204','26.132.0292','26.132.0590','26.132.0952','26.132.1601','26.132.1650','26.132.1858','26.132.4451','26.132.4459','26.132.4544','26.132.4655','26.132.4806','26.132.7010','26.144.0192','26.144.0204','26.144.0590','26.144.0952','26.144.1601','26.144.1650','26.144.1858','26.144.4451','26.144.4459','26.144.4544','26.144.4655','26.144.4806','26.144.7010','26.165.000','26.276.000','12.171.033','26.275.000','26.353.134','26.353.142','26.353.143','26.353.213','26.353.347','26.353.366','26.353.406','26.353.711','26.353.712','26.353.834','26.354.0204','26.354.0606','26.354.0952','26.354.1601','26.354.1650','26.354.1858','26.354.366','26.354.4451','26.354.4459','26.354.4655','26.354.4756','26.354.4806','26.404.855','26.418.000','26.478.000','26.535.000','26.493.000','26.500.000','26.510.000','26.522.000','26.526.030','26.528.030','26.531.000','26.533.000','26.534.000','26.536.000','26.537.000','26.538.001','26.539.000','26.540.0204','26.540.0606','26.540.0952','26.540.131','26.540.1601','26.540.1650','26.540.1858','26.540.407','26.540.4451','26.540.4459','26.540.4655','26.540.4756','26.540.4806','26.542.0204','26.542.0606','26.542.0952','26.542.1601','26.542.1650','26.542.1858','26.542.347','26.542.4451','26.542.4459','26.542.4655','26.542.4756','26.542.4806','26.542.711','26.542.712','26.544.0204','26.544.0606','26.544.0952','26.544.1601','26.544.1650','26.544.1858','26.544.407','26.544.4451','26.544.4459','26.544.4655','26.544.4756','26.544.4806','26.544.712','27.162.661','27.162.810','27.162.862','27.162.879','27.163.661','27.163.810','27.163.862','27.163.879','27.164.661','27.164.810','27.164.862','27.164.879','27.165.661','27.165.810','27.165.862','27.165.879','27.166.661','27.166.810','27.166.862','27.166.879','27.172.661','27.172.810','27.172.862','27.172.879','27.173.048','27.173.661','27.173.810','27.173.862','27.173.879','27.174.048','27.174.661','27.174.810','27.174.862','27.174.879','27.175.048','27.175.661','27.175.810','27.175.879','27.176.048','27.176.661','27.176.810','27.176.862','27.176.879','27.200.502','27.200.634','27.200.647','27.200.738','27.222.634','27.222.502','27.222.643','27.200.916','27.222.916','27.231.545','27.231.634','27.231.644','27.231.738','27.231.916','27.231.975','27.237.572','27.237.575','27.237.576','27.237.738','27.237.916','27.240.470','27.251.457','27.251.479','27.251.480','27.251.482','27.251.624','27.251.681','27.251.682','27.251.686','27.251.688','27.251.713','27.251.737','27.251.749','27.251.750','27.251.916','27.251.951','27.251.953','27.251.955','27.251.985','27.251.986','27.251.994','27.252.000','27.252.457','27.252.479','27.252.480','27.252.482','27.252.624','27.252.682','27.252.686','27.252.688','27.252.713','27.252.733','27.252.737','27.252.749','27.252.750','27.252.916','27.252.951','27.252.953','27.252.955','27.252.985','27.252.986','27.252.994','27.253.000','27.257.000','27.258.000','27.262.850B','26.228.000','2950100000B','2770004000B','2780033000B','2780050000','2780103000','2780120000B','2780135000B','2780136000B','2780139785','2780142000B','2781094000','2781209000','2801382048','2801382180','2801382276','2801382320','2801382324','2801382496','2801382580','2801382609','2801382661','2801382669','2801382689','2801382785','2801382810','2801382862','2801382879','2801386048','2801386180','2801386276','2801386320','2801386324','2801386496','2801386551','2801386580','2801386609','2801386661','2801386669','2801386689','2801386785','2801386810','2801386862','2801386879','2801389048','2801389072','2801389095','2801389167','2801389245','2801389276','2801389324','2801389351','2801389354','2801389551','2801389609','2801389661','2801389669','2801389689','2801389785','2801389862','2801390048','2801390072','2801390095','2801390167','2801390245','2801390276','2801390324','2801390351','2801390354','2801390609','2801390661','2801390669','2801390689','2801390785','2801390862','2801396048','2801396072','2801396095','2801396167','2801396245','2801396276','2801396324','2801396354','2801396551','2801396609','2801396661','2801396669','2801396689','2801396785','2801396862','2801404000','2801405048','2801405072','2801405095','2801405167','2801405245','2801405276','2801405351','2801405354','2801405609','2801405661','2801405669','2801405689','2801405785','2801405862','2801436048','2801436072','2801436095','2801436167','2801436245','2801436276','2801436324','2801436351','2801436354','2801436609','2801436661','2801436669','2801436689','2801436785','2801436862','2801480000','2801481000','2801490048','2801490072','2801490095','2801490167','2801490245','2801490276','2801490324','2801490351','2801490354','2801490551','2801490609','2801490661','2801490669','2801490689','2801490785','2801490862','2801491048','2801491072','2801491095','2801491167','2801491245','2801491276','2801491324','2801491351','2801491354','2801491551','2801491609','2801491661','2801491669','2801491689','2801491785','2801491862','2801627000','2801628000','2801748000','2801749000','2930340000','2851218072','2851218167','2851218245','2851218276','2851218351','2851218354','2851218551','2851218661','2851218669','2851218689','2851218785','2851218862','2851224072','2851224167','2851224245','2851224276','2851224351','2851224354','2851224551','2851224661','2851224669','2851224689','2851224785','2851224862','2851230072','2851230167','2851230245','2851230276','2851230351','2851230354','2851230551','2851230661','2851230669','2851230689','2851230785','2851230862','2851236072','2851236167','2851236245','2851236276','2851236351','2851236354','2851236661','2851236669','2851236689','2851236785','2851236862','2851284048','2851284072','2851284095','2851284167','2851284245','2851284276','2851284324','2851284351','2851284354','2851284551','2851284609','2851284661','2851284669','2851284689','2851284785','2851284862','2851512072','2851512167','2851512245','2851512351','2851512661','2851512669','2851512689','2851512785','2851512862','2851542072','2851542167','2851542245','2851542351','2851542661','2851542669','2851542689','2851542785','2851542862','2851548072','2851548167','2851548245','2851548351','2851548661','2851548669','2851548689','2851548785','2851548862','2911363000','2911364000','2920033000','2920247000B','2920698000B','2920707000B','2920750000B','2921273000','2921274000','2930130000','2930220000','2930561000','2954000000','2970300000B','2980023000','2982028000B','2989875000B','2989899000B','2989900000B','2989901000B','2989902000B','30-CS606','27.315.000','3200156000C','3200156862','4178201785','4199030000','4199030107','4199030111','4199030215','4199030300','4199030331','4199030636','4199030820','4199050000','4250084126','5007312000','6800125000','F8174A710','F8174A908','F8174A948','F8174A949','F8174A951','F8174A955','F8174A977','F9174A568','F9174A576','F9174A951','F9174A952','F9174A955','H7174N952','7300109000','7300110000','7300111000','7300158000','7300159000','7300555000','7530000005','7530000013','7541002000','7542000000','7602209005','7602209013','7602209019','7602209052','7602209055','7612208013','7612208057','CS100','CS707','D7174N748','E40174A599','E40174A635','E40174A660','E40174A689','E41174A599','E41174A635','E41174A660','E41174A689','F16174A565','F16174A568','F16174A605','F16174A908','F16174A948','F16174A949','F16174A950','F16174A951','F16174A955','F16174A964','F16174A965','F16174A977','F17174A617','F17174A784','F17174A950','F17174A951','F17174A952','F17174A955','F17174A964','F17174A965','F36174A400','F36174A445','F36174A454','F36174A458','F37174A400','F37174A445','F37174A454','F37174A458','KIT2758','KIT2759','PA3701','UCLC100','UCLC105','UCLC118','UCLC131','UCLC147','UCS801','UEC100','UEC105','UEC118','UEC131','UEC147','UR10012','UR10512','UR11812','UR13112','UR14712','XCS707','XP301801660P','XUCLC048','XUCLC100','XUCLC105','XUCLC118','XUCLC131','XUCLC147','XUCLC662','XUCS801','XUEC048','XUEC100','XUEC105','XUEC118','XUEC131','XUEC147','XUEC662','XUR04816','XUR10016','XUR10516','XUR11816','XUR12416','XUR13116','XUR14716','XUR66216','28.602.000','28.603.000','28.604.000','28.605.000','28.606.000','28.607.000','28.608.000','28.609.000','28.610.000','28.611.000','28.612.000','28.613.000','28.614.000','28.615.131','28.615.886','28.617.131','28.619.131','28.619.886','28.621.000','28.622.000','28.623.000','28.624.000','28.625.000','28.626.000','28.635.000','28.636.000','28.644.000','28.645.000','28.646.000','28.647.000','28.664.131','28.669.063','28.681.030','26.002.134','26.002.287','26.002.104','26.002.711','26.002.810','26.089.287','26.089.749','26.119.0199','26.119.0752','26.121.001','26.121.055','26.121.331','26.121.332','26.121.333','26.167.0155','26.167.0952','26.176.000','26.301.0952','26.300.7178','26.350.807','26.350.820','26.350.830','26.350.831','26.741.171','26.741.820','26.203.030','26.357.000','26.167.000','26.169.037','26.154.030','26.196.030','26.197.000','26.223.030','26.740.060','26.211.000','26.200.307','26.200.456','26.224.030','26.224.456','26.800.676','26.800.820','26.800.962','26.800.963','26.800.971','26.801.820','26.801.962','26.801.963','26.802.659','26.802.676','26.802.820','26.802.962','26.802.963','26.803.659','26.803.676','26.803.820','26.803.833','26.803.962','26.803.963','26.805.000','32.455.155','32.455.460','32.455.461','32.455.462','32.455.465','32.455.855','32.380.855','32.380.002','34.024.000','34.025.000','34.026.000','34.036.000','34.039.000','34.215.000','34.216.000','34.231.000','34.232.000','34.235.000','34.306.000','34.307.000','34.308.000','34.309.000','34.310.000','34.311.000','34.357.000','34.362.000','34.363.000','34.364.000','34.365.000','34.400.000','34.401.000','34.402.000','34.403.000','34.404.000','34.405.000','34.406.000','34.407.000','34.408.000','34.409.000','34.410.000','34.411.000','34.412.000','34.413.000','34.414.000','34.415.000','34.416.000','34.417.000','34.418.000','34.419.000','34.420.000','34.421.000','34.422.000','34.423.000','34.436.000','34.437.000','34.438.000','34.439.000','34.440.000','34.441.000','34.442.000','34.443.000','34.444.000','34.445.000','34.447.000','34.448.000','34.468.000','34.469.000','34.470.000','34.471.000','34.472.000','34.473.000','34.486.000','34.487.000','34.488.000','34.489.000','34.491.000','34.492.000','34.513.000','34.514.000','34.515.000','34.516.000','34.519.000','34.520.000','34.521.000','34.522.000','34.523.000','34.524.000','34.525.000','34.530.000','34.531.000','34.533.000','34.534.000','34.535.000','34.536.000','34.537.000','34.538.000','34.539.000','42.180.049','42.196.031','42.198.000','42.204.000','42.212.031','42.213.031','42.214.031','42.230.000','42.236.000','42.241.032','42.357.131','42.357.273','42.421.855','42.501.855','42.502.000','42.505.000','42.506.030','42.614.063','42.631.855','42.645.002','42.647.493','7127710001','7127710194','7742140914','44.132.000','44.209.000','44.210.000','42.651.000','46.002.063','46.005.000','46.005.100','46.011.000','46.011.100','46.012.000','46.012.100','46.013.000','46.013.100','46.019.063','46.203.000','46.306.000','46.419.100','46.420.000','46.421.000','46.422.030','46.423.100','46.423.134','46.423.850','46.424.100','46.424.850','46.425.100','46.500.000','46.502.100','46.502.122','46.502.837','46.504.000','46.505.000','46.506.000','46.507.000','46.510.000','46.512.000','46.513.000','46.514.000','46.515.000','46.516.000','46.517.000','46.518.063','46.521.500','46.521.700','46.522.500','46.522.700','46.524.000','46.530.063','46.553.030','46.599.000','46.606.000','46.606.100','46.607.000','46.607.100','46.608.000','46.608.100','46.609.000','46.610.000','46.611.000','82.012.901','82.012.902','82.012.903','82.012.906','82.012.908','82.012.909','82.012.912','82.012.913','82.012.915','82.012.916','82.012.917','82.012.919','82.012.920','82.012.922','82.012.937','82.013.901','82.013.902','82.013.903','82.013.906','82.013.908','82.013.909','82.013.912','82.013.913','82.013.915','82.013.916','82.013.917','82.013.919','82.013.920','82.013.922','82.036.901','82.036.902','82.036.903','82.036.905','82.036.906','82.036.915','82.036.918','82.054.903','82.054.905','82.054.906','82.054.910','S3000NET5300N0AL','S3000NET5300N0SS','82.201.901','82.301.902','82.301.903','82.201.906','82.301.908','82.301.909','82.301.912','82.301.913','82.201.915','82.301.916','82.201.917','82.301.919','82.301.920','82.201.922','82.201.937','82.201.934','82.336.901','82.336.902','82.336.903','82.336.905','82.336.906','82.336.907','82.336.908','82.336.909','82.336.910','82.336.911','82.336.912','82.336.915','82.336.918','82.536.901','82.536.902','82.536.903','82.536.905','82.536.915','82.536.918','82.390.921','82.390.922','82.390.923','82.390.924','82.390.928','82.417.903','82.417.905','82.417.906','82.417.910','82.412.901','82.412.902','82.413.901','82.413.902','82.413.903','82.413.904','82.413.905','82.417.901','82.417.904','82.417.907','82.417.908','82.417.909','82.600.901','82.600.902','82.600.903','82.600.904','82.600.905','82.600.908','82.633.901','82.633.902','82.633.903','82.633.904','82.633.905','82.633.906','82.633.907','82.633.908','82.633.909','82.696.901','82.696.902','82.696.903','82.696.904','82.696.905','82.696.906','82.696.907','82.696.908','82.696.909','82.696.910','82.696.911','82.696.912','82.696.926','82.696.927','82.696.928','82.696.930','82.696.931','82.696.932','82.696.933','43.205.532M','43.207.532M','43.205.536M','43.207.536M','43.205.537M','43.207.537M','43.207.565M','43.205.574M','43.205.582M','43.207.582M','43.207.584M','43.205.635M','43.207.635M','43.205.637M','43.207.637M','43.205.663M','0751031000202H','0751031000207H','0751031003001H','0751031003030H','0751031003061H','0850531000202H','0850531000207H','0850531000220H','0850531000222H','0850531000707H','0850531000720H','0850531003001H','0850531003010H','0850531003021H','0850531003030H','085053100M178H','6000030009001H','6000030009003H','6000030009002H','6000030009005H','6000030009007H','6000030009008H','6000030009009H','6000030009010H','6000030009011H','6000030009012H','6000130009001H','6000130009003H','6000130009002H','6000130009005H','6000130009004H','6000130009007H','6000130009008H','6000130009009H','6000130009010H','6000130009011H','6000130009012H','6001030009007H','6001030009009H','6001030009010H','6001030009011H','6001030009019H','6001030009020H','6001030009021H','6001030009022H','6001030009023H','6001130009007H','6001130009009H','6001130009010H','6001130009011H','6001130009019H','6001130009020H','6001130009021H','6001130009022H','6001130009023H','82.512.901','82.512.902','82.512.903')

select * from JDE_DB_Alan.FCPRO_SafetyStock s where s.ItemNumber in ('28.665.131')

select * from JDE_DB_Alan.FCPRO_SafetyStock s where s.ItemNumber in ('32.455.155','32.455.460','32.455.461','32.455.462','32.455.465','32.455.855')

select * from JDE_DB_Alan.FCPRO_SafetyStock s where s.ItemNumber in ('43.205.582m')

select * from JDE_DB_Alan.vw_FC a where a.ItemNumber in ('F16174A950') or 1=1

select * from JDE_DB_Alan.vw_FC a where a.ItemNumber in('7479500182')
select a.ItemNumber,a.ShortItemNumber,a.StockingType from JDE_DB_Alan.vw_Mast a where a.ItemNumber in 
select a.ItemNumber,a.ShortItemNumber,a.StockingType from JDE_DB_Alan.Master_ML345 a where a.ItemNumber in 
('46.610.000','46.606.000','46.607.000','46.606.100','46.607.100','46.606.134','46.607.134','46.606.734','46.607.734','46.606.737','46.607.737','46.606.810','46.607.810','46.606.850','46.607.850','46.606.104','46.607.104','46.616.000','46.617.000','46.618.000','46.617.100','46.618.100','46.617.134','46.618.134','46.617.734','46.618.734','46.617.737','46.618.737','46.617.810','46.618.810','46.617.850','46.618.850','46.617.104','46.618.104')

--like ('74785%')
select * from JDE_DB_Alan.Master_ML345 a where a.ItemNumber like ('74785%')
select * from JDE_DB_Alan.Master_ML345 a where a.ItemNumber in ('82.633.907')
select * from JDE_DB_Alan.Master_V4102A a where a.Item_Number in ('27.589.116')
select a.ItemNumber,a.ShortItemNumber,a.Description,a.StockingType,a.FamilyGroup,a.SS_Adj_Jde from JDE_DB_Alan.vw_Mast a where a.ItemNumber in ('26.837.000','26.838.000','26.842.000','26.844.000','26.848.000','4181301661','4181301048','4181301320','4181301765','4181301785','4181301176','3051303661','3051303048','3051303320','3051303765','3051303785','3051303176','4231301661','4231301048','4231301320','4231301765','4231301785','4231301176','6121302','2151308','2151307','2781211000','6281301','6281303','5241301','2131301','4231303','4231302','1081401','7231303')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              


select a.ItemNumber,a.DataType1,a.Value as Val_July
from JDE_DB_Alan.FCPRO_Fcst a where a.ItemNumber in ('7478700001','7479500182','7479700182','7370350182')

select a.ItemNumber,a.DataType1,a.Value as Val_July,b.ItemNumber,b.Value,b.Date,b.ReportDate as fc_histy_rpt_dt
       , case
				when a.Value > b.Value then a.Value 
				when a.Value <= b.value then b.Value
         end as fc_val_new	    
from JDE_DB_Alan.FCPRO_Fcst a left join  JDE_DB_Alan.FCPRO_Fcst_History b on a.ItemNumber = b.ItemNumber and a.Date = b.Date
where  --a.ItemNumber in ('7478700001','7479500182','7479700182','7370350182')
		a.ItemNumber in ('42.652.000','46.421.000','46.508.500','46.508.700','46.531.500','46.531.700','7137040000','7370250182','7370250914','7370300182','7370300914','7370350182','7370350914','7370400001','7370400182','7370400914','7441500001B','7441500182B','7441500914B','7441700001B','7441700182B','7441700914B','7442700000','7442700001','7442700182','7442700914','7456500182','7457500001','7457500182','7457500914','7460500000','7460700000','7467040100','7467070100','7468500001','7468500182','7468500914','7468700000','7468700001','7468700182','7468700914','7477500001','7477500182','7477500914','7477700000','7477700001','7477700182','7477700914','7478500001','7478500182','7478500914','7478700000','7478700001','7478700182','7478700914','7479500001','7479500182','7479500914','7479700000','7479700001','7479700182','7479700914','7485700000','7488500001','7488500182','7488500914','7488700000','7488700001','7488700182','7488700914','7489500001','7489500182','7489500914','7489700000','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700000','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700000','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700000','7494700001','7494700182','7494700914','7496500001','7496500182','7496500914','7496700001','7496700182','7496700914','7497700000','7497700001','7497700182','7497700914','7498700000','7498700001','7498700182','7498700914','7499700000','7499700001','7499700182','7499700914','7766050000','7766070000','7766250000','7766270000')
		and b.ReportDate between '2022-06-01' and '2022-06-30 18:00:00'
		and a.DataType1 in ('Adj_FC')
order by a.ItemNumber


----- stock information with Item Availability table ---
select * from JDE_DB_Alan.Jde_Item_Availability a 
where a.Short_Item_Num in ('807761')

select a.ShortItemNumber,a.ItemNumber,a.Description,a.Pareto,a.StockingType,a.FamilyGroup_,a.QtyOnHand as HD_SOH,a.StandardCost,a.UOM
        ,c.Business_Unit,c.QTY_On_Hand,c.Qty_Soft_Committed,c.Location_,c.Primary_Location,c.Lot_Serial_Number
 from JDE_DB_Alan.vw_Mast a left join JDE_DB_Alan.Jde_Item_Availability c on c.Short_Item_Num = a.ShortItemNumber
  where -- a.ItemNumber in ('42.210.031')
	    a.StockingType not in ('O','U') and a.FamilyGroup in ('965')
       -- and m.ItemNumber not like ('4%')
	   and c.Primary_Location in ('P')
 -- order by a.Colour

--------------------------------------------------------------------
 select p.ItemNumber,'WIP' as DataType1,OrderNumber,QuantityOrdered as PO_Volume,QuantityReceived,QuantityOpen
		  ,OrderDate,ExSupplierShipDate,DueDate
		  ,case when p.DueDate is not null then convert(varchar(10),p.DueDate,120)
		        when p.DueDate is null then  convert(varchar(10),dateadd(d,convert(int,a.LeadtimeLevel),datediff(d,0,p.OrderDate)),120)		
				end  as PODate_
          ,case when p.DueDate is not null then datepart(year,p.DueDate)
		        when p.DueDate is null then  datepart(year,convert(varchar(10),dateadd(d,convert(int,a.LeadtimeLevel),datediff(d,0,p.OrderDate)),120)	)	
				end  as poyr
           ,case when p.DueDate is not null then datepart(month,p.DueDate)
		        when p.DueDate is null then  datepart(month,convert(varchar(10),dateadd(d,convert(int,a.LeadtimeLevel),datediff(d,0,p.OrderDate)),120)	)	
				end  as pomth
           ,case when p.DueDate is not null then datepart(day,p.DueDate)
		        when p.DueDate is null then  datepart(day,convert(varchar(10),dateadd(d,convert(int,a.LeadtimeLevel),datediff(d,0,p.OrderDate)),120)	)	
				end  as podte
	  --  ,datepart(year,p.DueDate) poyr,datepart(month,p.DueDate ) pomth,datepart(day,p.DueDate ) pomdte
		  ,InTransitDays,BuyerNumber,BuyerName,TransactionOriginator,TransactionOrigName,SupplierNumber,p.SupplierName,ShipmentNumber,ShpSts,ShipStatus,Reportdate,OpenPOID           
   from JDE_DB_Alan.OpenPO p left join JDE_DB_Alan.vw_Mast a on p.ItemNumber = a.ItemNumber
   where  ( p.DueDate is null or  p.DueDate < DATEADD(mm, DATEDIFF(m,0,GETDATE())+11,0) ) 
         and p.ItemNumber in ('24.7127.0155')

-----
   select ItemNumber,'WIP' as DataType1,OrderNumber,QuantityOrdered as PO_Volume,QuantityReceived,QuantityOpen
		  ,OrderDate,ExSupplierShipDate,DueDate
		  ,convert(varchar(7),p.DueDate,120) as PODate_,datepart(year,p.DueDate) poyr,datepart(month,p.DueDate ) pomth,datepart(day,p.DueDate ) pomdte
		  ,InTransitDays,BuyerNumber,BuyerName,TransactionOriginator,TransactionOrigName,SupplierNumber,SupplierName,ShipmentNumber,ShpSts,ShipStatus,Reportdate,OpenPOID           
   from JDE_DB_Alan.OpenPO p
   where  p.DueDate < DATEADD(mm, DATEDIFF(m,0,GETDATE())+11,0)
         and p.ItemNumber in ('24.7127.0155')

------- 9/8/2022 --- 

  select b.FamilyGroup_,convert(varchar(10),a.reportdate,126) as rptdate,sum(a.Value) as FC_val
  from JDE_DB_Alan.FCPRO_Fcst_History a left join JDE_DB_Alan.vw_Mast b on a.ItemNumber = b.itemnumber
   
  where a.ReportDate between ('2020-01-01') and ('2020-02-01') 
        --and a.ItemNumber in ('42.210.031')
group by b.FamilyGroup_,convert(varchar(10),a.reportdate,126)


select a.ItemNumber,a.ShortItemNumber from JDE_DB_Alan.vw_Mast a where a.ItemNumber in ('1026932','1026933','1026937','1026952','1026962','1026965','1026841','1026842','1026846','1026861','1026870','1026871','1026874','1027628','1027623','1031831','1031676','1031671','1031830','1031672')

select * from JDE_DB_Alan.OpenPO a where a.ItemNumber in ('24.7127.0155')

select a.ItemNumber,a.OrderDate,a.DueDate,a.QuantityOrdered,convert(varchar(12),0,datediff(d,0,a.OrderDate)) as dt
      ,convert(varchar(12),dateadd(d,cast(b.LeadtimeLevel as int),datediff(d,0,a.OrderDate)),120) as d
 from JDE_DB_Alan.OpenPO a left join JDE_DB_Alan.vw_Mast b on a.ItemNumber = b.ItemNumber  where  a.ItemNumber in ('24.7127.0155')

 ---=======================================================================================================================================================

 --- 'Item_Availability' data from Jde contains AWF customer commitment ( under AWF Business unit - 'P' primary location - 'Qty_Soft_Commit' ); 
  --- and other Customer commitment ( under HD Business unit - 'P' primary location - 'Qty_hard_Commit' ), effectively this report includes all Customer orders but with No date required ( volume are aggregated )
   -- so I just use This month ( current month ) as customer required date because normally most customer orders are due within 30 days we are whole sale business
   -- This View also tranaform data from Vertical to Horizontal --- all customer commit volume are laid out across columns for easy manupilation 
   ---Be cautious not to double dip if you in future want to spit out HD customer volume by month using sales order 'SO" data by month


  --- Note in this code , all Customer commitment are in 'P' under 'Primary Location' field, all data under 'S' are excluded !!
 ---  Note 'Qty hard Committed' is Qty for confirmed Customer order; 'Qty soft Committed' is qty required by AWF but do not necessarily mean it has been converted into SO yet; 'Qty on Po ' ( same as 'Qty on receipt'in Jde 'Details Availaibility' screen ) means all PO Qty in pipeline but not yet received; Qty on Future' may means future CO ( we do not really use this data )---  Since normally HD customer order qty are under 'Hard Commit' field in Jde report and AWF 'Soft Commit' filed in Jde report has covered all AWF customer order volume including both soft and hard commit - it is Grand Total for AWF
 ---  So really your true availalbe stock should be SOH - CO ( hard committed ) - AWF committed ( Softy committed ) + AWF SOH ( on P location ) ---
 
   --- also be careful:
  --- 1. that HD hard commitment might include AWF soft commit ?
  --- 2. HD hard commitment does not necessarily inlude all future customer orders - depends on the status - it is ST or SO ?
  --- 3. Back order can be just same as HD hard commit volume if we have 0 SOH - item 1019884(1424770) -- need to understand Back Order logic

 select * from JDE_DB_Alan.Jde_Item_Availability a where a.Short_Item_Num in ('807761','1422934','1334352','1066124','1379770','1403291','1116945')       --- '42.210.031','87.001.001','7456500914'
  select * from JDE_DB_Alan.Jde_Item_Availability a where a.Short_Item_Num in ('1001005')               --- '42.210.031','87.001.001','7456500914'
 select * from JDE_DB_Alan.Jde_Item_Availability a where a.Short_Item_Num in ('807761')

select a.Short_Item_Num,a.Business_Unit,a.QTY_On_Hand,a.Primary_Location,len(a.Business_Unit),len(a.Short_Item_Num)
from JDE_DB_Alan.Jde_Item_Availability a 
where a.Short_Item_Num in ('1334352')

  select * from JDE_DB_Alan.Jde_Item_Availability a where a.QTY_Hard_Committed is not null

----------------------------------------------------------------------------
  --- Find out Items in fabric awning category which is tube and had confirmed Customer order ------- may be not a good code, better to group by SKU
 select a.Short_Item_Num,b.ShortItemNumber,b.ItemNumber,a.Business_Unit,a.Primary_Location,a.Location_,a.Lot_Serial_Number
		,a.QTY_On_Hand,a.Qty_Soft_Committed,a.QTY_Hard_Committed
        ,b.StockingType,b.QtyOnHand,b.Description,b.FamilyGroup_,b.UOM,b.StandardCost
  from JDE_DB_Alan.Jde_Item_Availability a left join JDE_DB_Alan.vw_Mast b on a.Short_Item_Num = b.ShortItemNumber
 --where b.ItemNumber in ('42.210.031','87.001.001','7456500914','24.7127.0155','43.212.003','42.157.063','27.251.682','34.533.000')
  -- where b.FamilyGroup in ('965') and b.Family in ('THH') and b.StockingType in ('P') and b.Description like ('%tube%')
         where a.Short_Item_Num in ('1334352')
		---   a.QTY_Hard_Committed is null and a.Qty_Soft_Committed is null )   and b.StockingType in ('P')    --- this condition is wrong as 1 Item can have multiple location and Business Unit - some Line might have null some not under 1 SKU !!!
		    and  ( a.QTY_Hard_Committed is not null or a.Qty_Soft_Committed is not null ) and b.StockingType in ('P') 

------------------------------------------------------------------------------
--- Find out Item has no Customer confirmed SO and No AWF commitment ---- or Has confirmed SO/Commitment
 with t as (
	select a.Short_Item_Num,b.ItemNumber,a.Business_Unit,a.Primary_Location,a.Location_,a.Lot_Serial_Number
		,a.QTY_On_Hand,a.Qty_Soft_Committed,a.QTY_Hard_Committed
		,sum(isnull(a.Qty_hard_Committed,0)) over ( partition by a.short_item_num order by a.short_item_num)  as hard_cmit_ttl 
		,sum(isnull(a.Qty_Soft_Committed,0)) over ( partition by a.short_item_num order by a.short_item_num)  as soft_cmit_ttl  
        ,b.StockingType,b.QtyOnHand,b.Description,b.FamilyGroup_,b.UOM,b.StandardCost
  from JDE_DB_Alan.Jde_Item_Availability a left join JDE_DB_Alan.vw_Mast b on a.Short_Item_Num = b.ShortItemNumber
  -- where b.ItemNumber in ('27.251.682')
  -- where b.FamilyGroup in ('965') and b.Family in ('THH') and b.StockingType in ('P') and b.Description like ('%tube%')
     where a.Primary_Location in ('P')
      )
   , t_ as (select t.Short_Item_Num,t.ItemNumber,t.Description,t.StockingType,t.FamilyGroup_,t.UOM,avg(t.hard_cmit_ttl) as hard_ttl,avg( t.soft_cmit_ttl) as soft_ttl  
			from t 
			group by t.Short_Item_Num,t.ItemNumber,t.Description,t.StockingType,t.FamilyGroup_,t.UOM )

   select * from t_
 -- where t_.StockingType in ('P') and ( t_.soft_ttl = 0 and t_.hard_ttl = 0 )								--- 3107 records
   where t_.StockingType in ('P') and ( t_.soft_ttl <> 0 or t_.hard_ttl <> 0 ) and t_.StockingType in ('P')  --- 2459 records
   order by t_.FamilyGroup_

----------------------------------------------------------------------------------------
  --- Find out customer order /commit qty ( only in 'P' location ) in 'Primary Location' Field --- 10/8/2022
 with cust_committed_ttl as 		
        ( select a.Short_Item_Num,b.ItemNumber					
						,b.StockingType,b.QtyOnHand as SOH_ML345,b.Description,b.FamilyGroup_
						--,b.Family_0
						,b.UOM,b.StandardCost	
						,convert(varchar(7), DATEADD(mm, DATEDIFF(m,0,GETDATE()),0),120) as cust_commit_date	
					   -- ,convert( varchar(10),a.Reportdate,120)	as Rpt_date
					--,len(a.Business_unit) as bu_length					
					--,sum(isnull(a.qty_on_hand,0)) as hdsoh
					--,sum( case when (a.Business_Unit = 'HD' and a.Primary_Location = 'P') then a.QTY_On_Hand end ) as HD_SOH_0
					,sum( case when (a.Business_Unit = 'HD' and a.Primary_Location = 'P') then isnull(a.QTY_On_Hand,0) end) as HD_SOH_41021A	--- works, no need to  use isnull in front of sum() function as HD_SOH usually has value  -- 10/8/2022
					
					,isnull(sum(case when a.Business_Unit = 'AWF' and a.Primary_Location = 'P' then isnull(a.QTY_On_Hand,0)  end),0)   as AWF_SOH_41021A	---  need to  use isnull/coalesce in front of sum() function in case AWF_SOH does not have value	--- 10/8/2022	
					,isnull(sum(case when a.Business_Unit = 'HD' and a.Primary_Location = 'P' then isnull(a.QTY_On_PO,0)  end),0)   as HD_PO_41021A	---  need to  use isnull/coalesce in front of sum() function in case AWF_SOH does not have value	--- 10/8/2022	

					,coalesce(sum( case when a.Business_Unit = 'HD' and a.Primary_Location = 'P' then isnull(a.QTY_hard_Committed,0) end),0) as HD_hard_comit
					,coalesce(sum( case when a.Business_Unit = 'HD' and a.Primary_Location = 'P' then isnull(a.QTY_soft_Committed,0) end),0)  as HD_soft_comit
					,coalesce(sum( case when a.Business_Unit = 'AWF' and a.Primary_Location = 'P' then isnull(a.QTY_hard_Committed,0) end),0) as AWF_hard_comit
					,coalesce(sum( case when a.Business_Unit = 'AWF' and a.Primary_Location = 'P' then isnull(a.QTY_soft_Committed,0) end),0) as AWF_soft_comit
		
					,( coalesce(sum( case when a.Business_Unit = 'HD' and a.Primary_Location = 'P' then isnull(a.QTY_hard_Committed,0) end),0) + coalesce(sum( case when a.Business_Unit = 'AWF' and a.Primary_Location = 'P' then isnull(a.QTY_soft_Committed,0) end),0) ) as Qty_HD_hard_AWF_Soft_Commit
		            
					,isnull(sum(case when a.Business_Unit = 'HD' and a.Primary_Location = 'P' then isnull(a.QTY_Backordered,0)  end),0)   as HD_BO_41021A	---  need to  use isnull/coalesce in front of sum() function in case  does not have value	--- 10/8/2022	
					,isnull(sum(case when a.Business_Unit = 'AWF' and a.Primary_Location = 'P' then isnull(a.QTY_Backordered,0)  end),0)  as AWF_BO_41021A	---  need to  use isnull/coalesce in front of sum() function in case  does not have value	--- 10/8/2022	
					
					--,sum(isnull(a.Qty_hard_Committed,0)) over ( partition by a.short_item_num order by a.short_item_num)  as hard_cmit_ttl 
					--,sum(isnull(a.Qty_Soft_Committed,0)) over ( partition by a.short_item_num order by a.short_item_num)  as soft_cmit_ttl  
        
				  from JDE_DB_Alan.Jde_Item_Availability a left join JDE_DB_Alan.vw_Mast b on a.Short_Item_Num = b.ShortItemNumber		
				 --where b.FamilyGroup in ('965') and b.Family in ('THH') and b.StockingType in ('P') and b.Description like ('%tube%')  
				   where b.StockingType in ('P') and a.Primary_Location in ('P') 
						  --and a.Business_Unit in ('HD')
						 -- and b.ItemNumber in ('7456500914','42.210.031')
						 --   and b.ItemNumber in ('1019884')
						   and b.ItemNumber in ('38.013.001','28.665.131')
				   group by a.Short_Item_Num,b.ItemNumber,b.StockingType,b.QtyOnHand,b.Description,b.FamilyGroup_
							--,b.Family_0
							,b.UOM,b.StandardCost
							-- ,convert( varchar(10),a.Reportdate,120)	
				 --group by a.Short_Item_Num,b.ItemNumber  ---a.Business_Unit,a.Primary_Location			
                    
					)
   
   select * from cust_committed_ttl t
  
  select * from JDE_DB_Alan.vw_Cust_Commit_TTL a where a.ItemNumber in ('38.013.001','28.665.131') 
-------------------------------------------------------------------------------------
              --- combine Item Availability data with vw_Mast --- be careful better use vw_vw_Cust_Commit_TTL to avoid duplicates -- do not use this one
 select a.Short_Item_Num,b.ItemNumber,a.Business_Unit,b.StockingType,a.Primary_Location
		,a.QTY_On_Hand,a.Qty_Soft_Committed,a.QTY_Hard_Committed
		--,sum(isnull(a.Qty_Soft_Committed,0)) as soft_cmit_ttl 
		--,sum(isnull(a.Qty_hard_Committed,0)) as hard_cmit_ttl 
        ,b.QtyOnHand as SOH_ML345,b.Description,b.FamilyGroup_,b.UOM,b.StandardCost
  from JDE_DB_Alan.Jde_Item_Availability a left join JDE_DB_Alan.vw_Mast b on a.Short_Item_Num = b.ShortItemNumber
 -- from JDE_DB_Alan.vw_Cust_Commit_TTL a left join JDE_DB_Alan.vw_Mast b on a.Short_Item_Num = b.ShortItemNumber

 where b.ItemNumber in ('42.210.031','87.001.001','7456500914')


-------------------------------------------------------------------------------------
      --- combine Item Availability data with Fcst table --- works

 select a.Short_Item_Num,b.ItemNumber,b.StockingType,a.AWF_SOH_41021A,a.HD_SOH_41021A,a.HD_PO_41021A,a.HD_hard_comit,a.AWF_soft_comit	
		--,sum(isnull(a.Qty_Soft_Committed,0)) as soft_cmit_ttl 
		--,sum(isnull(a.Qty_hard_Committed,0)) as hard_cmit_ttl 
        ,b.QtyOnHand as SOH_ML345,b.Description,b.FamilyGroup_,b.UOM,b.StandardCost
		,c.ItemNumber,c.DataType1,c.Date,c.Value as FC_Val
  from JDE_DB_Alan.vw_Cust_Commit_TTL a left join JDE_DB_Alan.vw_Mast b on a.Short_Item_Num = b.ShortItemNumber
       left join JDE_DB_Alan.FCPRO_Fcst c on c.ItemNumber = b.ItemNumber
 where  b.ItemNumber in ('38.013.001','28.665.131')
		--b.ItemNumber in ('38.013.001','28.665.131','42.210.031','87.001.001','7456500914')
       and c.DataType1 in ('Adj_FC')
	   and c.Date = DATEADD(mm, DATEDIFF(m,0,GETDATE()),0)


  ------ Update 'Stat_FC' using Item Availability  ------ fc table  	  
;update f
 set f.value = f.Value + b.AWF_soft_comit
  --select a.ShortItemNumber,a.ItemNumber,a.StockingType,b.AWF_SOH_41021A,b.HD_SOH_41021A,b.HD_PO_41021A,b.HD_hard_comit,b.AWF_soft_comit,a.QtyOnHand as SOH_ML345,a.Description,a.FamilyGroup_,a.UOM,f.ItemNumber,f.DataType1,f.Date,f.Value as FC_Val    
  from JDE_DB_Alan.FCPRO_Fcst f left join JDE_DB_Alan.vw_Mast a on f.ItemNumber = a.ItemNumber
          left join JDE_DB_Alan.vw_Cust_Commit_TTL b on a.ShortItemNumber = b.Short_Item_Num                                                                            
  where f.ItemNumber in  ('38.013.001' ,'28.665.131')
		and f.DataType1 ='Adj_FC' 
		and f.Date = DATEADD(mm, DATEDIFF(m,0,GETDATE()),0)					--- one month data
		and a.FamilyGroup in ('971','910')


------- Use for offline analysis purpose ------------------------------------------------------------------------------------
---- currently there is no connection to FC Pro or Jde , all connection is Excel and CSV file manually loaded into system ----
--- new forecast / Market intelligence etc --- 

-- for example I would like to see which products has expired and not expired for 12 months to reach matured date so I can take off NP forecast and let system to drive 
-- future forecast --- you can use excel formula to drive the process, then it will looks ugly, you need to delete line, move line, add line etc

--1. if you want to see what is impact of particular range product fc incrase ?
--2. who has bought a particular products and what are those customers in both volumes and sales price ? for over last 3 years ?
--3. if you want to see who is vendor for particular product - who is planner ? what is cost price ? what is preto ?
    --- what is sales in past 2 years -- combine sales and forecast together 
-- 4. if you want to see the safety stock --- how much sales is below certain amount ? any abnormal sales for certain period ?
--- if you want to see any forecast is 30% greater than or 50% less than history ? count how many period has greater than average ?
--- supersession based on short item number ---
--- item import or local --- Q M wether it is local or import make to order 
--- item in transit to obsolete however keep active when we still have stock to allow deliver to customer but not allow for forecast 
-- item with no history 
--- itenm hierarchy 
--- excel formula after a while you forget what does it do and why you want to do it ... and it is messy
--- plus it is not db tool and cannot hold huge data... it is not a database tool 


  ------ Update 'Stat_FC' --- 2023 recession projection - update by category  ------ fc table  	  
;update f
 -- set f.value = f.Value + b.AWF_soft_comit
    set f.value =  (case 	
							when substring(a.FamilyGroup_,1,3) = '998'  then  f.Value  * 0.95
						    when substring(a.FamilyGroup_,1,3) = '999'   then f.Value * 1
							when substring(a.FamilyGroup_,1,3) = '991'  then  f.Value * 1
						    when substring(a.FamilyGroup_,1,3) = '943'   then f.Value * 1

							when substring(a.FamilyGroup_,1,3) = '900'  then  f.Value * 0.95
						    when substring(a.FamilyGroup_,1,3) = '910'   then f.Value * 1
							when substring(a.FamilyGroup_,1,3) = '913'  then  f.Value * 1

						    when substring(a.FamilyGroup_,1,3) = '964'   then f.Value * 0.95 
							when substring(a.FamilyGroup_,1,3) = '965'  then  f.Value * 0.95			--- 42.210.031
						    when substring(a.FamilyGroup_,1,3) = '966'   then f.Value * 0.95
							when substring(a.FamilyGroup_,1,3) = '96A'  then  f.Value * 0.95

						    when substring(a.FamilyGroup_,1,3) = '971'   then f.Value * 0.915 
							when substring(a.FamilyGroup_,1,3) = '972'  then  f.Value * 0.95
						    when substring(a.FamilyGroup_,1,3) = '973'   then f.Value * 0.95
							when substring(a.FamilyGroup_,1,3) = '974'  then  f.Value * 0.913			--- 24.7218.0199
							when substring(a.FamilyGroup_,1,3) = '977'  then  f.Value * 0.915
							when substring(a.FamilyGroup_,1,3) = '979'  then  f.Value * 0.95

						    when substring(a.FamilyGroup_,1,3) = '981'   then f.Value * 0.95
							when substring(a.FamilyGroup_,1,3) = '982'  then  f.Value * 0.913
						    when substring(a.FamilyGroup_,1,3) = '983'   then f.Value * 0.95
							when substring(a.FamilyGroup_,1,3) = '984'  then  f.Value * 0.95
						    when substring(a.FamilyGroup_,1,3) = '986'   then f.Value * 0.95
							when substring(a.FamilyGroup_,1,3) = '989'   then f.Value * 0.95
							
							when substring(a.FamilyGroup_,1,3) = '990'  then  f.Value * 0.95
						    when substring(a.FamilyGroup_,1,3) = '992'   then f.Value * 1

                           	when substring(a.FamilyGroup_,1,3) = 'TPA'  then  f.Value * 1
						    when substring(a.FamilyGroup_,1,3) = 'VAA'   then f.Value * 1

				  end )

  --select a.ShortItemNumber,a.ItemNumber,a.StockingType,b.AWF_SOH_41021A,b.HD_SOH_41021A,b.HD_PO_41021A,b.HD_hard_comit,b.AWF_soft_comit,a.QtyOnHand as SOH_ML345,a.Description,a.FamilyGroup_,a.UOM,f.ItemNumber,f.DataType1,f.Date,f.Value as FC_Val    
  from JDE_DB_Alan.FCPRO_Fcst f left join JDE_DB_Alan.vw_Mast a on f.ItemNumber = a.ItemNumber
          left join JDE_DB_Alan.vw_Cust_Commit_TTL b on a.ShortItemNumber = b.Short_Item_Num                                                                            
  where  
		--f.ItemNumber in  ('24.7218.0199','42.210.031') and 
		 f.DataType1 ='Adj_FC' 
		--and f.Date = DATEADD(mm, DATEDIFF(m,0,GETDATE()),0)
		--and a.FamilyGroup in ('971','910')


select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('42.210.031','24.7218.0199') and f.DataType1 in ('Adj_FC')
select a.ItemNumber,a.FamilyGroup_,substring(a.FamilyGroup_,1,3) as Fam
from JDE_DB_Alan.vw_Mast a where a.ItemNumber in ('42.210.031')


 
   --- select into will create a new table ---
  select * into FCPRO_Fcst_History_May2021OriginalSavedFC from JDE_DB_Alan.FCPRO_Fcst_History a where a.ReportDate > '2021-06-01'

   --- insert into will add data to existing table ---
   insert into JDE_DB_Alan.FCPRO_Fcst_History select * from JDE_DB_Alan.FCPRO_Fcst a where a.DataType1 in ('Adj_FC') and a.ItemNumber in ('42.210.031')
  
   select * from JDE_DB_Alan.FCPRO_Fcst_History a where a.DataType1 in ('Adj_FC') and a.ItemNumber in ('42.210.031') and a.ReportDate > '2022-11-01'
  
   select * from JDE_DB_Alan.FCPRO_Fcst a where a.DataType1 in ('Adj_FC') and a.ItemNumber in ('42.210.031') 


 ---===========================================================================================================================


-------------------------------------------------------------------------------------
select f.ItemNumber,m.Description,m.Colour,m.PrimarySupplier,m.SupplierName,m.Pareto,m.StandardCost,f.FCDate2_,f.FC_Vol,m.StandardCost *f.FC_Vol as Stock_$
 from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
  where m.Description like  ('%profile%') and m.StockingType not in ('O','U') and m.FamilyGroup in ('965')
        and m.ItemNumber not like ('4%')
  order by m.Colour


select  f.ItemNumber,m.Description,m.Colour,m.PrimarySupplier,m.SupplierName,m.Pareto,m.StandardCost,f.FCDate2_,f.FC_Vol,m.StandardCost *f.FC_Vol as Stock_$
 from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
  where  m.StockingType not in ('O','U') and m.FamilyGroup in ('965') and ( m.ItemNumber like ('74785%') or m.ItemNumber like ('747870%') )
 -- where  m.StockingType not in ('O','U') and m.FamilyGroup in ('965') and m.ItemNumber like ('747870%')
  order by m.Colour


  select distinct  f.ItemNumber,m.Description,m.Colour,m.PrimarySupplier,m.SupplierName,m.Pareto,m.StandardCost
 from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
  where  m.StockingType not in ('O','U') and m.FamilyGroup in ('973') and ( m.ItemNumber like ('74785%') or m.ItemNumber like ('747870%') )
 -- where  m.StockingType not in ('O','U') and m.FamilyGroup in ('965') and m.ItemNumber like ('747870%')
  order by m.Colour

 select a.ItemNumber,a.FamilyGroup_,a.Description,a.StockingType from JDE_DB_Alan.vw_Mast a
where a.ItemNumber in ('42.210.031','25.010.0155','32.555.155','82.068.912' )


  select distinct  f.ItemNumber,m.Description,m.Colour,m.PrimarySupplier,m.SupplierName,m.Pareto,m.StandardCost
 from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
  where  m.StockingType not in ('O','U') and m.FamilyGroup in ('973')
  order by m.Pareto asc
---========================================================================================


	   ;with R(N,_T,T_,T,XX,YY,start) AS
						(
							select 1 as N,-36 as _T,36 as T_,-35 as T,36 as XX,36 as YY,cast(DATEADD(mm, DATEDIFF(mm, 0, GETDATE())-36, 0) as datetime) as start      -- pay attention T starts -23,you need this so you can get XXX Column/Field in current month you start as 1, otherwise you can use XX field
							UNION ALL
							select  N+1, _T+1,T_-1,case when T+1<0 then T+1 else case when T+1 =0 then 1 else T+1 end end as T						
												,case when N >= 36  then _T+1
													else  
														XX-1
													end as XX
													,case when N >= 36  then T							     
													else  
														YY-1
													end as YY
									,dateadd(mm,1,start)
							from R
							where N < 61
						)
				--select * from r


---================================================================================================


-----------------------------------------------------------------------------------------
select * from JDE_DB_Alan.vw_SafetyStock a where a.ItemNumber in ('82.691.903','26.900.820')
select * from JDE_DB_Alan.FCPRO_SafetyStock a where a.ItemNumber in ('46.021.000','43.211.004','26.100.000','26.196.000','38.001.001','38.001.003')
select * from JDE_DB_Alan.FCPRO_SafetyStock a where a.ItemNumber in ('42.357.804')

select * from JDE_DB_Alan.HD_WorkCenter
select * from JDE_DB_Alan.HD_WorkCenter_Staging

select *
select * from JDE_DB_Alan.vw_Mast a where a.ItemNumber in ('87.100.001','87.501.010','87.200.001','87.201.001','87.225.910','87.502.001','7126070000','7127150000','7127510000','7127600000','7127620000','7127650000','7127660000','7127690000','7127700000','7127710000','7127900000','7127910000','7127940000','7127950000','7127960000','7127970000','7127990000','7129200000','7134210000','7134230000','7146500000','7236040000','7390020000','7390030000','7390930000','7390950000','7442700000','7468700000','7477700000','7478700000','7479700000','7488700000','7489700000','7491700000','7493700000','7494700000','7497700000','7498700000','7499700000','7742140000')
select * from JDE_DB_Alan.Master_V4102A a where a.Item_Number in ('87.100.001')

select * from JDE_DB_Alan.vw_FC
select * from JDE_DB_Alan.MasterFamily a where a.LongDescription like ('VE%')

select top 3 * from JDE_DB_Alan.vw_Mast a where a.ItemNumber in ('43.205.637M')
select * from JDE_DB_Alan.FCPRO_SafetyStock a where a.ItemNumber in ('7491700914','26.045.1803','26.812.902','87.225.220')

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber like ('52.%') and m.Family in ('635') and m.Colour like ('Yalu%')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber like ('34.7%')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber like ('26.092%') 
select * from JDE_DB_Alan.vw_Mast m where m.Description like ('%cap%') and m.ItemNumber like ('32.%')
select * from JDE_DB_Alan.vw_Mast m where m.Description like ('%ellipse%') 

select sum(m.StockValue) from JDE_DB_Alan.vw_Mast m


select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('26.045.4499')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber like ('44.013.00%')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber like ('42.210.031%')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber like ('43.211.004%')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber like ('44.011.03%')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber like ('43.212.004%') or m.ItemNumber like ('26.900.820%')
select * from JDE_DB_Alan.vw_SafetyStock a where a.ItemNumber in ('43.212.003','26.900.820','34.357.000','82.523.905')
select * from JDE_DB_Alan.FCPRO_SafetyStock a where a.ItemNumber in ('52.021.100')
select m.ItemNumber,m.ShortItemNumber,m.Colour,m.Description from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('38.010.001','38.010.002','38.010.003','38.010.004','38.010.005','38.010.006','38.010.007')
select m.ItemNumber,m.ShortItemNumber,m.Colour,m.Description from JDE_DB_Alan.vw_Mast m where m.ItemNumber in  ('38.011.001','38.011.002','38.011.003','38.011.004','38.011.005','38.011.006','38.011.007')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('24.5349.0204','24.5349.1858','24.5353.0204','24.5353.1858','24.5354.0204','24.5354.1858','24.5411.0000','24.5412.0000','24.5413.0000','24.5414.0000','24.5415.0000','24.5416.0000','24.5417.0000','24.5418.0000','24.5424.0204','24.5425.0204','24.5426.0204','24.5426.1858','24.5427.0204','24.5427.1858','24.7002.0001T','24.7100.0199','24.7100.1858','24.7100.4459A','24.7100.7052A','24.7102.0199','24.7102.1858','24.7110.0155','24.7110.1858','24.7120.0155','24.7120.0952A','24.7120.1858','24.7120.4459A','24.7121.0155','24.7121.0952A','24.7121.1858','24.7121.4459A','24.7122.0155','24.7122.0952A','24.7122.1858','24.7122.4459A','24.7123.0155A','24.7124.0155','24.7124.0952A','24.7124.1858','24.7124.4459A','24.7127.0155','24.7127.0952','24.7127.1858','24.7127.4459','24.7128.0155A','24.7128.0952A','24.7128.1858A','24.7128.4459A','24.7129.0155A','24.7129.1858A','24.7133.0155A','24.7133.1858A','24.7136.0155A','24.7136.1858A','24.7201.0000T','24.7202.0000','24.7202.0001','24.7203.0000','24.7203.0001','24.7220.0199','24.7220.0952','24.7333.0199','24.7333.1858','24.7334.0199','24.7334.1858','24.7353.0000A','24.7363.0199','24.7363.1858','24.7364.0199','24.7364.1858','32.379.200','32.380.002','32.380.855','32.455.155','32.455.462','32.455.855')


select* from JDE_DB_Alan.FCPRO_SafetyStock a where a.ItemNumber in ('26.350.820','52.008.734','43.211.004','26.144.0204','7491700914')

select* from JDE_DB_Alan.FCPRO_SafetyStock a where a.ItemNumber in ('38.006.001','43.211.004','43.207.584M','7442700914','82.036.915')
select* from JDE_DB_Alan.FCPRO_SafetyStock a where a.ItemNumber in ( '46.607.134','43.211.005','26.900.676','26.900.659')

select distinct f.ItemNumber from  JDE_DB_Alan.FCPRO_Fcst f 
  where f.ItemNumber in ( select m.ItemNumber from JDE_DB_Alan.vw_Mast m where m.FamilyGroup in ('910') )

select distinct f.ItemNumber from  JDE_DB_Alan.FCPRO_Fcst f 
  where f.ItemNumber in ( select m.ItemNumber from JDE_DB_Alan.vw_Mast m where m.FamilyGroup in ('965') )

select * from JDE_DB_Alan.vw_SafetyStock a where a.ItemNumber in ('26.045.4499')
select* from JDE_DB_Alan.FCPRO_SafetyStock a where a.ItemNumber in ('26.045.4499')

select * from JDE_DB_Alan.MasterFamily


exec JDE_DB_Alan.sp_Mismatch_HD_RCCP 'GRP_1','2022-03-01',null			--43,830 records
exec JDE_DB_Alan.sp_Mismatch_HD_RCCP 'GRP_1','2022-03-02',null			--48,213 records 
exec JDE_DB_Alan.sp_Mismatch_HD_RCCP 'GRP_1','2022-04-02',null			--52,596 records 


select distinct a.ItemNumber from JDE_DB_Alan.SlsHist_Excp_FCPro_upload a
select * from JDE_DB_Alan.SlsHist_Excp_FCPro_upload a
order by a.Date_Updated
order by a.ItemNumber,a.Date_Updated,a.ReportDate

select * into JDE_DB_Alan.SlsHist_Excp_FCPro_upload_copy from JDE_DB_Alan.SlsHist_Excp_FCPro_upload
select * from JDE_DB_Alan.SlsHist_Excp_FCPro_upload_copy


---***************************************************************************
-- Use local variable,query yield result instantaneously wow !!! 18/6/2021  
--- https://stackoverflow.com/questions/440944/sql-server-query-fast-but-slow-from-procedure  --- 
---We can create local variables and assign the input parameter to the local variables and use the local variables in the query. And in that case, since we didn't use the procedural parameter directly in the query,
--- it will generate a generic query execution plan.

--- The same stored procedure can be written this way to avoid parameter sniffing:
---***************************************************************************


exec JDE_DB_Alan.sp_Mismatch_HD_RCCP_test 'GRP_1','2022-09-01',null					--- 'RCCP_Test'  uses Local variable	




exec JDE_DB_Alan.sp_Mismatch_HD_RCCP 'GRP_2','2022-03-02',null			-- fc up to Mar 2022, 30,591 records


select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber like ('42.361.%')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('7441500001','7441500182','7441500914','7441700001','7441700182','7441700914','7442700001','7442700182','7442700914','7456500182','7457500001','7457500182','7457500914','7460500000','7460700000','7468500001','7468500182','7468500914','7468700001','7468700182','7468700914','7477500001','7477500182','7477500914','7477700001','7477700182','7477700914','7478500001','7478500182','7478500914','7478700001','7478700182','7478700914','7479500001','7479500182','7479500914','7479700001','7479700182','7479700914','7485700000','7488500001','7488500182','7488500914','7488700001','7488700182','7488700914','7489500001','7489500182','7489500914','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700001','7494700182','7494700914','7497700001','7497700182','7497700914','7498700001','7498700182','7498700914','7499700001','7499700182','7499700914','7766050000','7766070000','7766250000','46.508.500','46.508.700','46.531.500','46.531.700')
order by m.Pareto


select * from [JDE_DB_Alan].[SlsHistoryHD]

select * from [hd-vm-bi-sql01.hd.local].HDDW_PRD.star.d_product p where p.item_code in ('44.011.007')      --- works ! 3/6/2020  -- need to created new linked server : hd-vm-bi-sql01.hd.local
select * from [hd-vm-bi-sql01].HDDW_PRD.star.d_product p where p.item_code in ('44.011.007')              --- not working, if your linked server is : hd-vm-bi-sql01   3/6/2020


select p.item_code,p.Item_Number,p.stock_type_desc,m.Pareto,m.StockValue
	from [hd-vm-bi-sql01.hd.local].HDDW_PRD.star.d_product p left join JDE_DB_Alan.JDE_DB_Alan.vw_Mast m 
			on p.Item_code collate database_default  = m.ItemNumber collate database_default
	where p.item_code in ('RBSC','24.7334.0199') and p.jde_business_unit = 'HD'

select p.item_code,p.stock_type_desc,m.Pareto,m.StockValue
from [hd-vm-bi-sql01.hd.local].HDDW_PRD.star.d_product p left join JDE_DB_Alan.JDE_DB_Alan.vw_Mast m 
      on p.Item_code collate database_default  = m.ItemNumber collate database_default
	  where p.item_code in ('RBSC','24.7334.0199','42.210.031') and p.jde_business_unit = 'HD'




---------*********************************************************************************************************************---------
---=========== Use linked server hd-vm-bi-sql01.hd.local to created a query to query data in HDDDW ! 3/6/2020 ==========------



---------------  Get WO parts number from Work orders --------------------------------------        17/2/2020 ----------------------
 -------------  Get all Sales history On components level across HD and AWF channel ---- by exploring Comp level details from AWF Sales order ( breaks/exploded down to parts level from Finished Blinds to component ) --- 19/3/2020

select count(*) from HDDW_PRD.star.f_wo_parts_list      --- 17,656,155 rows , 96 columns --- huge table --- 2017 to 2019 ( total 3 years records of WO details )
select * from HDDW_PRD.star.f_wo_parts_list				--- 17 million records, appox 1 min = 1 million records ( nearlly 100 columns )
select top 3 *  from HDDW_PRD.star.f_wo_parts_list	


select l.wo_number from HDDW_PRD.star.f_wo_parts_list l    --- search 1 column only, it takes 2 mins

--- Note:
--- F3111 is JDE table on which work order fetched from...
--- F4211  is Jde table which stores 'Open sales' order - Sales order which has not been materilized yet ( anything could happen ) - 980/990 cancelled order need to be excluded;
---  F42119 is Jde table which stores 'CLosed sale' order - invoiced history - 620/980 invoiced.


--- combined sales (history + open sales order ) ---  17/2/2020
--- Not Or And Combined ... http://www.peachpit.com/articles/article.aspx?p=1276352&seqNum=6

;with so as

  (  	select * from [hd-vm-bi-sql01.hd.local].HDDW_PRD.star.f_so_detail_history
		union all
		 --select * from HDDW_PRD.star.f_so_detail_current c where c.last_line_status_code + c.next_line_status_code <> '980999' and c.item_code in ('FAMT')  --- 12196
		-- select * from HDDW_PRD.star.f_so_detail_current c where c.last_line_status_code <> '980' and c.next_line_status_code <> '999' and c.item_code in ('FAMT')  --- 11810
		 select * from [hd-vm-bi-sql01.hd.local].HDDW_PRD.star.f_so_detail_current c where not ( c.last_line_status_code = '980' and c.next_line_status_code = '999')		--- 13022  -- use this one !!
		-- select * from HDDW_PRD.star.f_so_detail_current c where (not c.last_line_status_code = '980')  or ( not c.next_line_status_code = '999')  --- 13022
		-- select * from HDDW_PRD.star.f_so_detail_current c where ( c.last_line_status_code <> '980')  or (  c.next_line_status_code <> '999')  --- 13022
		        
		)
  --select * from  so
   
   ,part_list as 
   
	   (select so.order_number as So_num,so.work_order_number as So_wo_num,pr.wo_number as Part_wo_num
			 ,so.d_product_key as Parent_pd_key,so.item_code as Parent,pr.d_product_key Child_pd_key,pr.item_code as Child,pr.parts_description2,so.primary_quantity as ParentSoldQty,pr.quantity as ChildSoldQty,pr.uom Child_uom,c.contact_name as customer,so.order_date
		 from so left join [hd-vm-bi-sql01.hd.local].HDDW_PRD.star.f_wo_parts_list pr on so.work_order_number = pr.wo_number
			   left join  [hd-vm-bi-sql01.hd.local].HDDW_PRD.star.d_product pd on so.d_product_key = pd.d_product_key 
			   left join [hd-vm-bi-sql01.hd.local].HDDW_PRD.star.d_customer c on so.d_customer_key = c.d_customer_key
		  where --so.item_code in ('FAMT')
		  --  and so.jde_business_unit = 'AWF'    
			--and so.work_order_number = '04685890'   
			--and pr.item_code in ('42.421.855','52.018.000','44.011.007')
			-- so.order_number in ('5641025')						--  Fabrique store Project - DUMMY ORDER FOR FABRIQUE FOR LARGE COMMERCIAL ORDER 5641025 -- 1/6/2020
		    so.order_number in ('5642227')							--  NELLIE MELBA RETIREMENT Vic            11/6/2020

			)
	  select p.*,m.PlannerNumber from  part_list p left join JDE_DB_Alan.vw_Mast m 
				-- on p.Child COLLATE Latin1_General_CS_AS = m.ItemNumber COLLATE Latin1_General_CS_AS			--- works 3/6/2020    'The root cause is that the sql server database you took the schema from has a collation that differs from your local installation. If you don't want to worry about collation re install SQL Server locally using the same collation as the SQL Server 2008 database.
				 on p.Child	COLLATE DATABASE_DEFAULT = m.ItemNumber COLLATE DATABASE_DEFAULT			 --- works 3/6/2020			'This is extremely useful. I'm using a local database and querying against a linked server and they have two different collations. Obviously I can't change the collation on the linked server, and I didn't want to change mine locally, so this is absolutely the best answer. 


---===============================================================================================================================------


------------------------------------------------------------------------------------
-- Add new table
CREATE TABLE TOY.BRANDS
(
ID INT NOT NULL,
NAME VARCHAR(20) NULL
)
GO

-- Load the table with data
INSERT INTO TOY.BRANDS (ID, NAME) VALUES
(1, 'Ford'),
(2, 'Chevy'),
(3, 'Dodge'),
(4, 'Plymouth'),
(5, 'Oldsmobile'),
(6, 'Lincoln'),
(7, 'Mercury');
GO

--- from one table --
CREATE TABLE suppliers
  AS (SELECT id, address, city, state, zip
      FROM companies
      WHERE id > 1000);

--- from 2 tables ---
CREATE TABLE suppliers
  AS (SELECT companies.id, companies.address, categories.cat_type
      FROM companies, categories
      WHERE companies.id = categories.id
      AND companies.id > 1000);


 --- This would create a new table called suppliers that included all columns from the companies table, but no data from the companies table --- retain table structure but no data is copied over
CREATE TABLE suppliers
  AS (SELECT *
      FROM companies WHERE 1=2);



--------- Create table and insert data multiple rows-----------

CREATE TABLE recipes (
  recipe_id INT NOT NULL,
  recipe_name VARCHAR(30) NOT NULL,
  PRIMARY KEY (recipe_id),
  UNIQUE (recipe_name)
);

INSERT INTO recipes (recipe_id, recipe_name) 
VALUES 
    (1,"Tacos"),
    (2,"Tomato Soup"),
    (3,"Grilled Cheese");

---------- create temp table # ( if need > 1000 records )-----------------

Local Temporary Tables (#temp)  
Global Temporary Tables (##temp)  
  
CREATE TABLE #StudentTemp  
(  
    StudentID int,  
    Name varchar(50),   
    Address varchar(150)  
)  
GO  
INSERT INTO #StudentTemp VALUES ( 1, 'Dipendra','Pune');  
GO  
SELECT * FROM #StudentTemp  

------------Create table variable @ -----------------------------------
DECLARE @table AS TABLE (id INT, col VARCHAR(20))

 DECLARE @TStudent TABLE  
 (  
    RollNo INT IDENTITY(1,1),  
    StudentID INT,  
    Name INT  
 )   
 --Insert data to Table variable @TStudent   
 INSERT INTO @TStudent(StudentID,Name)  
 SELECT DISTINCT StudentID, Name FROM StudentMaster ORDER BY StudentID ASC 


 ------------- Vendor XRef Cross Ref---------------------- 9/9/2020  

-- select * from JDE_DB_Alan.vw_Mast m where m.StockingType in ('P','Q','S','M')  	--- 48,652 records   --- 7107 active items  14%, 86% rubbish
-- select * from JDE_DB_Alan.Master_Vendor_Item_CrossRef c							--- 32,640 records		 --- 8493 active items 26%, 74% rubbish

/****** Script for SelectTopNRows command from SSMS  ******/
SELECT m.*,c.Customer_Supplier_ItemNumber,c.Address_Number,c.EffectiveDate,c.ExpiredDate
  FROM JDE_DB_Alan.vw_Mast m left join JDE_DB_Alan.Master_Vendor_Item_CrossRef c
      on m.ShortItemNumber = c.ShortItemNumber
      and m.PrimarySupplier = c.Address_Number

where m.StockingType in ('P','Q','S','M')                       --- 7445 
     -- and c.Customer_Supplier_ItemNumber is null				--- 1983	
	  -- and c.Customer_Supplier_ItemNumber is not  null		-- 5459, sometime null means Xref has not updated yet, not necessarily does not have one
	 -- and m.ItemNumber in ('26.108.000')
	  and c.ExpiredDate = '1950-12-31'							-- 5071 


select * 
	from JDE_DB_Alan.vw_Mast m left join 

	(select  c.ShortItemNumber,c.Customer_Supplier_ItemNumber,c.Address_Number,c.EffectiveDate,c.ExpiredDate
		from JDE_DB_Alan.Master_Vendor_Item_CrossRef c
		where c.ShortItemNumber in ( select a.ShortItemNumber from JDE_DB_Alan.vw_Mast a where a.StockingType in  ('P','Q','S','M')   )
		)tb  on m.ShortItemNumber = tb.ShortItemNumber and m.PrimarySupplier = tb.Address_Number

where m.StockingType in ('P','Q','S','M')  
      and tb.ExpiredDate = '1950-12-31'

select * from JDE_DB_Alan.vw_Mast_Vendor_Item_CrossRef m where m.ItemNumber in ('26.108.000')

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('40.260.433','40.260.131','40.153.804','40.260.804','40.260.378','42.180.131','40.153.433','40.153.131','40.153.805','40.153.228','40.260.228','40.153.280','40.260.430','40.153.378','40.153.430','40.260.805','40.260.341','40.153.297','40.153.081','40.042.228','40.158.131','40.042.280','40.132.804','40.042.378GB','40.153.209','40.042.430','40.041.228','40.042.433','40.041.433','40.042.433GB','40.042.131GB','40.042.804','40.152.131','40.042.805','40.153.083','40.129.131','40.041.131','40.129.131GB','40.153.341','40.129.228','40.041.378','40.129.228GB','40.260.082','40.129.280','40.260.297','40.129.280GB','40.041.805','40.129.378','40.132.433','40.129.378GB','40.132.805','40.129.430','40.153.080','40.129.430GB','40.153.082','40.129.433','40.026.131','40.129.433GB','40.026.378','40.129.804','40.153.286','40.129.804GB','40.153.322','40.129.805','40.041.131GB','40.129.805GB','40.041.280','40.024.131','40.041.378GB','40.262.131','40.260.080','40.346.131','40.041.430','40.025.131','40.260.286','42.185.049','40.260.322','40.132.228','40.041.804','40.132.280','40.042.131','40.132.378','40.132.430','40.131.131','40.263.131','40.131.131GB','42.180.049','40.131.378','42.184.049','40.131.378GB','40.132.131','40.042.378','42.647.804','24.7134.0952A','82.068.904','24.7197.0000A','24.7195.0199A','24.7210.0199','60.719.407','24.7210.0952','24.7196.7060A','24.7210.1858','24.7168.0952A','24.7210.4459','42.361.104','24.7224.0155A','46.556.000','24.7224.0952A','82.028.910','24.7224.1858A','82.068.935','24.7224.4459A','24.7129.4459A','24.7254.0000','40.170.173','24.7254.0199','24.7192.7060A','24.7254.0952','42.357.273','24.7254.1858','42.361.805','24.7254.4459','46.521.500','24.7302.0199A','58.225.277','24.7302.1858A','82.028.901','24.7304.0155A','82.028.932','24.7304.1858A','82.068.926','24.7306.0155A','F16174A977','24.7306.1858A','24.7128.4459A','24.7311.0155A','24.7133.0952A','24.7311.1858A','24.7136.1858A','24.7316.0155A','24.7146.1858A','24.7316.1858A','24.7169.0952A','24.7323.0155A','40.415.173','24.7323.1858A','42.357.000','24.7344.7060A','42.357.804','24.7353.0000A','42.361.413','24.7355.0952A','42.647.185','24.7371.0005A','43.205.565M','24.7398.0155A','46.549.000','24.7398.1858A','46.569.000','26.118.102','60.709.407','26.118.144','64.804.235','26.118.307','82.028.905','26.118.347','82.028.927','26.118.456','82.028.936','26.121.347','82.068.909','26.121.711','82.068.931','26.133.309','E40174A689','26.264.002','F8174A908','26.350.820','24.7128.0952A','26.354.0204','24.7129.0952A','26.354.0952','24.7131.0000A','26.354.1650','24.7133.4459A','26.354.1858','24.7134.4459A','26.354.4451','24.7138.1858A','26.354.4459','40.175.002','26.804.000','24.7163.0000A','26.805.000','24.7168.4459A','26.806.000','24.7169.4459A','26.836.000A','40.345.131','26.837.000A','24.7194.0199A','26.838.000A','42.333.000','26.842.000A','42.357.131','26.844.000A','42.357.481','26.846.000A','42.357.810','26.847.000A','42.361.252','26.848.000A','42.361.493','26.849.030A','42.647.104','26.850.000A','42.647.481','26.852.000A','42.647.810','26.853.000A','43.205.571M','26.854.000A','46.522.500','26.856.000A','46.553.030','26.857.000A','46.559.030','26.858.000A','46.597.000','26.860.000A','60.708.407','27.241.580','60.718.407','27.241.581','64.764.182','27.241.862','64.809.235','27.244.614','82.028.903','27.244.622','82.028.907','2780143890B','82.028.912','28.644.000','82.028.930','28.644.858','82.028.934','28.645.000','82.068.902','28.645.858','82.068.906','28.646.000','82.068.911','28.646.858','82.068.928','28.647.000','82.068.933','28.647.858','D8174A700','28.680.000','F16174A949','32.507.000','F17174A952','32.508.000','F8174A949','32.509.000','24.7128.0155A','32.510.000','24.7128.1858A','32.511.000','24.7129.0155A','32.512.000','24.7129.1858A','32.513.000','24.7130.0000A','32.514.000','24.7133.0155A','34.020.000','24.7133.1858A','2950010785','24.7134.0155A','2950020785','24.7134.1858A','2970061000','24.7136.0155A','2980037000','24.7138.0155A','40.041.080','24.7146.0155A','40.041.081','40.171.173','40.041.082','24.7146.0952A','40.041.083','24.7146.4459A','7441500001','24.7168.0155A','7441500182','24.7168.1858A','40.041.209','24.7169.0155A','7441500914','24.7169.1858A','7441700001','24.7190.7060A','40.041.286','24.7193.0199A','40.041.297','24.7193.1858A','40.041.322','42.106.015','40.041.341','24.7194.1858A','7441700182','24.7195.1858A','7441700914','42.334.000','7543000000','42.357.104','22.144.091','42.357.252','22.291.091','42.357.286','22.296.091','42.357.493','40.042.080','42.357.805','40.042.081','42.359.286','40.042.082','42.361.173','40.042.083','42.361.273','22.327.091','42.361.481','22.337.091','42.361.804','40.042.209','42.361.810','22.364.091','42.647.173','22.415.091','42.647.252','40.042.286','42.647.493','40.042.297','42.647.805','40.042.322','43.205.534M','40.042.341','43.205.570M','2930561000','46.410.063','22.996.239','46.521.700','22.996.286','46.522.700','24.7110.0952A','46.550.000','24.7110.4459A','46.553.063','24.7111.0155A','46.557.000','24.7111.0952A','46.567.000','40.129.080','46.578.063','24.7111.1858A','52.027.000','24.7111.4459A','58.228.277','40.129.209','60.708.677','24.7114.0952A','60.709.677','24.7114.4459A','60.718.677','40.129.252','60.719.677','24.7115.0155A','64.804.182','24.7115.0952A','64.809.182','40.129.286','64.815.000','40.129.297','82.028.902','40.129.322','82.028.904','40.129.341','82.028.906','24.7115.1858A','82.028.909','24.7115.4459A','82.028.911','24.7117.0952A','82.028.926','24.7117.1858A','82.028.928','24.7120.0952A','82.028.931','24.7120.4459A','82.028.933','24.7121.0952A','82.028.935','24.7121.4459A','82.068.901','24.7122.0952A','82.068.903','24.7122.4459A','82.068.905','24.7123.0155A','82.068.907','24.7123.0952A','82.068.910','24.7123.1858A','82.068.912','24.7123.4459A','82.068.927','40.132.080','82.068.930','40.132.081','82.068.932','40.132.082','82.068.934','40.132.083','82.068.936','24.7124.0952A','D8174A916','40.132.209','F16174A948','24.7124.4459A','F16174A951','24.7125.0952A','F17174A951','40.132.286','F17174A955','40.132.297','F8174A948','40.132.322','F8174A951','40.132.341','24.7125.4459A')
select * from JDE_DB_Alan.vw_Mast m where m.FamilyGroup in ('910') and m.StockingType not in ('O','U')
select * from JDE_DB_Alan.Master_Vendor_Item_CrossRef a
select * from JDE_DB_Alan.FCPRO_MI_tmp a where a.ItemNumber in ('24.7221.0952')
select * from JDE_DB_Alan.FCPRO_MI_2_tmp a  where a.ItemNumber in ('40.260.805')


----xxxxxxxxxxxxxxxxx---  Inventory Reporting 10/11/2021  ---xxxxxxxxxxxxxxxxxxxxxxxxx------

select * from JDE_DB_Alan.Master_ML345			-- 49,607 records
select * from JDE_DB_Alan.vw_Mast a				--- 49,594 records
select * from JDE_DB_Alan.vw_OpenPO a			--- 4,094 records
--where a.QuantityOpen is null
where a.ItemNumber in ('42.210.031')


with t as 

	( select a.ItemNumber,a.StockingType,a.Pareto,isnull(a.QtyOnHand,0) as SOH_Qty,isnull(a.StockValue,0) as SOH_Val,a.StandardCost
		   ,isnull(c.PO_Qty,0) as PO_Qty,isnull(c.PO_Qty,0)*a.StandardCost as PO_Val 
		   ,isnull(a.QtyOnHand,0) + isnull(c.PO_Qty,0) as Item_Qty_GrandTTL
		   ,isnull(a.StockValue,0) + (isnull(c.PO_Qty,0)*a.StandardCost) as Item_Val_GrandTTL
		   ,a.FamilyGroup,a.Family_0,a.Description
	   from JDE_DB_Alan.vw_Mast a left join 
			 ( select b.ItemNumber,sum(b.QuantityOpen) as PO_Qty
				from JDE_DB_Alan.vw_OpenPO b
				--where b.ItemNumber in ('42.210.031')
				group by b.ItemNumber

						) c
			  on a.ItemNumber = c.ItemNumber
	 -- where a.ItemNumber in ('42.210.031')
           
		   )
		      
   select t.FamilyGroup,t.Family_0,t.Pareto,t.StockingType
          ,count(t.ItemNumber) as SKU_Count
          ,sum(t.SOH_Qty) as SOH_qty_,sum(t.SOH_Val) as SOH_Val_
		  ,sum(t.PO_Qty) as PO_Qty_,sum(PO_Val) as PO_Val_
		  ,sum(t.Item_Qty_GrandTTL) as Item_Qty_GrandTTL_,sum(t.Item_Val_GrandTTL) as Item_Val_GrandTTL_
		  ,GETDATE() as ReportDate
		  ,cast(SUBSTRING(REPLACE(CONVERT(char(10),DATEADD(mm, DATEDIFF(m,0,GETDATE()),0),126),'-',''),1,8) as integer) as Rpt_YYMMDD	      --- 1st day of each month,so actually by month
		  ,cast(SUBSTRING(REPLACE(CONVERT(char(10),DATEADD(mm, DATEDIFF(m,0,GETDATE()),0),126),'-',''),1,6) as integer) as Rpt_YYMM	
		  ,cast(SUBSTRING(REPLACE(CONVERT(char(10),DATEADD(mm, DATEDIFF(m,0,GETDATE()),0),126),'-',''),1,4) as integer) as Rpt_YY
		  ,cast(SUBSTRING(REPLACE(CONVERT(char(10),DATEADD(mm, DATEDIFF(m,0,GETDATE()),0),126),'-',''),4,2) as integer) as Rpt_MM
		  ,day(getdate()) as Rpt_DayofMth

   from t
   group by t.FamilyGroup,t.Family_0,t.Pareto,t.StockingType
   order by t.FamilyGroup desc,t.Pareto


  exec JDE_DB_Alan.sp_Cal_Inventory

--------------------------------------------------------------------------------

select * from JDE_DB_Alan.SlsHistoryHD



 ----------------- Update FC using temp table  25/2/2020 --------- works ! -------------------------

 SELECT Name
FROM sys.procedures
--WHERE OBJECT_DEFINITION(OBJECT_ID) LIKE '%TableNameOrWhatever%'
  WHERE OBJECT_DEFINITION(OBJECT_ID) LIKE '%Master_Vendor_Item_CrossRef%'

 SELECT Name
FROM sys.procedures
--WHERE OBJECT_DEFINITION(OBJECT_ID) LIKE '%TableNameOrWhatever%'
  WHERE OBJECT_DEFINITION(OBJECT_ID) LIKE '%CrossRef%'

select * from JDE_DB_Alan.MasterFamily m where m.code in ('653')

select * from JDE_DB_Alan.MasterFamily m where m.code like ('%653&')

select * from JDE_DB_Alan.FCPRO_Fcst_History h  where h.ItemNumber in ('38.001.005') and h.ReportDate between '2020-02-01' and '2020-02-25' 
select * from JDE_DB_Alan.FCPRO_Fcst_History h  where h.ItemNumber in ('6001130009010H') and h.ReportDate between '2020-02-01' and '2020-02-25' 

select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('38.001.005') and f.DataType1 = 'Adj_FC' 
select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('6001130009010H') and f.DataType1 = 'Adj_FC' 

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload a left join JDE_DB_Alan.vw_Mast m 
          on a.ItemNumber = m.ItemNumber 
where  m.FamilyGroup in ('965') and a.
--a. ('560') and a.cym > 202101 and a.CYM < 202104 

declare @fc table ( item varchar(100),datatype varchar(100),fcdate datetime,fcqty decimal(18,0))

select * from JDE_DB_Alan.vw_Mast m
--where m.Family in ('E23','E24')
--where m.ItemNumber in ('44.011.007')
where m.ItemNumber in ('43.212.001')
--where m.ItemNumber in ('26.800.963','26.800.820','26.800.971','26.800.830','26.800.659','26.800.676','26.801.963','26.801.820','26.802.963','26.802.820','26.802.971','26.802.830','26.802.659','26.802.676','26.803.963','26.803.820','26.803.971','26.803.830','26.803.659','26.803.676')

select * from JDE_DB_Alan.FCPRO_SafetyStock s 

select * from JDE_DB_Alan.vw_FC



select * from JDE_DB_Alan.vw_Mast m
select * from JDE_DB_Alan.Master_ML345 m

where m.Family in ('89K','89J','89S','89T') 
     
  and m.StockingType in ('P') order by m.ItemNumber
where m.ItemNumber like ('24.7207.%')




----- Creating temporary tables --> SQL Server provided two ways to create temporary tables via SELECT INTO and CREATE TABLE statements. --- https://www.sqlservertutorial.net/sql-server-basics/sql-server-temporary-tables/
--- Make sure that the table is deleted after use --- 25/2/2020

If(OBJECT_ID('tempdb..#temp') Is Not Null)
Begin
    Drop Table #Temp
End

If(OBJECT_ID('tempdb..#fc') Is Not Null)
Begin
    Drop Table #fc
End


drop table #fc
select * from #fc
select f.ItemNumber,f.DataType1,f.Date,f.Value  into #fc  from JDE_DB_Alan.FCPRO_Fcst f where 1=2 

insert into #fc values
('38.001.005','Adj_FC','2020/02/01',500 ), 
('38.001.005','Adj_FC','2020/03/01',811 ),
('38.001.005','Adj_FC','2020/04/01',1004),
('38.001.005','Adj_FC','2020/05/01',1123),
('38.001.005','Adj_FC','2020/06/01',1198),
('38.001.005','Adj_FC','2020/07/01',1244),
('38.001.005','Adj_FC','2020/08/01',1273),
('38.001.005','Adj_FC','2020/09/01',1291),
('38.001.005','Adj_FC','2020/10/01',1302),
('38.001.005','Adj_FC','2020/11/01',1308),
('38.001.005','Adj_FC','2020/12/01',1313),
('38.001.005','Adj_FC','2021/01/01',1315),
('38.001.005','Adj_FC','2021/02/01',500 ),
('38.001.005','Adj_FC','2021/03/01',811 ),
('38.001.005','Adj_FC','2021/04/01',1004),
('38.001.005','Adj_FC','2021/05/01',1123),
('38.001.005','Adj_FC','2021/06/01',1198),
('38.001.005','Adj_FC','2021/07/01',1244),
('38.001.005','Adj_FC','2021/08/01',1273),
('38.001.005','Adj_FC','2021/09/01',1291),
('38.001.005','Adj_FC','2021/10/01',1302),
('38.001.005','Adj_FC','2021/11/01',1308),
('38.001.005','Adj_FC','2021/12/01',1313),
('38.001.005','Adj_FC','2022/01/01',1315)

  --- update 'Adj_FC' --- fc table
;update f
 set f.value = f2.value
  from JDE_DB_Alan.FCPRO_Fcst f inner join #fc f2 on f.ItemNumber = f2.ItemNumber  and f.Date = f2.Date and f.DataType1 = f2.DataType1     ---N0 Need ? Need !                                                                                
     where f.ItemNumber = '38.001.005' and f.DataType1 ='Adj_FC'


  --- update 'Stat_FC' --- fc table
  	  
;update f
 set f.value = f2.value
  from JDE_DB_Alan.FCPRO_Fcst f inner join 
							 ( select * from JDE_DB_Alan.FCPRO_Fcst ff where ff.DataType1 = 'Adj_FC') f2 
							               on f.ItemNumber = f2.ItemNumber  and f.Date = f2.Date												 ---N0 Need ? Need !                                                                                
  where f.ItemNumber = '38.001.005' and f.DataType1 ='Stat_FC' and f.Date = '2020-04-01'


  ------==============================================================================================
    ----- Update fc using higer value either of stat or April updated fc value for Salman 120 SKUs for Fabric awning ---- 25/7/2022
 ;update a
 set a.value =  (case
					when a.Value > c.Val_histy then a.Value 
					when a.Value <= c.Val_histy then c.val_histy *0.8
					end  )
--select *
--update a set a.value = 40
from  JDE_DB_Alan.FCPRO_Fcst a left join  
			(select b.ItemNumber,b.Value as Val_histy,b.Date as fc_dt_histy,b.ReportDate as fc_histy_rpt_dt from JDE_DB_Alan.FCPRO_Fcst_History b 
			  where b.ReportDate between '2022-06-01' and '2022-06-30 18:00:00') c			
			on a.ItemNumber = c.ItemNumber and a.Date = c.fc_dt_histy
where   a.ItemNumber in ('7494500182')
       --a.ItemNumber in ('7478700001','7479500182','7479700182','7370350182')
		--a.ItemNumber in ('42.652.000','46.421.000','46.508.500','46.508.700','46.531.500','46.531.700','7137040000','7370250182','7370250914','7370300182','7370300914','7370350182','7370350914','7370400001','7370400182','7370400914','7441500001B','7441500182B','7441500914B','7441700001B','7441700182B','7441700914B','7442700000','7442700001','7442700182','7442700914','7456500182','7457500001','7457500182','7457500914','7460500000','7460700000','7467040100','7467070100','7468500001','7468500182','7468500914','7468700000','7468700001','7468700182','7468700914','7477500001','7477500182','7477500914','7477700000','7477700001','7477700182','7477700914','7478500001','7478500182','7478500914','7478700000','7478700001','7478700182','7478700914','7479500001','7479500182','7479500914','7479700000','7479700001','7479700182','7479700914','7485700000','7488500001','7488500182','7488500914','7488700000','7488700001','7488700182','7488700914','7489500001','7489500182','7489500914','7489700000','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700000','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700000','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700000','7494700001','7494700182','7494700914','7496500001','7496500182','7496500914','7496700001','7496700182','7496700914','7497700000','7497700001','7497700182','7497700914','7498700000','7498700001','7498700182','7498700914','7499700000','7499700001','7499700182','7499700914','7766050000','7766070000','7766250000','7766270000')
		and a.DataType1 in ('Adj_FC')
		and a.Date between '2022-07-01' and '2023-06-30'
		--and a.Date = '2023-03-01'
		--order by a.ItemNumber


----- need to update History table ---		
 ;update c
 set c.Val_histy = a.Value
--select *
from   ( select b.ItemNumber,b.Value as Val_histy,b.Date as fc_dt_histy,b.ReportDate as fc_histy_rpt_dt from JDE_DB_Alan.FCPRO_Fcst_History b 
			  where b.ReportDate between '2022-07-01' and '2022-07-30 18:00:00'	and b.Date between '2022-07-01' and '2023-06-30'	
			     -- and b.ItemNumber in ('7494500182')		 
			  ) c	
		 left join ( select * from JDE_DB_Alan.FCPRO_Fcst d where d.DataType1 in ('Adj_FC') and d.Date between '2022-07-01' and '2023-06-30' ) a
		 on c.ItemNumber = a.ItemNumber and c.fc_dt_histy = a.date
where   --c.ItemNumber in ('7468700914')
       --c.ItemNumber in ('7478700001','7479500182','7479700182','7370350182')
	    c.ItemNumber in ('42.652.000','46.421.000','46.508.500','46.508.700','46.531.500','46.531.700','7137040000','7370250182','7370250914','7370300182','7370300914','7370350182','7370350914','7370400001','7370400182','7370400914','7441500001B','7441500182B','7441500914B','7441700001B','7441700182B','7441700914B','7442700000','7442700001','7442700182','7442700914','7456500182','7457500001','7457500182','7457500914','7460500000','7460700000','7467040100','7467070100','7468500001','7468500182','7468500914','7468700000','7468700001','7468700182','7468700914','7477500001','7477500182','7477500914','7477700000','7477700001','7477700182','7477700914','7478500001','7478500182','7478500914','7478700000','7478700001','7478700182','7478700914','7479500001','7479500182','7479500914','7479700000','7479700001','7479700182','7479700914','7485700000','7488500001','7488500182','7488500914','7488700000','7488700001','7488700182','7488700914','7489500001','7489500182','7489500914','7489700000','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700000','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700000','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700000','7494700001','7494700182','7494700914','7496500001','7496500182','7496500914','7496700001','7496700182','7496700914','7497700000','7497700001','7497700182','7497700914','7498700000','7498700001','7498700182','7498700914','7499700000','7499700001','7499700182','7499700914','7766050000','7766070000','7766250000','7766270000')

		--order by a.ItemNumber

------==============================================================================================


  --- update 'Adj_FC' --- fc history table -- works !
;update h
 set h.value = f2.value
  from JDE_DB_Alan.FCPRO_Fcst_History h inner join #fc f2 on h.ItemNumber = f2.ItemNumber  and h.Date = f2.Date and h.DataType1 = f2.DataType1     ---N0 Need ? Need !                                                                                
     where h.ItemNumber = '38.001.005' and h.DataType1 ='Adj_FC' and h.ReportDate between '2020-02-01' and '2020-02-25' 

;update f
 set f.value = 33
  from JDE_DB_Alan.FCPRO_Fcst f                                                                              
     where f.ItemNumber = '6001130009010H' and f.DataType1 ='Stat_FC' and f.ReportDate between '2020-02-01' and '2020-02-25' 


	;update h
	 set h.SalesQty_Adj = 11000
	  from  JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h                                                                               
		 where h.ItemNumber = '26.812.820' and h.CYM in ('202204')   


------- 11/1/2021 -------------

select * from JDE_DB_Alan.HD_WorkCenter a
select * from JDE_DB_Alan.HD_WorkCenter_Staging a

select distinct a.ItemNumber,a.ShortItemNumber,a.WorkCenterGroupName_f,b.Description,b.FamilyGroup_ from JDE_DB_Alan.HD_WorkCenter a left join JDE_DB_Alan.vw_Mast b on a.ItemNumber = b.ItemNumber where a.WC_Count >1

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload d where d.ItemNumber in ('42.210.031')
select * from JDE_DB_Alan.vw_Sls_History_HD h where h.ItemNumber_ in ('42.210.031')
select max(h.SlsMth_latest) as LatestMonth from JDE_DB_Alan.vw_Sls_History_HD h
select cast(SUBSTRING(REPLACE(CONVERT(char(10),DATEADD(mm, DATEDIFF(m,0,GETDATE())-1,0),126),'-',''),1,6) as integer)
select cast(SUBSTRING(REPLACE(CONVERT(char(10),getdate(),126),'-',''),1,6) as integer)

select cast(SUBSTRING(REPLACE(CONVERT(char(10),DATEADD(mm, DATEDIFF(m,0,GETDATE())-1,0),126),'-',''),1,6) as integer) - max(h.SlsMth_latest) as LatestMonth from JDE_DB_Alan.vw_Sls_History_HD h

select cast(SUBSTRING(REPLACE(CONVERT(char(10),DATEADD(mm, DATEDIFF(m,0,GETDATE()),0),126),'-',''),1,6) as integer) - max(h.SlsMth_latest) as LatestMonth from JDE_DB_Alan.vw_Sls_History_HD h

-------- 03/03/2020 ------------

--SELECT distinct h.ItemNumber
select * 
  FROM [JDE_DB_Alan].[JDE_DB_Alan].[SlsHistoryHD] h
  where h.ItemNumber in ('1444004701','1444004528','1444004707','1444004721','1444004503','1444004708','1444004806','1444004853','1444004859','1444004722')


select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in 
('1444004701','1444004528','1444004707','1444004721','1444004503','1444004708','1444004806','1444004853','1444004859','1444004722')


select * from JDE_DB_Alan.FCPRO_NP_tmp p where p.ItemNumber in ('38.013.001')

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('26.812.410','26.812.901','26.812.604','26.812.820','26.812.902','26.812.962','26.815.410','26.815.901','26.815.604','26.815.820','26.815.902','26.815.962','26.814.410','26.814.901','26.814.604','26.814.820','26.814.902','26.814.962')

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('25.078.1858','25.078.0155','25.078.0952','25.120.1858','25.120.0155','25.120.0952','25.124.0155','25.124.0952')
select * from JDE_DB_Alan.FCPRO_NP_tmp a where a.ItemNumber in ('25.312.432')
select * from JDE_DB_Alan.MasterFamily a where a.code like ('70%')



select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in  ('18.010.035','18.010.036','18.607.016','18.615.007','24.5418.0000','24.7102.7052A','24.7120.0952','24.7121.0952','24.7122.0952','24.7124.0952','24.7127.0952','24.7200.0001','24.7220.0952','24.7334.0952','32.379.200','32.380.002','32.455.155','32.501.000','43.525.105','82.696.931')
select * from JDE_DB_Alan.Master_ML345
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in  ('52.020.737')

select * from JDE_DB_Alan.OpenPO
select * from JDE_DB_Alan.FCPRO_Fcst f


select * from JDE_DB_Alan.vw_Mast_Planning a where a.Item_Number in ('52.016.810','52.020.737')
select * from JDE_DB_Alan.vw_Mast_Planning a where a.Family in ('635')


exec JDE_DB_Alan.sp_FCPro_ROP_Analysis '7456500182','2021-04-01','2022-03-01'


select distinct m.FamilyGroup from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('0751031000202H','0751031000202HCL','0751031000207H','0751031000207HCL','0751031003001H','0751031003001HCL','0751031003030H','0751031003030HCL','0751031003061H','0751031003061HCL','0770531003531H','0770531003531HCL','0770531003532H','0770531003532HCL','0770531003535H','0770531003535HCL','0850520000202H','0850520000202HCL','0850520000221H','0850520000221HCL','0850520003001H','0850520003001HCL','0850520003010HCL','0850520003030','0850520003030CL','0850520003030HCL','0850525000202','0850525000202H','0850525000202HCL','0850525000207H','0850525000207HCL','0850525000220H','0850525000220HCL','0850525000221H','0850525000221HCL','0850525000222H','0850525000222HCL','0850525000707H','0850525000707HCL','0850525000710HCL','0850525000720H','0850525000720HCL','0850525002022H','0850525002022HCL','0850525003001H','0850525003001HCL','0850525003010H','0850525003010HCL','0850525003020H','0850525003020HCL','0850525003021H','0850525003021HCL','0850525003030','0850525003030H','0850525003030HCL','0850525003061H','0850525003061HCL','085052500M178H','085052500M178HCL','0850531000202H','0850531000202HCL','0850531000207H','0850531000207HCL','0850531000220H','0850531000220HCL','0850531000221H','0850531000221HCL','0850531000222H','0850531000222HCL','0850531000707H','0850531000707HCL','0850531000710H','0850531000710HCL','0850531000720H','0850531000720HCL','0850531002022H','0850531002022HCL','0850531003001H','0850531003001HCL','0850531003010H','0850531003010HCL','0850531003020H','0850531003020HCL','0850531003021H','0850531003021HCL','0850531003030H','0850531003030HCL','0850531003061H','0850531003061HCL','085053100M178H','085053100M178HCL','085552500D064','085552500D064CL','085552500D088','085552500D088CL','085552500D137','085552500D137CL','085552500D212','085552500D212CL','085552500D249','085552500D249CL','085552500D337','085552500D337CL','22.747.091','43.205.532M','43.205.532MCL','43.205.534','43.205.534CL','43.205.534M','43.205.534MCL','43.205.535M','43.205.535MCL','43.205.536M','43.205.536MCL','43.205.537M','43.205.537MCL','43.205.563M','43.205.563MCL','43.205.565CL','43.205.568M','43.205.568MCL','43.205.569M','43.205.569MCL','43.205.570MCL','43.205.571','43.205.574M','43.205.574MCL','43.205.582M','43.205.582MCL','43.205.583MCL','43.205.584M','43.205.584MCL','43.205.635M','43.205.635MCL','43.205.637M','43.205.637MCL','43.205.663M','43.205.663MCL','43.207.532M','43.207.532MCL','43.207.535M','43.207.535MCL','43.207.536M','43.207.536MCL','43.207.537M','43.207.537MCL','43.207.565M','43.207.565MCL','43.207.582M','43.207.582MCL','43.207.584M','43.207.584MCL','43.207.635M','43.207.635MCL','43.207.637M','43.207.637MCL','43.211.001','43.211.001CL','43.211.002','43.211.002CL','43.211.003','43.211.003CL','43.211.004','43.211.004CL','43.211.005','43.211.005CL','43.211.006','43.211.006CL','43.212.001','43.212.002','43.212.002CL','43.212.003','43.212.003CL','43.212.004','43.212.004CL','43.213.001','43.213.003','43.214.001','43.214.002','43.215.001','43.215.002','43.295.530','43.295.530CL','43.295.532','43.295.532CL','43.295.535','43.295.535CL','43.295.536','43.295.536CL','43.295.537','43.295.537CL','43.471.535','43.477.536','43.477.537','43.477.540','43.479.532','43.525.102','43.525.102CL','43.530.101','43.530.102','43.530.105','43.530.107','43.530.403','43.530.403CL','S3000NET5250N001','S3000NET5250N001CL','S3000NET5250N002','S3000NET5250N002CL','S3000NET5250N003','S3000NET5250N003CL','S3000NET5250N010','S3000NET5250N010CL','S3000NET5250N012','S3000NET5250N012CL','S3000NET5250N025','S3000NET5250N025CL','S3000NET5250N071','S3000NET5250N201','S3000NET5250N201CL','S3000NET5250N301','S3000NET5250N301CL','S3000NET5250N901','S3000NET5250N901CL','S3000NET5250N903','S3000NET5250N903CL','S3000NET5250N904','S3000NET5250N904CL','S3000NET5300N001','S3000NET5300N001CL','S3000NET5300N002','S3000NET5300N002CL','S3000NET5300N003','S3000NET5300N003CL','S3000NET5300N010','S3000NET5300N010CL','S3000NET5300N012','S3000NET5300N012CL','S3000NET5300N025','S3000NET5300N025CL','S3000NET5300N071','S3000NET5300N071CL','S3000NET5300N0AL','S3000NET5300N0ALCL','S3000NET5300N0PW','S3000NET5300N0PWCL','S3000NET5300N0SS','S3000NET5300N0SSCL','S3000NET5300N201','S3000NET5300N201CL','S3000NET5300N301','S3000NET5300N301CL','S3000NET5300N901','S3000NET5300N901CL','S3000NET5300N902','S3000NET5300N902CL','S3000NET5300N903','S3000NET5300N903CL','S3000NET5300N904','S3000NET5300N904CL','S3000NET5300NAMB','S3000NET5300NAMBCL','S3000NET5300NMMS','S3000NET5300NMMSCL','S3000NET5300NMTS','S3000NET5300NMTSCL','S3000NET5300NPMB','S3000NET5300NPMBCL','S3000NET5300NSAP','S3000NET5300NSAPCL','S3000NET5300NWWP','S3000NET5300NWWPCL','S3000RR3250RR10','S3000RR3250RR10CL','S3000RR3250RR12','S3000RR3250RR12CL','S3000RR3250RR13','S3000RR3250RR13CL','S3000RR3250RR23','S3000RR3250RR23CL','S3000RR3250RR28','S3000RR3250RR28CL','S3000RR3250RR44','S3000RR3250RR44CL','S3000RR3250RR46','S3000RR3250RR46CL','S3000RR3250RR71','S3000RR3250RR71CL','S3000RR3250RR72','S3000RR3250RR72CL','S3000RR3250RR84','S3000RR3250RR84CL','S3000RR3250RR90','S3000RR3250RR90CL','S3000RR3250RR94','S3000RR3250RR94CL','S3000RR3250RR98','S3000RR3250RR98CL','S3000RR3250RRE3','S3000RR3250RRE3CL','S3000RR3250RRE4','S3000RR3250RRE4CL','S3000RR3300RR10','S3000RR3300RR10CL','S3000RR3300RR12','S3000RR3300RR12CL','S3000RR3300RR71','S3000RR3300RR71CL','S3000RR3300RR72','S3000RR3300RR72CL','S3000RR3300RR84','S3000RR3300RR84CL','S3000RR3300RR90','S3000RR3300RR90CL','S3000RR3300RR94','S3000RR3300RR94CL','S3000RR3300RRE4','S3000RR3300RRE4CL','SSDLS5300ATSCL','SSDLS5300MMB','SSDLS5300PS','SSDLS5300PSCL','SSDLS5300SDCL','SSDLS5300SMBCL')

select distinct f.DataType1 from JDE_DB_Alan.vw_FC f
select f.ItemNumber,f.DataType1,f.FCDate_,f.fcyr,f.fcmth,f.fcdte,f.FC_Vol from JDE_DB_Alan.vw_FC f 
where f.ItemNumber in ('42.210.031','1019884')


select * from JDE_DB_Alan.vw_FC 


-------- 04/03/2020 ------------
select * from JDE_DB_Alan.OpenPO p where p.ItemNumber in ('24.7209.1858')




-------- 06/03/2020 ------------
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('7236120001','7236127035','7236120049','42.210.031')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('7236120001','7236127035','7236120049','42.210.031')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('2780135000B')

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('82336.3000.00.20')

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber like ('82336%')


-------- 12/03/2020 ------------
select * from JDE_DB_Alan.vw_Mast m where m.FamilyGroup in ('989') and m.StockingType not in ('O','U')
select * from JDE_DB_Alan.Master_ML345 m


select * from JDE_DB_Alan.TextileWC 
-------- 17/03/2020 ------------
select m.ItemNumber,m.PlannerNumber,m.Owner_,m.SupplierName,m.SupplierName

select distinct m.SupplierName,m.PrimarySupplier
from JDE_DB_Alan.vw_Mast m
where m.PrimarySupplier in ('2829284')
--where m.PlannerNumber = '20072'
order by m.SupplierName

where m.SupplierName like ('pan%')
where m.ItemNumber in ('18.010.035','18.010.036','18.607.016','18.615.007','24.5398.0000','24.7120.0155','24.7121.0155','24.7122.0155','24.7125.0155','24.7127.0155','24.7146.0155A','24.7163.0000A','24.7168.0155A','24.7169.0155A','24.7200.0001','24.7207.0199','24.7208.0199','24.7209.0199','24.7219.4459','24.7240.0199','24.7257.0952','24.7333.0199','24.7362.1858','32.340.000','32.379.200','32.455.155','32.501.000','82.691.909')

-------- 30/03/2020 -- 14/2020------------
select m.*,m.ItemNumber,m.PlannerNumber,m.Owner_
from JDE_DB_Alan.vw_Mast m
where  m.ItemNumber in ('43.477.532')
	  --m.ItemNumber like ('44.015.404')
      -- m.ItemNumber like ('42.%') and m.FamilyGroup in ('989')

select *
from JDE_DB_Alan.FCPRO_Fcst_History h 
where h.ReportDate between '2019-03-02' and '2020-03-25 17:00:00'

select *
from JDE_DB_Alan.vw_Mast m
 where m.ItemNumber in ('24.7220.0199','32.501.000','18.010.035','18.615.007','18.010.036','43.212.001','32.379.200','32.380.002','18.013.089','24.7200.0001','24.7206.0000','24.7100.0199','24.7100.0199','32.455.155','24.7110.0155','24.7121.0155','24.7122.0155','24.7124.0155','24.7127.0155','24.5353.0204','24.7120.0155')
 --where m.ItemNumber like ('44.010.007')
--where m.FamilyGroup in ('964') and m.StockingType not in ('O','U')



---------- FC for Duette/Silhouette ----------- 14/5/2021

select m.FamilyGroup_,f.DataType1,f.FCDate2_,sum(f.FC_Vol) as Fcvol
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.FamilyGroup in ('973','979')     
group by m.FamilyGroup_,f.DataType1,f.FCDate2_


select m.FamilyGroup_,f.DataType1,f.myDate2,sum(f.FC_Vol) as Fcvol
from JDE_DB_Alan.vw_FC_Hist f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.FamilyGroup in ('973','979')     
      and f.ReportDate > ('2021-04-01') and f.ReportDate < ('2021-05-01')
group by m.FamilyGroup_,f.DataType1,f.myDate2



select distinct a.DataType1 from JDE_DB_Alan.FCPRO_Fcst a
select distinct a.DataType1 from JDE_DB_Alan.FCPRO_Fcst_History a

select distinct f.ItemNumber
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.FamilyGroup in ('979')


select * from JDE_DB_Alan.vw_Mast m
where m.ItemNumber in ('4600289661')
where m.Description like ('%tia')						------- 4600289661 4.9m bottom rail in Silhouette 979 category
        and m.familygroup in ('979')



   --- Forecast for Fabric Awning 965 ------- 14/5/2021

select m.FamilyGroup_,f.DataType1,f.FCDate2_,sum(f.FC_Vol) as Fcvol
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.FamilyGroup in ('965')     
group by m.FamilyGroup_,f.DataType1,f.FCDate2_

select distinct f.ItemNumber
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.FamilyGroup in ('965')     


-----------------------------------------------------------------------------------------------------

select *
from JDE_DB_Alan.vw_Mast m
where m.ItemNumber in ('6000130009004H','82.601.901')
--where m.ItemNumber in ('24.7121.0155','24.7122.1858')

select m.ItemNumber,m.StockingType,m.FamilyGroup,m.Family_0,m.FamilyGroup_,m.Family,m.Description
from JDE_DB_Alan.vw_Mast m
where m.ItemNumber in ('587002','42.198.000','585020','42.421.855','46.598.000','594001','591010','42.327.215','588002','510511','52.003.032','42.206.031','580011','44.011.007','42.151.855','42.187.855','52.002.000','46.610.000','42.328.000','588001','40.367.173','42.218.031','52.018.000','46.019.000','42.357.252','44.011.003','44.016.404','18.013.090','42.056.000','44.011.004','46.599.000','596555','52.012.000','510144','44.016.408','44.132.000','82.401.024','52.004.000','44.011.006','46.002.000','42.220.031','42.512.000','591050','46.306.000','42.613.886','52.001.134','46.508.500','44.010.007','46.612.700','52.013.000','44.015.404','42.211.031','42.210.031','44.016.405','44.012.007','42.057.000','42.212.031','42.357.131','45.032.063','596547','46.011.000','42.357.481','46.506.000','42.357.804','46.005.000','46.019.063','42.357.493','52.010.032','44.016.808','52.005.000','46.612.500','42.607.032','52.016.000','46.524.000','46.011.134','42.157.031','44.011.002','46.012.000','44.017.405','46.607.000','42.184.049','46.606.000','52.020.000','44.011.005','52.000.063','52.015.000','42.236.000','46.607.134','82.401.015','46.606.134','52.008.000','52.021.000','82.401.022','42.601.886','596557','46.203.000','591012','42.209.031','46.611.000','46.521.700','46.609.000','42.357.286','46.507.000','44.010.004','42.334.000','7156010000','46.002.063','46.419.000','44.012.004','82.401.012','42.077.032','52.014.000','46.108.063','46.505.000','44.015.405','46.011.850','44.012.003','46.021.000','46.005.850','42.213.031','46.517.000','44.011.001','46.005.134','52.016.100','46.011.100','46.012.850','46.615.063','42.230.000','46.606.850','45.624.000','46.607.850','46.502.837','45.658.000','46.500.000','42.320.493','46.012.134','42.614.063','46.607.100','52.008.100','46.607.810','46.606.100','52.011.030S','42.180.049','52.020.100','52.021.100','52.016.134','46.614.700','42.323.031','46.606.810','42.320.850','46.608.000','52.007.063','44.016.107','46.005.100','52.027.000','46.504.000','52.006.000','52.029.010','46.011.810','82.401.013','42.206.063','44.010.006','46.602.134','82.401.004','46.421.000','596554','52.009.000','52.015.100','52.014.100','52.030.000','44.012.008','52.021.134','42.645.002','42.505.000','52.020.134','42.506.030','46.005.810','42.064.000','42.058.000','46.607.734','52.008.134','46.606.734','46.012.810','52.001.850','42.320.481','52.004.000V','52.022.000','510003','82.401.023','52.015.134','46.422.030','46.012.100','82.401.001','46.423.100','42.357.273','44.016.505','42.357.810','42.357.805','46.530.063','46.011.734','82.401.002','44.004.103','46.614.500','52.014.134','46.004.134','46.602.000','46.004.000','40.340.173','42.320.252','18.616.003','44.003.104K','42.320.804','46.608.134','594003','82.296.943','82.401.019','510002','44.005.104K','46.603.134','44.010.003','46.602.100','46.603.000','44.005.102K','42.062.000','82.401.016','34.249.000','46.502.100','52.016.810','709847','34.097.000','18.099.032','46.513.000','42.060.000','46.606.737','52.008.810','52.021.850','82.401.008','46.518.063','46.607.737','46.005.734','82.296.972','6610260000','52.021.810','46.601.000','42.501.855','82.401.017','52.020.850','46.600.000','46.012.734','82.401.009','46.013.000','52.020.810','18.696.031','46.602.810','46.502.122','46.004.100','44.004.114K','46.011.737','40.371.173','52.017.000','46.608.850','42.357.104','44.010.001','52.016.850','46.608.100','46.005.737','46.602.734','42.361.493','46.004.810','52.014.850','52.015.810','34.260.000','44.004.104K','34.096.000','52.014.737','46.514.000','82.401.020','42.632.855','46.608.810','46.603.100','52.022.100','34.020.000','42.655.000','45.623.000','52.008.734','46.012.737','46.603.810','52.016.734','44.003.114K','42.631.855','44.003.113K','52.014.810','82.296.965','42.361.173','44.010.005','510190','510182','42.214.031','52.015.734','46.419.100','52.021.734','42.649.850','42.157.063','82.296.953','6610200000','34.216.000','52.020.734','82.401.003','52.015.850','44.010.002','42.333.000','46.608.734','34.230.000','52.016.737','42.651.000','46.004.734','82.296.986','52.020.737','52.021.737','42.361.481','52.017.134','42.630.493','42.320.810','6610300000','52.008.737','46.550.000','46.016.000','44.005.102','7761030001','42.063.000','82.296.973','46.602.737','45.305.000','42.623.031','42.211.063','46.013.100','42.630.252','42.361.804','594011','46.013.850','46.608.737','46.603.734','46.004.737','42.361.252','46.013.134','52.022.134','42.320.273','42.068.000','40.379.000','52.008.850','42.113.032','46.420.000','52.015.737','82.296.925','42.611.886','46.601.100','82.296.918','82.296.947','46.600.100','42.221.031','52.014.734','42.054.000','46.521.500','42.630.173','46.512.000','42.320.805','82.296.996','42.320.104','46.603.737','42.630.481','34.231.000','82.296.970','82.296.939','42.630.804','82.296.913','7156130000','46.013.810','510140','46.601.810','82.297.949','42.212.063','42.196.031','42.466.030','82.296.909','7441500182','82.296.905','82.296.950','591024','82.297.957','82.296.969','82.296.944','42.610.855','510139','52.022.850','42.222.031','42.157.030','82.296.906','7460700000','46.013.737','44.003.114','42.622.000','52.022.810','82.296.957','82.296.907','46.604.000','42.647.493','82.296.936','42.647.173','42.194.031','42.215.031','46.510.000','46.013.734','42.152.850','46.515.000','82.296.946','45.682.100','52.032.030','46.423.850','42.647.804','45.678.100','52.031.030','82.401.018','46.604.134','42.630.185','52.017.100','45.679.100','34.095.000','585021','82.296.933','46.604.100','42.209.063','42.361.810','82.296.956','42.502.000','42.630.810','34.259.000','34.258.000','46.553.063','42.647.481','45.680.100','82.401.006','45.223.100','42.630.104','34.240.000','52.022.734','45.677.100','45.683.100','42.213.063','42.503.000','45.681.100','42.647.252','34.506.000','82.296.934','510181','46.600.810','45.071.063','42.361.273','42.647.104','46.604.737','705266','82.296.951','82.296.932','42.361.805','7493700914','7478700914','46.414.000','82.401.007','82.296.948','6610340000','6611550000','42.062.173','7479500001','52.022.737','46.604.734','82.297.950','510005','42.055.000','82.296.922','82.296.940','7127930001','42.647.810','44.133.120','42.361.104','46.423.134','46.604.810','46.601.734','46.601.737','45.143.000','82.296.931','510161','46.425.100','590022','82.297.952','45.522.000','510160','7122930182','46.600.734','45.221.100','82.297.948','7457500182','46.600.737','45.057.063','45.403.100','82.297.956','42.065.000','82.296.952','42.180.131','7127910001','44.004.113K','46.020.000','46.205.000','7233020000','42.223.031','46.025.000','7390060182','46.516.000','52.034.000','46.553.030','7127990182','82.296.949','7232127035','7127860182','45.506.000','46.424.100','510705','45.632.000','34.224.000','7127890001','7232147035','52.017.810','7495500001','7153080914','46.020.100','7491500182','7122570182','45.645.100','7126070001','42.611.000','7390400914','7126070914','7127890914','7127910914','42.647.185','7127990001','7495500914','7468500182','82.296.935','42.647.805','45.517.000','510101','7468500914','510709','34.239.000','7394350914','45.625.820','45.288.100','45.402.100','7236010182','7468700182','7394350001','7495700914','45.254.100','7151040914','510074','510070','510145','34.201.000','7495500182','7326080000','42.066.000','510706','7468700914','7127850182','34.246.000','510151','7123080182','45.132.100','45.642.100','45.646.000','45.659.000','510071','7127940914','7390400001','7468500001','510075','45.656.100','42.067.000','7127940001','7127890182','7493700001','7326020000','46.561.000','45.122.100','45.283.000','45.273.100','46.560.000','7370400914','7370350001','7370250001','7491700914','34.237.000','7390300001','7370200182','510072','7326030000','7127620182','45.123.100','45.127.000','45.148.100','7350200001','45.115.000','7390030001','7127710914','7350150001','7152070182','709838','7122720182','7390030182','7232187035','510073','7122910049','45.120.100','45.136.000','45.298.100','45.121.000','45.312.100','45.404.100','45.118.000','7326010000','7390030914','7151030914','45.117.100','45.252.100','45.126.100','45.129.100','45.670.820','45.311.100','82.296.910','7151030001','7390200182','7127660182','7127710182','42.359.286','7122720049','7127710001','34.241.000','7151040001','7122950914','7350200914','7742140001','45.312.000','45.401.100','45.127.100','45.146.000','45.138.100','45.665.063','52.017.734','45.618.100','7127910182','45.103.100','7476500182','7151030182','7390400182','7495700001','7122930049','7370300182','6610520000')

select m.ItemNumber,m.StockingType,m.FamilyGroup,m.Family_0,m.FamilyGroup_,m.Family,m.Description
from JDE_DB_Alan.vw_Mast m
where m.Family in ('89J','89K','89L')
order by m.Family



select * from JDE_DB_Alan.TextileFC f
--where f.ArticleNumber in ('RLAA132A118F')
where f.Reportdate > '2020-10-19'
order by f.Reportdate desc

select dateadd(s,-1,dateadd(d, datediff(d,0, getdate()), 0) )

-------- 4/4/2020  -----------------




select * 
from JDE_DB_Alan.FCPRO_MI_2_Raw_Data_tmp mi2
where mi2.ItemID in ('40.153.131')


select distinct f.ItemNumber from JDE_DB_Alan.FCPRO_Fcst f 
where f.DataType1 in ('Adj_FC')

select * from JDE_DB_Alan.FCPRO_Fcst f 
where f.ItemNumber in ('40.381.000','42.210.031') and f.DataType1 in ('Adj_FC')



---- Nordic range ----- 14/7/2020

--select f.*,m.StockingType,m.PlannerNumber
select f.ItemNumber,avg(f.Value) as fc_avg
from JDE_DB_Alan.FCPRO_Fcst f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where f.ItemNumber in
('24.7121.0155','24.7100.0199','24.7002.0001T','32.380.002','32.379.200','24.7120.0155','24.7127.0155','24.7124.0155','24.7220.0952','32.455.155','24.7122.0155','24.7218.0199','24.7201.0000T','24.7121.1858','24.5417.0000','24.7100.1858','24.7120.1858','24.7128.0155A','24.7218.1858','24.7002.0001','24.7110.0155','24.7127.1858','24.7220.0199','24.5415.0000','24.7102.0199','24.7122.1858','24.7200.0000T','32.455.855','24.5416.0000','24.5414.0000','24.5427.0204','32.380.855','24.7206.0000','24.5349.0204','24.5413.0000','24.5353.0204','82.633.902','82.633.901')
--('7122720049','7123050049','7123060049','7127140914','7127180914','7127510914','7129200914','7134210914','7134220001','7134220182','7134220914','7134230001','7134230182','7134230914','7152070914','7152090914','7370200001','7370200182','7370200914','7370250001','7370250182','7370250914','7370300001','7370300182','7370300914','7370350001','7370350182','7370350914','7370400001','7370400182','7370400914','7475500914','7476500914','7477500914','7477700914','7478500914','7478700914','7479500914','7479700914','42.653.000','42.652.000','42.654.000','42.655.000','42.655.850','6610200000','6610220000','6610260000','6610300000','6610340000','6610350000','6610420000','6610480000','6610490000','6610520000','6610580000','6610660000','6610690000','6610930000','6610940000','6611000000','6611060000','6611080000','6611500000','6611510000','6611530000','6611550000','6658500000','7122570001','7122570049','7122570182','7122630001','7122630049','7122630182','7122640001','7122640049','7122640182','7122720001','7122720182','7122900001','7122900049','7122900182','7122910001','7122910049','7122910182','7122920001','7122920049','7122920182','7122930001','7122930049','7122930182','7122950001','7122950182','7122950914','7122960000','7123050001','7123050182','7123051901','7123060001','7123060182','7123061901','7123070001','7123070049','7123070182','7123080001','7123080182','7123080914','7124010001','7124010049','7124010182','7124100001','7124100049','7124100182','7124130001','7124130049','7124130182','7124170001','7124170049','7124170182','7126070001','7126070182','7126070914','7127140001','7127140182','7127150001','7127150182','7127150914','7127180001','7127180182','7127190000','7127500000','7127510001','7127510182','7127600001','7127600182','7127600914','7127620001','7127620182','7127620914','7127650001','7127650182','7127650914','7127660001','7127660182','7127660914','7127690001','7127690182','7127690914','7127710001','7127710182','7127710914','7127800001','7127800182','7127800914','7127850001','7127850182','7127850914','7127860001','7127860182','7127860914','7127890001','7127890182','7127890914','7127900001','7127900182','7127900914','7127910001','7127910182','7127910914','7127930001','7127930182','7127930914','7127940001','7127940182','7127940914','7127950001','7127950182','7127950914','7127960001','7127960182','7127960914','7127970001','7127970182','7127970914','7127990001','7127990182','7127990914','7129200001','7129200182','7134210001','7134210182','7137030000','7137040000','7137050000','7139020000','7143010000','7143020000','7144930000','7146040000','7146180001','7146180049','7146180182','7146500001','7146500182','7146500914','7146580001','7146580049','7146580182','7151030001','7151030182','7151030914','7151040001','7151040182','7151040914','7152070001','7152070182','7152090001','7152090182','7153060001','7153060182','7153060914','7153080001','7153080182','7153080914','7153090001','7153090182','7153090914','7156010000','7156130000','7220050000','7231010000','7231020000','7231060000','7231150000','7231160000','7232080001','7232080049','7232087035','7232127035','7232147035','7232160001','7232160049','7232167035','7232187035','7232247035','7233020000','7233040000','7233080000','7233100000','7233110000','7233120000','7236010001','7236010182','7236010914','7236040000','7236040001','7236080001','7236087035','7236120001','7236120049','7236127035','7321210001','7326000000','7326010000','7326020000','7326030000','7326080000','7350150001','7350150182','7350150914','7350200001','7350200182','7350200914','7350250001','7350250182','7350250914','7350300001','7350300182','7350300914','7390020001','7390020182','7390020914','7390030001','7390030182','7390030914','7390060001','7390060182','7390060914','7390160001','7390160182','7390160914','7390200001','7390200182','7390200914','7390250001','7390250182','7390250914','7390300001','7390300182','7390300914','7390350001','7390350182','7390350914','7390400001','7390400182','7390400914','7390930001','7390930182','7390930914','7390950001','7390950182','7390950914','7394160001','7394160182','7394160914','7394200001','7394200182','7394200914','7394250001','7394250182','7394250914','7394300001','7394300182','7394300914','7394350001','7394350182','7394350914','7394400001','7394400182','7394400914','7441500001','7441500182','7441500914','7441700001','7441700182','7441700914','7456500001','7456500182','7456500914','7457500001','7457500182','7457500914','7460500000','7460700000','7468500001','7468500182','7468500914','7468700001','7468700182','7468700914','7475500001','7475500182','7476500001','7476500182','7477500001','7477500182','7477700001','7477700182','7478500001','7478500182','7478700001','7478700182','7479500001','7479500182','7479700001','7479700182','7483500001','7483500182','7483500914','7483700001','7483700182','7483700914','7485700000','7488500001','7488500182','7488500914','7488700001','7488700182','7488700914','7489500001','7489500182','7489500914','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700001','7494700182','7494700914','7495500001','7495500182','7495500914','7495700001','7495700182','7495700914','7497700001','7497700182','7497700914','7498700001','7498700182','7498700914','7499700001','7499700182','7499700914','7742140001','7742140182','7742140914','7747720000','7761030001','7761030049','7761030182','7766030000','7766050000','7766070000','7766250000','7766270000','9990710')
  and f.DataType1 in ('Stat_FC')
  and f.Date < '2021-01-01'
  --and f.ItemNumber in ('24.5349.0204')
  group by f.ItemNumber
  order by avg(f.Value) desc


select * from JDE_DB_Alan.vw_Mast m
where m.ItemNumber in ('24.7202.0000','24.7202.0001','24.7364.1858','82.301.922','2801462000')
--where m.ItemNumber in ('7123050049','7127140914','7127180914','7134220001','7134220182','7134220914','7134230182','7152070914','7152090914','7370200001','7370400001','7370400182','7475500914','7476500914','42.653.000','42.655.850','6611500000','7122950182','7122960000','7123050001','7123050182','7123051901','7123070001','7123070049','7123070182','7124100049','7124170001','7127140001','7127140182','7127180001','7127180182','7127190000','7127800182','7137030000','7137040000','7137050000','7139020000','7152070001','7152070182','7152090001','7152090182','7153060001','7153060182','7153060914','7153080001','7153080182','7153090001','7153090182','7220050000','7231010000','7232080001','7232080049','7232247035','7233080000','7233120000','7236010001','7236010182','7236010914','7236087035','7321210001','7350200182','7394160001','7394160182','7394160914','7394200001','7394200914','7394250001','7394250182','7394300001','7394300182','7394300914','7394350182','7394400001','7456500182','7475500001','7475500182','7476500001','7476500182','7483700001','7483700914','7485700000','7491500001','7491700001','7742140914','7761030049','7761030182','9990710')


select * from JDE_DB_Alan.FCPRO_Fcst_History fh 
where fh.ItemNumber in ('42.210.031') and fh.DataType1 in ('Adj_FC')
	  and fh.ReportDate between '2020-05-01' and '2020-05-18 17:00:00:00'
	  and fh.Date between '2020-05-01' and '2020-10-01'

	  
--select distinct h.ItemNumber
select h.*,concat(h.Century , h.FinancialYear,h.FinancialMonth) as YY, abs( h.Quantity) as Quantities
from JDE_DB_Alan.SlsHistoryHD h
--from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h
where h.ItemNumber in('34.215.000','34.216.000','34.230.000','34.232.000','34.233.000','34.234.000','34.242.000')
--where h.ItemNumber in ('1003724','3400070785','3400112300','3400114300','3400238000','3400272048','3400272064','3400272428','3400272785','3400272810','3400320000','3400350661','3400350785','3400382000','3400383000','3400669048','3400669320','3400669370','3400669661','3400669765','3400669810','3400674000','3400675000','3400679000','3400680000','3400715320','3401095048','3401095320','3401095370','3401095661','3401095765','3401095810','3402194000','3403854500','4150085250','4600300296','KIT9203','KIT9205','KIT9206','342J47622','342J47623','342J47627','342J6108141','342J6108144','342J6108146','342J6108221','342M4501','342M4502','342M4509','342M4511','342M45591','342M45592','342M45594','342M45595','342M45596','342M45599','342P4541','342P4544','342P4547','342P4548','342Q296401','342Q296402','342Q296403','342Q296404','342Q296410','342Q296411','FJ47108A623','FJ5108A141','FJ5108A146','FJ5108A221','FM3108A501','FM3108A502','FM45108A591','FM45108A594','FM45108A599','FP3108A541','FP3108A544','FP3108A548','FPH3108A541','FPH3108A544','FPH3108A547','FPH3108A548','FQ1096A401','FQ1096A402','FZ30088A401','FZ30088A402','FZ40088A501','FZ40088A502','FZ42088A541','FZ42088A544','FZ42088A547','FZ42088A548','FZ45088A591','FZ45088A594','FZ45088A599','FZ47088A623','FZ5088A141','FZ5088A146','FZ5088A221','FZH42088A541','FZH42088A544','FZH42088A547','FZH42088A548','J47108A623','J6096A221','J6108A141','J6108A146','J6108A221','M4108A501','M4108A502','M45108A591','M45108A594','M45108A599','P4108A541','P4108A544','P4108A547','P4108A548','P4H108A541','P4H108A544','P4H108A547','P4H108A548','Q2096A401','Q2096A402','Z18088A141','Z18088A146','Z18088A221','Z27088A401','Z27088A402','Z41088A501','Z41088A502','Z43088A541','Z43088A544','Z43088A547','Z43088A548','Z43H088A541','Z43H088A544','Z43H088A547','Z43H088A548','Z45088A591','Z45088A594','Z45088A599','Z47088A623')


select distinct m.NewItemNumber
from JDE_DB_Alan.MasterSuperssionItemList m
where m.NewItemNumber in ('1003724','3400272048','3400350661','3400669048','3400669370','3400669765','3401095048','342J47622','342J47627','342J6108144','342M4509','342M4511','342M45592','342M45595','342M45596','342Q296403','342Q296404','342Q296410','342Q296411','FPH3108A541','FPH3108A544','FPH3108A547','FPH3108A548','FZH42088A541','FZH42088A544','FZH42088A547','FZH42088A548','J6108A221','P4108A544','P4H108A541','P4H108A544','P4H108A547','P4H108A548','Z43H088A541','Z43H088A544','Z43H088A547','Z43H088A548','Z47088A623')

---------- 28/5/2020 ------------------
  select * 
  FROM [JDE_DB_Alan].[FCPRO_SafetyStock] s
  where s.ItemNumber in ('FT.01391.000.00','26.144.0204')


select * from JDE_DB_Alan.vw_Mast_Vendor_Item_CrossRef v


select distinct m.SellingGroup_,m.FamilyGroup_,m.FamilyGroup,m.Sls_Cd1 from JDE_DB_Alan.vw_Mast_Planning m
order by m.SellingGroup_,m.FamilyGroup_,m.FamilyGroup,m.Sls_Cd1

select * from JDE_DB_Alan.vw_Mast_Planning m where m.Item_Number in ('52.008.104','42.210.031','')

select * from JDE_DB_Alan.vw_Mast m
where m.ItemNumber in ('82.691.903')




--------- COVID-19 forecast update April -------------- 30% down except 3 areas        ------ 7/4/2020
;update f
set f.Value = f.value /0.7
from JDE_DB_Alan.FCPRO_Fcst f
where --f.ReportDate between '2020-04-01' and '2020-09-01 13:00:00'
       f.ItemNumber in ('42.210.031')
     --where f.ItemNumber in ('38.001.005') 
     --  and f.Date = '2020-04-01'
	  and f.Date between '2020-04-01' and '2020-09-01'
	  and f.DataType1 = 'Adj_FC'


;update f
set f.Value = f.value * 0.7
from JDE_DB_Alan.FCPRO_Fcst f
where 
       f.ItemNumber not in  ('25.020.0155','25.020.1858','25.021.0155','25.021.1858','25.022.0155','25.022.1858','25.023.0155','25.023.1858','25.024.0155','25.024.1858','25.025.0155','25.025.1858','25.026.0155','25.026.1858','25.027.0155','25.027.1858','25.028.0155','25.028.1858','25.029.000','25.030.0155','25.031.0155','25.030.1858','25.031.1858','25.032.000','25.033.000','25.034.000','25.035.000','25.036.000','25.037.030','25.038.0155','25.039.0155','25.038.1858','25.039.1858','25.040.0155','25.040.1858','25.041.0155','25.041.1858','25.013.0155 ','25.013.1858 ','24.7257.0952','32.379.200','32.455.155','24.7121.0155','24.7100.0199','32.340.000','24.7122.0155','24.7127.0155','24.7120.0155','24.7200.0001','24.7125.0155','24.7002.0001','24.7121.1858','24.7110.0155','24.7100.1858','32.455.855','24.7122.1858','24.7120.1858','24.7127.1858','24.7124.0155','24.7102.0199','24.7201.0000','24.7100.7052A','24.7125.1858','24.7121.0952A','24.5411.0000','24.5398.0000','24.5404.0000','24.7127.0952','24.7100.4459A','24.5358.0000','32.455.460','24.7102.1858','24.7334.0199','24.5403.0000','24.7128.0155','24.7121.4459A','24.7121.0952','24.7002.0001T','24.7127.4459','32.455.462','24.7219.0952','24.7120.0952A','24.7002.0000T','24.5399.0000','24.5426.0204','24.7122.0952A','24.7200.0001T','32.341.155','24.7110.1858','24.7201.0000T','24.7125.0952A','24.7121.4459','24.5353.0204','32.455.461','24.5427.0204','24.7120.4459A','24.7128.0155A','24.7122.4459A','24.7364.0199','24.7333.0199','24.7124.1858','24.7120.0952','24.7200.0000','24.7125.4459A','24.7219.0199','24.7002.0000','24.5414.0000','24.7122.0952','24.5415.0000','24.5397.0000','24.7202.0000','24.5425.0204','24.7120.4459','24.7122.4459','24.5416.0000','24.7128.1858A','24.7219.1858','24.7124.0952','24.7202.0001','24.5418.0000','24.7334.1858','24.5349.0204','24.7124.4459','24.7334.0952','24.7219.4459','24.5417.0000','24.5405.0000','24.7110.0952','24.7334.4459','32.341.855','24.7333.1858','24.7102.7052A','24.7114.0155','24.7110.0952A','24.7128.0952A','24.7333.0952','24.7128.1858','24.5396.0000','24.5426.1858','24.7114.1858','24.5353.1858','24.5427.1858','24.7110.4459','24.5427.4459','24.5424.0204','24.5426.4459','24.5349.1858','24.5413.0000','24.7364.1858','24.7363.0199','32.455.465','24.7110.4459A','24.7333.4459','24.7128.0952','24.7124.0952A','24.7200.0000T','24.7125.0952','24.5353.4459','24.7219.4464','24.5425.1858','24.7363.1858','24.5425.4459','32.341.176','24.7364.0952','24.7102.4459A','24.5354.1858','24.5427.0952','24.5354.0204','24.5426.0952','24.7114.0952A','24.7219.4460','24.5412.0000','24.5353.0952','24.7125.4459','24.7219.4462','24.7364.4459','24.5349.4459','24.7128.4459A','24.7124.4459A','24.5425.0952','24.7128.4459','24.5360.1858','24.5424.1858','24.7114.4459A','24.5349.0952','24.7307.1858','24.7201.0002','24.5424.4459','24.5354.0952','24.5424.0952','24.5354.4459','24.7219.4465','24.5361.1858','24.5360.0204','24.7363.0952','24.7300.7060','24.7196.7060A','24.7363.4459','24.7116.0155','24.7193.0199A','24.7195.0199A','24.7195.1858A','24.5362.0204','24.5110.7178','24.5362.1858','24.5361.0204','24.5363.1858','24.5363.0204','24.7102.7052','24.7192.7060A','82.691.901','82.696.901','82.696.903','82.691.909','82.691.903','82.696.930','82.696.910','82.696.909','82.696.921','82.696.926','82.691.906','82.691.910','82.696.933','82.696.906','82.696.904','82.691.926','82.696.932','82.691.933','82.696.922','82.696.928','82.691.930','82.696.927','82.696.931','82.691.904','82.696.913','82.691.932','82.696.924','82.696.920','82.696.912','82.696.902','82.696.911','82.691.911','82.691.928','82.696.923','82.691.931','82.696.918','82.696.907','82.696.919','82.696.915','22.748.091','82.691.907','82.696.905','82.691.902','82.696.914','82.691.927','82.691.919','82.696.929','82.691.912','82.691.905','82.696.908','82.696.941','82.691.929','82.696.925','82.691.908','82.696.934','22.749.091','43.525.101','43.525.102','43.525.103','43.525.105','43.525.107','43.525.403','43.525.404','43.525.405','43.530.101','43.530.102','43.530.103','43.530.105','43.530.107','43.530.403','43.530.404','43.530.405','40.199.850','40.196.850','40.197.850','40.191.000','40.174.131','40.129.131','40.280.120','40.152.131','40.129.433','40.169.173','40.129.378','40.368.173','40.129.804','40.173.850','40.345.131','40.367.173','40.153.131','40.260.131','40.041.131','40.042.131','40.129.430','40.132.131','40.024.131','40.153.378','40.263.131','40.176.850','40.262.131','40.200.850','40.132.378','40.041.378','40.132.430','40.189.002','40.129.805','40.198.850','40.153.433','40.042.433','40.270.131','40.170.173','40.260.378','40.132.433','40.041.433','40.163.131','40.162.131','40.153.804','40.025.131','40.042.804','40.187.850','40.260.804','40.129.280','40.026.131','40.132.804','40.153.430','40.467.850','40.023.000','40.129.228','40.042.228','40.153.228','40.042.378','40.381.000','40.041.804','40.260.430','40.034.000','40.271.850','40.041.430','40.042.430','40.260.433','40.041.228','40.264.131','40.175.002','40.153.805','40.346.131','40.132.280','40.340.173','40.260.805','40.042.805','40.131.131','40.041.805','40.171.173','40.188.850','40.158.131','40.132.805','40.172.850','40.046.850','40.041.280','40.371.173','40.132.228','40.260.228','40.379.000','40.131.378','40.042.280','40.026.378','40.415.173','40.035.120','40.030.131','40.048.131','40.047.856','40.380.002','40.029.131','40.377.000','40.031.131','40.001.850','40.051.048','40.032.131','40.033.131')
	  and f.Date between '2020-04-01' and '2020-09-01'
	  and f.DataType1 = 'Adj_FC'

select (5138 - 386) * 6   --> 28,512      there are total 5138 SKUs get forecasted in April 2020, 386 SKUs are in exception list ( RB 242 + Commodity line 40 + Blue Pacific 104 ( FG 964 ) ), only reduce FC 30% for 6 months    --- 4/4/2020


 --- update FC History as well ---
;update fh
set fh.Value = fh.value * 0.7
from JDE_DB_Alan.FCPRO_Fcst_History fh
where 
      fh.ReportDate between '2020-04-01' and '2020-04-09 17:00:00:00'
	  and fh.Date between '2020-04-01' and '2020-09-01'
      and fh.ItemNumber not in  ('25.020.0155','25.020.1858','25.021.0155','25.021.1858','25.022.0155','25.022.1858','25.023.0155','25.023.1858','25.024.0155','25.024.1858','25.025.0155','25.025.1858','25.026.0155','25.026.1858','25.027.0155','25.027.1858','25.028.0155','25.028.1858','25.029.000','25.030.0155','25.031.0155','25.030.1858','25.031.1858','25.032.000','25.033.000','25.034.000','25.035.000','25.036.000','25.037.030','25.038.0155','25.039.0155','25.038.1858','25.039.1858','25.040.0155','25.040.1858','25.041.0155','25.041.1858','25.013.0155 ','25.013.1858 ','24.7257.0952','32.379.200','32.455.155','24.7121.0155','24.7100.0199','32.340.000','24.7122.0155','24.7127.0155','24.7120.0155','24.7200.0001','24.7125.0155','24.7002.0001','24.7121.1858','24.7110.0155','24.7100.1858','32.455.855','24.7122.1858','24.7120.1858','24.7127.1858','24.7124.0155','24.7102.0199','24.7201.0000','24.7100.7052A','24.7125.1858','24.7121.0952A','24.5411.0000','24.5398.0000','24.5404.0000','24.7127.0952','24.7100.4459A','24.5358.0000','32.455.460','24.7102.1858','24.7334.0199','24.5403.0000','24.7128.0155','24.7121.4459A','24.7121.0952','24.7002.0001T','24.7127.4459','32.455.462','24.7219.0952','24.7120.0952A','24.7002.0000T','24.5399.0000','24.5426.0204','24.7122.0952A','24.7200.0001T','32.341.155','24.7110.1858','24.7201.0000T','24.7125.0952A','24.7121.4459','24.5353.0204','32.455.461','24.5427.0204','24.7120.4459A','24.7128.0155A','24.7122.4459A','24.7364.0199','24.7333.0199','24.7124.1858','24.7120.0952','24.7200.0000','24.7125.4459A','24.7219.0199','24.7002.0000','24.5414.0000','24.7122.0952','24.5415.0000','24.5397.0000','24.7202.0000','24.5425.0204','24.7120.4459','24.7122.4459','24.5416.0000','24.7128.1858A','24.7219.1858','24.7124.0952','24.7202.0001','24.5418.0000','24.7334.1858','24.5349.0204','24.7124.4459','24.7334.0952','24.7219.4459','24.5417.0000','24.5405.0000','24.7110.0952','24.7334.4459','32.341.855','24.7333.1858','24.7102.7052A','24.7114.0155','24.7110.0952A','24.7128.0952A','24.7333.0952','24.7128.1858','24.5396.0000','24.5426.1858','24.7114.1858','24.5353.1858','24.5427.1858','24.7110.4459','24.5427.4459','24.5424.0204','24.5426.4459','24.5349.1858','24.5413.0000','24.7364.1858','24.7363.0199','32.455.465','24.7110.4459A','24.7333.4459','24.7128.0952','24.7124.0952A','24.7200.0000T','24.7125.0952','24.5353.4459','24.7219.4464','24.5425.1858','24.7363.1858','24.5425.4459','32.341.176','24.7364.0952','24.7102.4459A','24.5354.1858','24.5427.0952','24.5354.0204','24.5426.0952','24.7114.0952A','24.7219.4460','24.5412.0000','24.5353.0952','24.7125.4459','24.7219.4462','24.7364.4459','24.5349.4459','24.7128.4459A','24.7124.4459A','24.5425.0952','24.7128.4459','24.5360.1858','24.5424.1858','24.7114.4459A','24.5349.0952','24.7307.1858','24.7201.0002','24.5424.4459','24.5354.0952','24.5424.0952','24.5354.4459','24.7219.4465','24.5361.1858','24.5360.0204','24.7363.0952','24.7300.7060','24.7196.7060A','24.7363.4459','24.7116.0155','24.7193.0199A','24.7195.0199A','24.7195.1858A','24.5362.0204','24.5110.7178','24.5362.1858','24.5361.0204','24.5363.1858','24.5363.0204','24.7102.7052','24.7192.7060A','82.691.901','82.696.901','82.696.903','82.691.909','82.691.903','82.696.930','82.696.910','82.696.909','82.696.921','82.696.926','82.691.906','82.691.910','82.696.933','82.696.906','82.696.904','82.691.926','82.696.932','82.691.933','82.696.922','82.696.928','82.691.930','82.696.927','82.696.931','82.691.904','82.696.913','82.691.932','82.696.924','82.696.920','82.696.912','82.696.902','82.696.911','82.691.911','82.691.928','82.696.923','82.691.931','82.696.918','82.696.907','82.696.919','82.696.915','22.748.091','82.691.907','82.696.905','82.691.902','82.696.914','82.691.927','82.691.919','82.696.929','82.691.912','82.691.905','82.696.908','82.696.941','82.691.929','82.696.925','82.691.908','82.696.934','22.749.091','43.525.101','43.525.102','43.525.103','43.525.105','43.525.107','43.525.403','43.525.404','43.525.405','43.530.101','43.530.102','43.530.103','43.530.105','43.530.107','43.530.403','43.530.404','43.530.405','40.199.850','40.196.850','40.197.850','40.191.000','40.174.131','40.129.131','40.280.120','40.152.131','40.129.433','40.169.173','40.129.378','40.368.173','40.129.804','40.173.850','40.345.131','40.367.173','40.153.131','40.260.131','40.041.131','40.042.131','40.129.430','40.132.131','40.024.131','40.153.378','40.263.131','40.176.850','40.262.131','40.200.850','40.132.378','40.041.378','40.132.430','40.189.002','40.129.805','40.198.850','40.153.433','40.042.433','40.270.131','40.170.173','40.260.378','40.132.433','40.041.433','40.163.131','40.162.131','40.153.804','40.025.131','40.042.804','40.187.850','40.260.804','40.129.280','40.026.131','40.132.804','40.153.430','40.467.850','40.023.000','40.129.228','40.042.228','40.153.228','40.042.378','40.381.000','40.041.804','40.260.430','40.034.000','40.271.850','40.041.430','40.042.430','40.260.433','40.041.228','40.264.131','40.175.002','40.153.805','40.346.131','40.132.280','40.340.173','40.260.805','40.042.805','40.131.131','40.041.805','40.171.173','40.188.850','40.158.131','40.132.805','40.172.850','40.046.850','40.041.280','40.371.173','40.132.228','40.260.228','40.379.000','40.131.378','40.042.280','40.026.378','40.415.173','40.035.120','40.030.131','40.048.131','40.047.856','40.380.002','40.029.131','40.377.000','40.031.131','40.001.850','40.051.048','40.032.131','40.033.131')
	   and fh.DataType1 = 'Adj_FC'


--------- COVID-19 forecast update May -------------- 15% down except 3 areas        ------ 13/5/2020
;update f
set f.Value = f.value /0.85
from JDE_DB_Alan.FCPRO_Fcst f
where --f.ReportDate between '2020-04-01' and '2020-09-01 13:00:00'
       f.ItemNumber in ('42.210.031')
     --where f.ItemNumber in ('38.001.005') 
     --  and f.Date = '2020-04-01'
	  and f.Date between '2020-05-01' and '2020-10-01'
	  and f.DataType1 = 'Adj_FC'

select * from JDE_DB_Alan.FCPRO_Fcst_History f where f.ItemNumber in ('34.267.0155') and f.DataType1 in ('adj_fc')
select distinct f.ItemNumber from JDE_DB_Alan.FCPRO_Fcst f

;update f
set f.Value = f.value * 0.85
from JDE_DB_Alan.FCPRO_Fcst f
where 
       f.ItemNumber not in  ('25.020.0155','25.020.1858','25.021.0155','25.021.1858','25.022.0155','25.022.1858','25.023.0155','25.023.1858','25.024.0155','25.024.1858','25.025.0155','25.025.1858','25.026.0155','25.026.1858','25.027.0155','25.027.1858','25.028.0155','25.028.1858','25.029.000','25.030.0155','25.031.0155','25.030.1858','25.031.1858','25.032.000','25.033.000','25.034.000','25.035.000','25.036.000','25.037.030','25.038.0155','25.039.0155','25.038.1858','25.039.1858','25.040.0155','25.040.1858','25.041.0155','25.041.1858','25.013.0155 ','25.013.1858 ','24.7257.0952','32.379.200','32.455.155','24.7121.0155','24.7100.0199','32.340.000','24.7122.0155','24.7127.0155','24.7120.0155','24.7200.0001','24.7125.0155','24.7002.0001','24.7121.1858','24.7110.0155','24.7100.1858','32.455.855','24.7122.1858','24.7120.1858','24.7127.1858','24.7124.0155','24.7102.0199','24.7201.0000','24.7100.7052A','24.7125.1858','24.7121.0952A','24.5411.0000','24.5398.0000','24.5404.0000','24.7127.0952','24.7100.4459A','24.5358.0000','32.455.460','24.7102.1858','24.7334.0199','24.5403.0000','24.7128.0155','24.7121.4459A','24.7121.0952','24.7002.0001T','24.7127.4459','32.455.462','24.7219.0952','24.7120.0952A','24.7002.0000T','24.5399.0000','24.5426.0204','24.7122.0952A','24.7200.0001T','32.341.155','24.7110.1858','24.7201.0000T','24.7125.0952A','24.7121.4459','24.5353.0204','32.455.461','24.5427.0204','24.7120.4459A','24.7128.0155A','24.7122.4459A','24.7364.0199','24.7333.0199','24.7124.1858','24.7120.0952','24.7200.0000','24.7125.4459A','24.7219.0199','24.7002.0000','24.5414.0000','24.7122.0952','24.5415.0000','24.5397.0000','24.7202.0000','24.5425.0204','24.7120.4459','24.7122.4459','24.5416.0000','24.7128.1858A','24.7219.1858','24.7124.0952','24.7202.0001','24.5418.0000','24.7334.1858','24.5349.0204','24.7124.4459','24.7334.0952','24.7219.4459','24.5417.0000','24.5405.0000','24.7110.0952','24.7334.4459','32.341.855','24.7333.1858','24.7102.7052A','24.7114.0155','24.7110.0952A','24.7128.0952A','24.7333.0952','24.7128.1858','24.5396.0000','24.5426.1858','24.7114.1858','24.5353.1858','24.5427.1858','24.7110.4459','24.5427.4459','24.5424.0204','24.5426.4459','24.5349.1858','24.5413.0000','24.7364.1858','24.7363.0199','32.455.465','24.7110.4459A','24.7333.4459','24.7128.0952','24.7124.0952A','24.7200.0000T','24.7125.0952','24.5353.4459','24.7219.4464','24.5425.1858','24.7363.1858','24.5425.4459','32.341.176','24.7364.0952','24.7102.4459A','24.5354.1858','24.5427.0952','24.5354.0204','24.5426.0952','24.7114.0952A','24.7219.4460','24.5412.0000','24.5353.0952','24.7125.4459','24.7219.4462','24.7364.4459','24.5349.4459','24.7128.4459A','24.7124.4459A','24.5425.0952','24.7128.4459','24.5360.1858','24.5424.1858','24.7114.4459A','24.5349.0952','24.7307.1858','24.7201.0002','24.5424.4459','24.5354.0952','24.5424.0952','24.5354.4459','24.7219.4465','24.5361.1858','24.5360.0204','24.7363.0952','24.7300.7060','24.7196.7060A','24.7363.4459','24.7116.0155','24.7193.0199A','24.7195.0199A','24.7195.1858A','24.5362.0204','24.5110.7178','24.5362.1858','24.5361.0204','24.5363.1858','24.5363.0204','24.7102.7052','24.7192.7060A','82.691.901','82.696.901','82.696.903','82.691.909','82.691.903','82.696.930','82.696.910','82.696.909','82.696.921','82.696.926','82.691.906','82.691.910','82.696.933','82.696.906','82.696.904','82.691.926','82.696.932','82.691.933','82.696.922','82.696.928','82.691.930','82.696.927','82.696.931','82.691.904','82.696.913','82.691.932','82.696.924','82.696.920','82.696.912','82.696.902','82.696.911','82.691.911','82.691.928','82.696.923','82.691.931','82.696.918','82.696.907','82.696.919','82.696.915','22.748.091','82.691.907','82.696.905','82.691.902','82.696.914','82.691.927','82.691.919','82.696.929','82.691.912','82.691.905','82.696.908','82.696.941','82.691.929','82.696.925','82.691.908','82.696.934','22.749.091','43.525.101','43.525.102','43.525.103','43.525.105','43.525.107','43.525.403','43.525.404','43.525.405','43.530.101','43.530.102','43.530.103','43.530.105','43.530.107','43.530.403','43.530.404','43.530.405','40.199.850','40.196.850','40.197.850','40.191.000','40.174.131','40.129.131','40.280.120','40.152.131','40.129.433','40.169.173','40.129.378','40.368.173','40.129.804','40.173.850','40.345.131','40.367.173','40.153.131','40.260.131','40.041.131','40.042.131','40.129.430','40.132.131','40.024.131','40.153.378','40.263.131','40.176.850','40.262.131','40.200.850','40.132.378','40.041.378','40.132.430','40.189.002','40.129.805','40.198.850','40.153.433','40.042.433','40.270.131','40.170.173','40.260.378','40.132.433','40.041.433','40.163.131','40.162.131','40.153.804','40.025.131','40.042.804','40.187.850','40.260.804','40.129.280','40.026.131','40.132.804','40.153.430','40.467.850','40.023.000','40.129.228','40.042.228','40.153.228','40.042.378','40.381.000','40.041.804','40.260.430','40.034.000','40.271.850','40.041.430','40.042.430','40.260.433','40.041.228','40.264.131','40.175.002','40.153.805','40.346.131','40.132.280','40.340.173','40.260.805','40.042.805','40.131.131','40.041.805','40.171.173','40.188.850','40.158.131','40.132.805','40.172.850','40.046.850','40.041.280','40.371.173','40.132.228','40.260.228','40.379.000','40.131.378','40.042.280','40.026.378','40.415.173','40.035.120','40.030.131','40.048.131','40.047.856','40.380.002','40.029.131','40.377.000','40.031.131','40.001.850','40.051.048','40.032.131','40.033.131','34.274.0155','34.263.0155','34.264.0155','34.265.0155','34.266.0000','34.267.0155','34.268.0000','34.269.0155','34.270.0155','34.271.0155','34.272.0155','34.273.0155','34.276.0000')
	  and f.Date between '2020-05-01' and '2020-10-01'
	  and f.DataType1 = 'Adj_FC'

select (5098 - 386) * 6   --> 28,272/28284      there are total 5098 SKUs get forecasted in May 2020, 386 SKUs are in exception list ( RB 242 + Commodity line 40 + Blue Pacific 104 ( FG 964 ) ), only reduce FC 30% for 6 months    --- 14/5/2020
select (5098 - 386 - 13) * 6   --> 28,206      there are total 5098 SKUs ( but need to exclude Drapery programme as well )  get forecasted in May 2020, 386 SKUs are in exception list ( RB 242 + Commodity line 40 + Blue Pacific 104 ( FG 964 ) ), only reduce FC 30% for 6 months    --- 14/5/2020

 --- update FC History as well ---
;update fh
set fh.Value = fh.value * 0.85
from JDE_DB_Alan.FCPRO_Fcst_History fh
where 
      fh.ReportDate between '2020-05-01' and '2020-05-18 17:00:00:00'
	  and fh.Date between '2020-05-01' and '2020-10-01'
      and fh.ItemNumber not in  ('25.020.0155','25.020.1858','25.021.0155','25.021.1858','25.022.0155','25.022.1858','25.023.0155','25.023.1858','25.024.0155','25.024.1858','25.025.0155','25.025.1858','25.026.0155','25.026.1858','25.027.0155','25.027.1858','25.028.0155','25.028.1858','25.029.000','25.030.0155','25.031.0155','25.030.1858','25.031.1858','25.032.000','25.033.000','25.034.000','25.035.000','25.036.000','25.037.030','25.038.0155','25.039.0155','25.038.1858','25.039.1858','25.040.0155','25.040.1858','25.041.0155','25.041.1858','25.013.0155 ','25.013.1858 ','24.7257.0952','32.379.200','32.455.155','24.7121.0155','24.7100.0199','32.340.000','24.7122.0155','24.7127.0155','24.7120.0155','24.7200.0001','24.7125.0155','24.7002.0001','24.7121.1858','24.7110.0155','24.7100.1858','32.455.855','24.7122.1858','24.7120.1858','24.7127.1858','24.7124.0155','24.7102.0199','24.7201.0000','24.7100.7052A','24.7125.1858','24.7121.0952A','24.5411.0000','24.5398.0000','24.5404.0000','24.7127.0952','24.7100.4459A','24.5358.0000','32.455.460','24.7102.1858','24.7334.0199','24.5403.0000','24.7128.0155','24.7121.4459A','24.7121.0952','24.7002.0001T','24.7127.4459','32.455.462','24.7219.0952','24.7120.0952A','24.7002.0000T','24.5399.0000','24.5426.0204','24.7122.0952A','24.7200.0001T','32.341.155','24.7110.1858','24.7201.0000T','24.7125.0952A','24.7121.4459','24.5353.0204','32.455.461','24.5427.0204','24.7120.4459A','24.7128.0155A','24.7122.4459A','24.7364.0199','24.7333.0199','24.7124.1858','24.7120.0952','24.7200.0000','24.7125.4459A','24.7219.0199','24.7002.0000','24.5414.0000','24.7122.0952','24.5415.0000','24.5397.0000','24.7202.0000','24.5425.0204','24.7120.4459','24.7122.4459','24.5416.0000','24.7128.1858A','24.7219.1858','24.7124.0952','24.7202.0001','24.5418.0000','24.7334.1858','24.5349.0204','24.7124.4459','24.7334.0952','24.7219.4459','24.5417.0000','24.5405.0000','24.7110.0952','24.7334.4459','32.341.855','24.7333.1858','24.7102.7052A','24.7114.0155','24.7110.0952A','24.7128.0952A','24.7333.0952','24.7128.1858','24.5396.0000','24.5426.1858','24.7114.1858','24.5353.1858','24.5427.1858','24.7110.4459','24.5427.4459','24.5424.0204','24.5426.4459','24.5349.1858','24.5413.0000','24.7364.1858','24.7363.0199','32.455.465','24.7110.4459A','24.7333.4459','24.7128.0952','24.7124.0952A','24.7200.0000T','24.7125.0952','24.5353.4459','24.7219.4464','24.5425.1858','24.7363.1858','24.5425.4459','32.341.176','24.7364.0952','24.7102.4459A','24.5354.1858','24.5427.0952','24.5354.0204','24.5426.0952','24.7114.0952A','24.7219.4460','24.5412.0000','24.5353.0952','24.7125.4459','24.7219.4462','24.7364.4459','24.5349.4459','24.7128.4459A','24.7124.4459A','24.5425.0952','24.7128.4459','24.5360.1858','24.5424.1858','24.7114.4459A','24.5349.0952','24.7307.1858','24.7201.0002','24.5424.4459','24.5354.0952','24.5424.0952','24.5354.4459','24.7219.4465','24.5361.1858','24.5360.0204','24.7363.0952','24.7300.7060','24.7196.7060A','24.7363.4459','24.7116.0155','24.7193.0199A','24.7195.0199A','24.7195.1858A','24.5362.0204','24.5110.7178','24.5362.1858','24.5361.0204','24.5363.1858','24.5363.0204','24.7102.7052','24.7192.7060A','82.691.901','82.696.901','82.696.903','82.691.909','82.691.903','82.696.930','82.696.910','82.696.909','82.696.921','82.696.926','82.691.906','82.691.910','82.696.933','82.696.906','82.696.904','82.691.926','82.696.932','82.691.933','82.696.922','82.696.928','82.691.930','82.696.927','82.696.931','82.691.904','82.696.913','82.691.932','82.696.924','82.696.920','82.696.912','82.696.902','82.696.911','82.691.911','82.691.928','82.696.923','82.691.931','82.696.918','82.696.907','82.696.919','82.696.915','22.748.091','82.691.907','82.696.905','82.691.902','82.696.914','82.691.927','82.691.919','82.696.929','82.691.912','82.691.905','82.696.908','82.696.941','82.691.929','82.696.925','82.691.908','82.696.934','22.749.091','43.525.101','43.525.102','43.525.103','43.525.105','43.525.107','43.525.403','43.525.404','43.525.405','43.530.101','43.530.102','43.530.103','43.530.105','43.530.107','43.530.403','43.530.404','43.530.405','40.199.850','40.196.850','40.197.850','40.191.000','40.174.131','40.129.131','40.280.120','40.152.131','40.129.433','40.169.173','40.129.378','40.368.173','40.129.804','40.173.850','40.345.131','40.367.173','40.153.131','40.260.131','40.041.131','40.042.131','40.129.430','40.132.131','40.024.131','40.153.378','40.263.131','40.176.850','40.262.131','40.200.850','40.132.378','40.041.378','40.132.430','40.189.002','40.129.805','40.198.850','40.153.433','40.042.433','40.270.131','40.170.173','40.260.378','40.132.433','40.041.433','40.163.131','40.162.131','40.153.804','40.025.131','40.042.804','40.187.850','40.260.804','40.129.280','40.026.131','40.132.804','40.153.430','40.467.850','40.023.000','40.129.228','40.042.228','40.153.228','40.042.378','40.381.000','40.041.804','40.260.430','40.034.000','40.271.850','40.041.430','40.042.430','40.260.433','40.041.228','40.264.131','40.175.002','40.153.805','40.346.131','40.132.280','40.340.173','40.260.805','40.042.805','40.131.131','40.041.805','40.171.173','40.188.850','40.158.131','40.132.805','40.172.850','40.046.850','40.041.280','40.371.173','40.132.228','40.260.228','40.379.000','40.131.378','40.042.280','40.026.378','40.415.173','40.035.120','40.030.131','40.048.131','40.047.856','40.380.002','40.029.131','40.377.000','40.031.131','40.001.850','40.051.048','40.032.131','40.033.131','34.274.0155','34.263.0155','34.264.0155','34.265.0155','34.266.0000','34.267.0155','34.268.0000','34.269.0155','34.270.0155','34.271.0155','34.272.0155','34.273.0155','34.276.0000')
	   and fh.DataType1 = 'Adj_FC'

 ---******************************************************************
 --- Update forecast history for Duette & Silhouette --- 11/5/2021 , 973 Duette +15%, 979 +40%
  ---******************************************************************

;update h
set h.Value = h.Value *1.15
--select distinct h.itemnumber 
--select * 
from JDE_DB_Alan.FCPRO_Fcst_History h left join JDE_DB_Alan.vw_Mast a on h.ItemNumber = a.ItemNumber
 where h.ReportDate between '2021-04-29' and '2021-04-30 17:00:00:00'
      and a.FamilyGroup in ('973')
      --and h.ItemNumber in ('27.587.201','27.587.208') 
	  and h.Date between '2021-05-01' and '2022-04-01 17:00:00:00'
	  and h.DataType1 in ('Adj_FC')



----------------------------------------------------------------------------------
--- update one month data --- fc table
;update f
set f.Value = 250
--select * 
from JDE_DB_Alan.FCPRO_Fcst f
--where h.ReportDate between '2018-03-01' and '2018-03-02 13:00:00'
 where f.ItemNumber in ('44.011.002') 
	  --and f.Date between '2020-08-01' and '2021-03-01'
	  and f.Date in ('2023-05-01')
	  and f.DataType1 = 'Adj_FC'

select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('87.001.001')  and f.Date between '2022-04-01' and '2023-04-01'  and f.DataType1 = 'Adj_FC'

--- update one month data --- fc history table
;update h
set h.Value = 20
--select * 
from JDE_DB_Alan.FCPRO_Fcst_History h
--where h.ReportDate between '2018-03-01' and '2018-03-02 13:00:00'
 where h.ReportDate between '2019-04-10' and '2019-04-30 17:00:00:00'
      and h.ItemNumber in ('34.081.000') 
	  and h.Date in ('2019-09-01')

--------------------------------------------------------------------------------------------------------

--------- 6/4/2020 ---------------

select * from JDE_DB_Alan.TextileWC 
select * from JDE_DB_Alan.TextileFC f where f.Reportdate > '2020-01-30' and f.date < 20200601 
order by f.Date,f.Quantity desc

select sum(f.Quantity) from JDE_DB_Alan.TextileFC f where f.Reportdate > '2020-01-30' 
select max(f.date) from JDE_DB_Alan.TextileFC f where f.Reportdate > '2020-01-30' 

select * from JDE_DB_Alan.Textile_ItemCrossRef  
select distinct f.Reportdate from JDE_DB_Alan.TextileFC f

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('2781211001') 
select * from JDE_DB_Alan.vw_Mast m where m.SupplierName like ('%BR%') 
select * from JDE_DB_Alan.vw_Mast m where m.Family in ('VE1','VE2') order by m.Family,m.ItemNumber

select * from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
  where m.Description like  ('%plaza%') and m.StockingType not in ('O','U') and m.FamilyGroup in ('982')
  

select distinct f.ItemNumber
from JDE_DB_Alan.FCPRO_Fcst f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.PrimarySupplier in ('20037')
      and f.DataType1 = 'Adj_FC'
	  and f.Date between '2020-04-01'  and '2020-09-01'

select distinct f.ItemNumber
from JDE_DB_Alan.FCPRO_Fcst f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.ItemNumber like ('42.129.%')
      and f.DataType1 = 'Adj_FC'
	 

select * from JDE_DB_Alan.vw_Mast m 
where m.ItemNumber in ('44.010.007')
-- where m.ItemNumber in ('40.041.131','40.042.131','40.041.378','40.042.433','40.041.433','40.042.804','40.042.228','40.042.378','40.041.804','40.042.430','40.041.430','40.041.228','40.042.805','40.041.805','40.041.280','40.042.280','40.024.131','40.263.131','40.262.131','40.025.131','40.026.131','40.046.850','40.026.378','40.030.131','40.029.131','40.031.131','40.032.131','40.033.131','40.153.131','40.153.378','40.132.378','40.132.430','40.153.433','40.132.433','40.153.804','40.153.430','40.132.804','40.153.228','40.153.805','40.132.280','40.158.131','40.132.805','40.132.228','40.174.131','40.176.850','40.175.002','40.415.173','40.129.131','40.129.433','40.129.378','40.129.804','40.129.430','40.132.131','40.129.805','40.129.280','40.129.228','40.131.131','40.131.378','40.199.850','40.196.850','40.197.850','40.191.000','40.152.131','40.169.173','40.173.850','40.200.850','40.189.002','40.198.850','40.170.173','40.163.131','40.162.131','40.187.850','40.171.173','40.188.850','40.260.131','40.260.378','40.260.804','40.260.430','40.260.433','40.260.805','40.260.228','40.280.120','40.467.850','40.264.131','40.001.850','40.345.131','40.346.131','40.051.048','40.368.173','40.367.173','40.270.131','40.023.000','40.381.000','40.034.000','40.271.850','40.340.173','40.172.850','40.371.173','40.379.000','40.035.120','40.048.131','40.047.856','40.380.002','40.377.000')


----- 10/2/2021 ---- Nordic range review
select distinct f.ItemNumber,m.FamilyGroup,m.Description,m.Family_0,m.PrimarySupplier,m.SupplierName,m.Owner_
from JDE_DB_Alan.FCPRO_Fcst f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where --m.PrimarySupplier in ('20037')
       m.FamilyGroup in ('965')
      and f.DataType1 = 'Adj_FC'
	  and f.Date between '2021-02-01'  and '2021-12-01'
order by m.Owner_,m.PrimarySupplier


select * from JDE_DB_Alan.vw_Mast m 
where m.ItemNumber in ('26.478.000','46.025.000','46.410.063','46.414.000','46.421.000','46.422.030','46.423.100','46.423.134','46.423.850','46.424.100','46.425.100','46.508.500','46.508.700','46.559.030')

where m.ItemNumber in ('9990710','6610200000','6610220000','6610260000','6610300000','6610340000','6610350000','6610420000','6610480000','6610490000','6610520000','6610580000','6610660000','6610690000','6610930000','6610940000','6611000000','6611060000','6611080000','6611500000','6611510000','6611530000','6611550000','6658500000','6865255122','7020080000','7122570001','7122570049','7122570182','7122630001','7122630049','7122630182','7122640001','7122640049','7122640182','7122720001','7122720049','7122720182','7122900001','7122900049','7122900182','7122910001','7122910049','7122910182','7122920001','7122920049','7122920182','7122930001','7122930049','7122930182','7122950001','7122950182','7122950914','7122960000','7123060001','7123060049','7123060182','7123061901','7123070001','7123070049','7123070182','7123080001','7123080182','7123080914','7124010001','7124010049','7124010182','7124100001','7124100049','7124100182','7124130001','7124130049','7124130182','7124170001','7124170049','7124170182','7126070001','7126070182','7126070914','7127150001','7127150182','7127150914','7127500000','7127510001','7127510182','7127510914','7127600001','7127600182','7127600914','7127620001','7127620182','7127620914','7127650001','7127650182','7127650914','7127660001','7127660182','7127660914','7127690001','7127690182','7127690914','7127700001','7127700182','7127700914','7127710001','7127710182','7127710914','7127800001','7127800182','7127800914','7127850001','7127850182','7127850914','7127860001','7127860182','7127860914','7127890001','7127890182','7127890914','7127900001','7127900182','7127900914','7127910001','7127910182','7127910914','7127930001','7127930182','7127930914','7127940001','7127940182','7127940914','7127950001','7127950182','7127950914','7127960001','7127960182','7127960914','7127970001','7127970182','7127970914','7127990001','7127990182','7127990914','7129200001','7129200182','7129200914','7134210001','7134210182','7134210914','7134230001','7134230182','7134230914','7137030000','7137040000','7137050000','7139020000','7143010000','7143020000','7144930000','7146040000','7146180001','7146180049','7146180182','7146500001','7146500182','7146500914','7146520000','7146580001','7146580049','7146580182','7151030001','7151030182','7151030914','7151040001','7151040182','7151040914','7153060001','7153060182','7153060914','7153080001','7153080182','7153080914','7153090001','7153090182','7153090914','7156130000','7220050000','7231010000','7231020000','7231060000','7231150000','7231160000','7232080001','7232080049','7232087035','7232127035','7232147035','7232160001','7232160049','7232167035','7232187035','7232247035','7233020000','7233040000','7233080000','7233100000','7233110000','7233120000','7236040000','7236040001','7236080001','7236087035','7236120001','7236120049','7236127035','7310200000','7321210001','7326000000','7326010000','7326020000','7326030000','7326080000','7350150001','7350150182','7350150914','7350200001','7350200182','7350200914','7350250001','7350250182','7350250914','7350300001','7350300182','7350300914','7370200001','7370200182','7370200914','7370250001','7370250182','7370250914','7370300001','7370300182','7370300914','7370350001','7370350182','7370350914','7370400001','7370400182','7370400914','7390020001','7390020182','7390020914','7390030001','7390030182','7390030914','7390060001','7390060182','7390060914','7390160001','7390160182','7390160914','7390200001','7390200182','7390200914','7390250001','7390250182','7390250914','7390300001','7390300182','7390300914','7390350001','7390350182','7390350914','7390400001','7390400182','7390400914','7390930001','7390930182','7390930914','7390950001','7390950182','7390950914','7394160001','7394160182','7394160914','7394200001','7394200182','7394200914','7394250001','7394250182','7394250914','7394300001','7394300182','7394300914','7394350001','7394350182','7394350914','7394400001','7394400182','7394400914','7441500182','7442700001','7442700182','7442700914','7456500001','7456500182','7456500914','7457500001','7457500182','7457500914','7460500000','7460700000','7468500001','7468500182','7468500914','7468700001','7468700182','7468700914','7477500001','7477500182','7477500914','7477700001','7477700182','7477700914','7478500001','7478500182','7478500914','7478700001','7478700182','7478700914','7479500001','7479500182','7479500914','7479700001','7479700182','7479700914','7483500001','7483500182','7483500914','7483700001','7483700182','7483700914','7485700000','7488500001','7488500182','7488500914','7488700001','7488700182','7488700914','7489500001','7489500182','7489500914','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700001','7494700182','7494700914','7495500001','7495500182','7495500914','7495700001','7495700182','7495700914','7497700001','7497700182','7497700914','7498700001','7498700182','7498700914','7499700001','7499700182','7499700914','7742140001','7742140182','7742140914','7747720000','7761030001','7761030049','7761030182','7766030000','7766050000','7766070000','7766250000','7766270000','26.478.000','40.499.000','40.500.000','40.501.000','40.503.062','40.509.000','40.510.000','40.513.000','42.466.030','42.496.000','42.501.855','42.502.000','42.503.000','42.504.886','42.505.000','42.506.030','42.512.000','42.520.000','42.652.000','42.653.000','42.654.000','42.655.000','42.655.850','46.025.000','46.410.063','46.414.000','46.421.000','46.422.030','46.423.100','46.423.134','46.423.850','46.424.100','46.425.100','46.508.500','46.508.700','46.559.030')

----- 9/4/2020 -----

/****** Script for SelectTopNRows command from SSMS  ******/
SELECT *
  FROM [JDE_DB_Alan].[JDE_DB_Alan].[Textile_ItemCrossRef] t

  order by t.updatedate asc

 ; 
  where Reportdate > '20200407'
 where f.ArticleNumber in('1015637')
  oselect * from JDE_DB_Alan.JDE_DB_Alan.TextileFC frder by f.Date,f.Reportdate desc

 delete from JDE_DB_Alan.JDE_DB_Alan.TextileFC 
 where Reportdate > '20200407'

 select distinct f.Reportdate from JDE_DB_Alan.JDE_DB_Alan.TextileFC f

	  select f.ArticleNumber,f.Quantity,f.Date,max(f.Reportdate) as reportdt
	   from JDE_DB_Alan.JDE_DB_Alan.TextileFC f
	   group by f.ArticleNumber,f.Quantity,f.Date


----- 21/4/2020 -----

select * from JDE_DB_Alan.FCPRO_SafetyStock s 
where s.ItemNumber in ('2801490785')


----- 28/4/2020 -----
select distinct f.ItemNumber
--select f.ItemNumber,f.Value,f.Date,m.Description,m.Colour,m.FamilyGroup,m.Family,m.FamilyGroup_,m.Family_0
from JDE_DB_Alan.FCPRO_Fcst f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.FamilyGroup in ('966')  --and m.Family in ('635')
      and f.DataType1 = 'Adj_FC'
	  and m.Family in ('635')
	  --and f.Date between '2020-04-01' and '2020-07-01'
	  and m.Colour like ('nocturnal%')


select 336/24


----- 12/5/2020 -----
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('24.7257.0952','26.144.0204','26.132.1858','26.144.1858')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('FT.01468.000.01','34.073.000','24.5403.0000')
select * from JDE_DB_Alan.vw_Mast m where m.Description like ('%WEATHER%')
select * from JDE_DB_Alan.vw_Mast m where m.Description like ('%stance scrn%') and m.Description not like ('%ctl%')
select * from JDE_DB_Alan.vw_Mast m 
where m.ItemNumber like ('XUR%') or  m.ItemNumber like ('XUEC%') or  m.ItemNumber like('XUCLC%')
order by m.ItemNumber


select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('40.260.228')            --- Metal Awning part
select * from JDE_DB_Alan.HD_WorkCenter a where a.ItemNumber in ('40.260.228')
select * from JDE_DB_Alan.vw_FC a where a.ItemNumber in ('40.260.228','40.024.131')
 

select * from JDE_DB_Alan.vw_Mast m where m.Description like ('%chain loop%') and m.Family in ('374') and m.StockingType in ('P','s')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('24.7100.0199','24.7220.0199','32.455.155','24.7295.0952','34.480.000','34.540.000')

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in
('26.478.000','40.499.000','40.500.000','40.501.000','40.502.000','40.503.062','40.509.000','40.510.000','40.513.000','42.448.000','42.466.030','42.492.000','42.496.000','42.501.855','42.502.000','42.503.000','42.504.886','42.505.000','42.506.030','42.512.000','42.520.000','46.025.000','46.414.000','46.421.000','46.422.030','46.423.100','46.423.134','46.423.850','46.424.100','46.424.850','46.425.100','46.508.500','46.508.700','46.531.500','46.531.700','46.559.030','46.577.000','6802255122','6865255122','6865255206','7020080000','7310200000','7441500001B','7441500182B','7441500914B','7441700001B','7441700182B','7441700914B','TUFA20HS')

select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('24.7002.0001','26.144.0204','26.132.1858') and f.DataType1 in ('Adj_FC')
select * from JDE_DB_Alan.FCPRO_MI_2_tmp i where i.ItemNumber in ('24.7002.0001')
select * from JDE_DB_Alan.FCPRO_MI_2_tmp i where i.ItemNumber in ('24.7002.0001')
select * from  [JDE_DB_Alan].[FCPRO_MI_2_Raw_Data_tmp] i where i.ItemID in ('24.7002.0001')

select * from JDE_DB_Alan.MasterFamily m where m.Code in ('E26')

select * from JDE_DB_Alan.FCPRO_SafetyStock ss where ss.ItemNumber in('26.144.0204','26.144.0192','26.045.1803','26.144.0192')

select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('34.306.000','34.513.000') and f.DataType1 in ('adj_fc')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('34.263.0155')


------- 1/6/2020 ------
 select h.*, m.StockingType,m.FamilyGroup_,m.Family_0,m.Description
        ,concat(h.Century,h.FinancialYear) as YY
		, case when h.FinancialMonth <10 then concat(h.Century,h.FinancialYear,'0',h.FinancialMonth)
		       when h.FinancialMonth >=10 then concat(h.Century,h.FinancialYear,h.FinancialMonth)
		 end as YY_MM
		 ,abs(h.Quantity) as Quantity_		 	
  --select distinct h.ItemNumber
 FROM JDE_DB_Alan.SlsHistoryHD h
		left join JDE_DB_Alan.vw_Mast m on h.ItemNumber = m.ItemNumber
  where --h.ItemNumber in ('34.215.000','34.216.000','34.230.000','34.232.000','34.233.000','34.234.000')
		--h.ItemNumber in ('27.252.000','27.253.000','27.257.000','27.258.000','27.170.135','27.170.810','27.170.661','27.170.862','27.170.879','27.170.048','27.170.785','27.171.810','27.171.661','27.171.862','27.171.879','27.171.048','27.171.785','27.175.810','27.175.661','27.175.862','27.175.879','27.175.048','27.175.785','27.176.810','27.176.661','27.176.862','27.176.879','27.176.048','27.176.785','27.174.810','27.174.661','27.174.862','27.174.879','27.174.048','27.174.785','27.160.661','27.160.862','27.160.879','27.160.882','27.160.320','27.160.785','27.161.661','27.161.862','27.161.879','27.161.882','27.161.320','27.161.785','27.162.661','27.162.862','27.162.879','27.162.882','27.162.320','27.162.785','27.163.661','27.163.862','27.163.879','27.163.882','27.163.320','27.163.785','27.164.661','27.164.862','27.164.879','27.164.882','27.164.320','27.164.785','27.165.661','27.165.862','27.165.879','27.165.882','27.165.320','27.165.785','27.166.661','27.166.862','27.166.879','27.166.882','27.166.320','27.166.785')
        h.ItemNumber in ('42.210.031')
		and h.FinancialYear >=18

  select * from [JDE_DB_Alan].[SlsHistoryAWF_HD_MT]
  select * from [JDE_DB_Alan].[SlsHistoryMT]
    select * from [JDE_DB_Alan].[SlsHistoryhd] h where h.ItemNumber in ('42.210.031')

  select * from [JDE_DB_Alan].[FCPRO_SafetyStock] ss where ss.ItemNumber in ('FT.01468.000.01','26.144.0204')
   select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h where h.ItemNumber in ('26.144.0204')

  select * from 


;with his as (
			select h.FamilyGroup,h.CYM,'Sls_' as DataType,sum(h.SalesQty) as Value_
			from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h
			group by h.FamilyGroup,h.CYM
			--order by h.FamilyGroup,h.CYM
			  )
   ,fc as (  select m.FamilyGroup_,f.FCDate2_,'Fc_' as DataType,sum(f.FC_Vol) as Value_
	         from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
			 group by m.FamilyGroup_,f.FCDate2_
			-- order by m.FamilyGroup_,f.FCDate2_
			  )
  , comb as (
               select * from his
			   union 
			   select * from fc
             )

  select * from comb c
  --where c.FamilyGroup like ('%Motor%')
  order by c.FamilyGroup,c.CYM


--------------------------------------------------------------
-----------------------------------------------

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('43.212.003','24.5403.0000','43.212.001','24.7121.0155')
select * from [hd-vm-bi-sql01].HDDW_PRD.star.d_product p
where p.item_code in ('44.011.007')

select * from JDE_DB_Alan.FCPRO_SafetyStock s where s.ItemNumber in ('82.058.913')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('82.058.913','82.058.914','82.058.915','82.058.918','82.696.913','82.696.914','82.696.915','82.696.918','82.696.919','82.696.920','82.696.921','82.696.922','82.696.923','82.696.924','82.696.925') 


select top 3 * from JDE_DB_Alan.OpenPO o
select * from JDE_DB_Alan.MasterSupplier



---------- 15/6/2020 Update Sales History Adjustment ---------------------------------------

  --- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  -- be careful when update Sales History, because sometimes spike in the past is legitmate and you want to keep it for Safety stock calculation --
  -- sometimes, you just want to remove it from history for creating good FC, but want to leave history with spike for Safetty stock calculation !!!
  -- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



/****** Script for SelectTopNRows command from SSMS  ******/

  select top 3 * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload l 
  select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload l where l.ItemNumber in ('24.7257.0952','6000130009004H')
    select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload l where l.ValidStatus in ('Y')

  select * from JDE_DB_Alan.SlsHist_Excp_FCPro_upload e order by e.Date_Updated desc, ReportDate desc, e.Index_Row_Number

   select l.ItemNumber,l.CYM,l.SalesQty,l.SalesQty_Adj,l.ValidStatus
   from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload l 
   --where l.ItemNumber in ('26.132.0204')
   where l.ItemNumber in ('6000130009004H')
    

	select   dateadd(s,-1,dateadd(d, datediff(d,0, getdate()), 0)	)

	select *
	from JDE_DB_Alan.SlsHist_Excp_FCPro_upload e
	where e.Date_Updated > dateadd(s,-1,dateadd(d, datediff(d,0, getdate()), 0)	)


	delete from JDE_DB_Alan.SlsHist_Excp_FCPro_upload 
	where Date_Updated > dateadd(s,-1,dateadd(d, datediff(d,0, getdate()), 0)	)

   update s
   set s.SalesQty_Adj = e.Value_Sls_Adj
       ,s.ValidStatus = e.ValidStatus
	--select * 
   from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload s inner join 
                   ( 
				        select * from ( select a.*,dense_rank()over(order by Date_Updated desc ) as rn
										from JDE_DB_Alan.SlsHist_Excp_FCPro_upload a ) b
						     where b.rn = 1 
					) e

			on s.ItemNumber = e.ItemNumber and s.CYM = e.Date
     where  e.ValidStatus = 'Y'
		    -- and s.ItemNumber ='26.132.0204'


SELECT *
  FROM [JDE_DB_Alan].[JDE_DB_Alan].[SlsHist_AWFHDMT_FCPro_upload] h
 --where h.[ItemNumber] like ('%850531003021%')
 where h.ItemNumber in ('26.132.0204')



 ------------------------------------------------------------------------------------

   --- Update Sales History ---- if there is noise in history -- 16/10/2020 -- Using existing Sls_history_upld file rather than updating Sls_Excp_file, because next month, your provcess will pick it up first ! 16/10/2020
  
  --- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  -- be careful when update Sales History, because sometimes spike in the past is legitmate and you want to keep it for Safety stock calculation --
  -- sometimes, you just want to remove it from history for creating good FC, but want to leave history with spike for Safetty stock calculation !!!
  -- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


 select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload l where l.ItemNumber in ('38.001.005')

 select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h
 where h.Validstatus in ('Y')

   update s
   set s.SalesQty_Adj = 2000
       ,s.ValidStatus = 'Y'	
   from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload s 
                  
     where  s.ItemNumber = '38.001.005'
		    and s.CYM in ( '201810','201811')
			


select * from JDE_DB_Alan.SlsHist_Excp_FCPro_upload order by Date_Updated desc
select * from jde


--- 2/12/2020 ---

select f.*,m.Description,m.PlannerNumber,m.UOM,m.Owner_,m.SupplierName,m.FamilyGroup
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
 where  f.ItemNumber in
		('26.800.659','26.800.820','26.800.830','26.800.962','26.800.963','26.801.820','26.801.962','26.801.963','26.802.659','26.802.820','26.802.830','26.802.962','26.802.963','26.810.659','26.810.820','26.810.830','26.810.962','26.810.963','26.811.820','26.811.962','26.811.963','26.803.659','26.803.820','26.803.830','26.803.962','26.803.963','26.803.971')
		--('18.010.035','18.010.036','18.607.016','18.615.007','24.5418.0000','24.7102.7052A','24.7120.0952','24.7121.0952','24.7122.0952','24.7123.0952A','24.7124.0952','24.7127.0952','24.7128.0952','24.7129.0952','24.7134.0952A','24.7200.0001','24.7201.0000','24.7202.0000','24.7203.0000','24.7206.0000','24.7220.0952','32.379.200','32.380.002','32.455.155','32.501.000','43.525.105','43.530.105','82.696.931')
		--('26.800.676','26.800.833','26.800.971','26.801.676','26.802.676','26.802.833','26.802.971','26.803.676','26.803.833','26.810.676','26.810.833','26.810.971','26.811.676')		
		and f.FCDate2_ < 202202


select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('18.607.016','24.7102.0199','24.7120.0155','24.7123.0155A','24.7128.0155','24.7129.0155','24.7133.0155A','24.7136.0155A','24.7201.0000','24.7220.0952','32.379.200','32.380.002','32.455.155','32.501.000','34.080.000','82.691.931','82.696.931','FT.01391.000.00')


select * from JDE_DB_Alan.vw_Mast m													-- 48,762
select * from JDE_DB_Alan.vw_Mast m where m.PrimarySupplier not in ('506196')		-- 32,926
select * from JDE_DB_Alan.vw_Mast m where m.PrimarySupplier  in ('506196')			-- 13,486 +35,276 = 48,762
select * from JDE_DB_Alan.vw_Mast m where m.PrimarySupplier is null					-- 2,350 ;  32,926 +2350 = 35,276


with a as ( select * from JDE_DB_Alan.vw_Mast m)
     ,b as (  select * from JDE_DB_Alan.vw_Mast m where m.PrimarySupplier  in ('506196') )

	,Vlid as 
	( 
	  select * from a except select * from b
	 )
 select * from Vlid
 -------------------------------------------------------

---============================*** HD DW data warehouse query *** =================================---
---------------------------------- HD Data Warehouse Query ------------------------------------------- works !
---------- remember you have admin right in 'JDE_DB_Alan ' db, so you have control and can link to '[hd-vm-bi-sql01].HDDW_PRD' , however you cannot do reverse because you do not control data warehouse and you do not have control , unless you have admin right to set access to hdd dw. ----


select * from HDDW_PRD.star.d_region		-- does not work , need full qualification 

select * from [hd-vm-bi-sql01].HDDW_PRD.star.d_region  --- works !
o
drop table dbo.test_hddw_prd

-- be careful to use this query as you are writing data to db ----
select * into test_hddw_prd from [hd-vm-bi-sql01].HDDW_PRD.star.d_region		--- table will be created under 'dbo' schema

drop table JDE_DB_Alan.test_hddw_prd_
select * into JDE_DB_Alan.test_hddw_prd_ from [hd-vm-bi-sql01].HDDW_PRD.star.d_region     --- --- table will be created under 'JDE_DB_Alan' schema


-------------------------------------------------------------------------------------------------------------------------------------------------------------------
 --- works ! Yeah ---- by sending query to linked Server ! ----
 --- Sun Solution WA --- dummy order SO ( 5623307 ) and WO ( 4709432 ) cancelled but cannot see in DW table --- see email sent to Guru 5/3/2020
;with so as

  (  select * from [hd-vm-bi-sql01].HDDW_PRD.star.f_so_detail_history h        
	union all		
	 select * from [hd-vm-bi-sql01].HDDW_PRD.star.f_so_detail_current c where not ( c.last_line_status_code = '980' and c.next_line_status_code = '999')		--- 13022  -- use this one !!		        
		)
  --select top 3 * from  so   
   select so.order_number as So_num,so.work_order_number as So_wo_num,pr.wo_number as part_wo_num,so.item_code,pr.item_code as part_code,pr.parts_description2,pr.quantity as part_SoldQty,pr.uom as part_uom,c.contact_name as customer,so.order_date           
   from so left join [hd-vm-bi-sql01].HDDW_PRD.star.f_wo_parts_list pr on so.work_order_number = pr.wo_number
           left join [hd-vm-bi-sql01].HDDW_PRD.star.d_product p on so.d_product_key = p.d_product_key 
		   left join [hd-vm-bi-sql01].HDDW_PRD.star.d_customer c on so.d_customer_key = c.d_customer_key
	where  
		so.work_order_number = '04685890'     -- works !
		-- so.order_number in ('5623307')          -- do not yield details --- order has been cancelled though in JDE



--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

---------------- Textile Work Center Query ------------------------------------------



exec JDE_DB_Alan.sp_Mismatch_Textile_RCCP null,'2021-01-02'
exec JDE_DB_Alan.sp_Mismatch_Textile_RCCP null,'2021-02-02'
exec JDE_DB_Alan.sp_Mismatch_Textile_RCCP null,'2021-03-02'
exec JDE_DB_Alan.sp_Mismatch_Textile_RCCP null,'2021-04-02'				--- Run @19/5/2020
exec JDE_DB_Alan.sp_Mismatch_Textile_RCCP null,'2021-05-02'				--- Run @15/6/2020
exec JDE_DB_Alan.sp_Mismatch_Textile_RCCP null,'2021-06-02'				--- Run @14/7/2020


select * from JDE_DB_Alan.vw_Mast m where m.WC <>0
select * from JDE_DB_Alan.vw_Mast m where m.wc <> '0' and m.StockingType in ('O','U') 
select * from JDE_DB_Alan.vw_Mast m where m.wc <> '0' and m.StockingType not in ('O','U') and m.FamilyGroup  in ('981')


select * from JDE_DB_Alan.vw_Mast_z m where m.WC <>'0'				-- use this one to test to see if 'WC' column is showing available or not  --- it works ! the trick is use another CTE table and then select all columns ! --- 4/12/2019

select convert(varchar(7),getdate(),120) as myDate1		
select cast(SUBSTRING(REPLACE(CONVERT(char(10),getdate(),126),'-',''),1,6) as integer) as [myDate2]

select m.ItemNumber,m.Description from JDE_DB_Alan.vw_Mast m

select * from JDE_DB_Alan.vw_Mast m where m.WC <> ('No_WC_Assigned')

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('83.529.901')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('83.529.901')
select sum(m.stockvalue) as stkval from JDE_DB_Alan.vw_Mast m
select sum(m.stockvalue) as stkval from JDE_DB_Alan.Master_ML345 m

select * from JDE_DB_Alan.TextileWC w
where w.ShortItemNumber not in ( select m.ShortItemNumber from JDE_DB_Alan.vw_Mast m where m.WC <> ('No_WC_Assigned')
)


select distinct f.ItemNumber from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber like ('%46.614.%')

select * from JDE_DB_Alan.Master_ML345 m

---- Blue Pacific --- Sales query --- 2/3/2020
select * from JDE_DB_Alan.vw_Mast m 
where 
       m.Description like ('%TRNDAD C PANEL%')
		--m.Description like ('%KNGSTN PTIO C PNL%')
      and m.StockingType not in  ('O','U')
order by m.Colour


select * from JDE_DB_Alan.vw_Mast m 
where 
       m.Description like ('%Link PiVOT PIN%')
		--m.Description like ('%KNGSTN PTIO C PNL%')
      and m.StockingType not in  ('O','U')


---------------------------------------------------------------------------------------------
select * from JDE_DB_Alan.vw_Mast m where m.PlannerNumber like  ('')
select * from JDE_DB_Alan.FCPRO_SafetyStock s where s.ItemNumber in ('18.617.056')

select * from  Jde_db_alan.FCPRO_Fcst fc where fc.ItemNumber like ('%40.033.131%') and fc.Date in ('2020-06-01')


select m.ItemNumber,m.StandardCost from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('44.003.102','44.003.103','44.003.104','44.003.105','44.003.106','44.003.107','44.003.108','44.003.109','44.003.110','44.003.111','44.003.112','44.003.113','44.003.114','44.004.102','44.004.103','44.004.104','44.004.105','44.004.106','44.004.107','44.004.108','44.004.109','44.004.110','44.004.111','44.004.112','44.004.113','44.004.114','44.004.115','44.004.116','44.004.117','44.004.118','44.005.102','44.005.104','44.005.109','44.005.110','44.005.111')

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber like ('25.0%') order by SUBSTRING(m.Itemnumber,5,2)
select * from JDE_DB_Alan.SO_Inquiry_Super 
select * from JDE_DB_Alan.TextileFC
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('82.600.902CL','82.600.903CL','82.600.904CL','82.600.905CL','82.600.906CL','82.600.907CL','82.600.908CL','82.601.901CL','82.601.902CL','82.601.903CL','82.601.905CL','82.601.906CL','82.601.907CL','82.601.908CL','82.602.901CL','82.602.902CL','82.602.903CL','82.602.905CL','82.602.906CL','82.602.907CL','82.602.908CL') order by ItemNumber
select * from JDE_DB_Alan.Master_ML345 m where m.ShortItemNumber in ('34.480.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('2801640785','2801687785')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('2801640862','2801687862')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('2801462000','2801463000','2780066000','2780067000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('43.212.001','43.212.002','43.212.003','43.212.004')
select * from JDE_DB_Alan.Master_ML345 m where m.ShortItemNumber in ('1377977','1379753','1379770','1379788')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('0850525000707','0850525003020','085052500M178','0850525003061','0850525000222','0850525000207','0850525000220','2801471000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('34.513.000','34.514.000','34.515.000','34.516.000','34.517.000','34.518.000','34.519.000','34.520.000','34.521.000','34.522.000','34.523.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('XQ4PV426HD','XQ4PV414HD','XS4PV330HD','XS4PV620HD','XQ4PV914HD','XS5PV530HD','XQ5PV626HD','XQ5PV926HD','XQ5PV1530HD','XQ5PV2017HD','XQ5PV3017HD','XQ5PV4017HD','XQ4PV430HD','XQ4PV334HD','XS4PV624HD','XQ4PV915HD','XS5PV525HD','XQ5PV634HD','XQ5PV934HD','XQ5PV1234HD','XQ5PV2521HD','XQ5PV3521HD','XQ5PV4016HD')
select * from JDE_DB_Alan.Master_ML345 m where m.PrimarySupplier in ('1239','2037359')
select * from JDE_DB_Alan.Master_ML345 m where m.Description like ('%stealth%')
select * from JDE_DB_Alan.Master_ML345 m where m.Description like ('%Willandra%') and m.Description like ('%linnet%')
select * from JDE_DB_Alan.Master_ML345 m where m.Description like ('%screen%')
select * from JDE_DB_Alan.Master_ML345 m where m.Description like ('%elli%') and m.Description like ('%rail%')
select * from JDE_DB_Alan.vw_Mast m where m.FamilyGroup_ like ('%910%')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('4199030822')
select * from JDE_DB_Alan.Master_ML345 m where m.Description like ('%Eco%') and m.Description like ('%3[%]%') and m.Description like ('%plan%')
select * from JDE_DB_Alan.Master_ML345 m where m.Description like ('%3[%]%')
select m.ItemNumber,m.ShortItemNumber,m.PlannerNumber,m.FamilyGroup,m.Description,m.Family_0,m.StandardCost 
from JDE_DB_Alan.vw_Mast m where m.Description like ('%3[%]%') and m.FamilyGroup in ('986') and m.StockingType not in ('o','u','k')

select m.ItemNumber,m.ShortItemNumber,m.PlannerNumber,m.FamilyGroup,m.Description,m.Family_0,m.StandardCost,m.Colour
from JDE_DB_Alan.vw_Mast m 
where m.Family_0 like ('%635%') and m.StockingType not in ('o','u','k')


select m.ItemNumber,m.ShortItemNumber,m.PlannerNumber,m.FamilyGroup,m.Description,m.Family_0,m.StandardCost,m.Colour,m
from JDE_DB_Alan.vw_Mast m 
where m.FamilyGroup in ('983') and m.StockingType not in ('o','u')
order by m.family_0




select * from JDE_DB_Alan.MasterFamily m

select * from JDE_DB_Alan.vw_SO_Inquiry_Super sh
select * from JDE_DB_Alan.FCPRO_NP_tmp n
where n.ItemNumber in ('38.005.001')

select * from JDE_DB_Alan.vw_FC f where f.ItemNumber in ('38.005.001')
select * from JDE_DB_Alan.FCPRO_Fcst f
where f.ItemNumber in ('38.005.001') order by f.DataType1

select * from JDE_DB_Alan.vw_Mast f where f.ItemNumber in ('2801499661')



select * from JDE_DB_Alan.FCPRO_MI_2_tmp m
where m.ItemNumber in ('38.005.001')


select * from JDE_DB_Alan.vw_Mast m 
where m.ItemNumber in ('38.013.006')

select * from JDE_DB_Alan.vw_FC f where f.ItemNumber in ('34.306.000')


--select f.ItemNumber,f.FCDate2_,f.FC_Vol,m.Description,m.Family,m.FamilyGroup
select f.*,m.Description,m.Family,m.FamilyGroup
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.Family in ('VE1','VE2')


select * from JDE_DB_Alan.vw_Mast m where m.SupplierName like ('Qmot%')
select f.*,m.Description,m.Family,m.FamilyGroup,m.SupplierName,m.PrimarySupplier,m.StandardCost,f.FC_Vol * m.StandardCost as  Stk_Amt,m.QtyOnHand
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.PrimarySupplier in ('1167')



select f.*,m.Description,m.Family,m.FamilyGroup,m.SupplierName,m.PrimarySupplier,m.StandardCost,f.FC_Vol * m.StandardCost as  Stk_Amt,m.QtyOnHand
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
     
where m.PrimarySupplier in ('1102')
----where m.PrimarySupplier in ('1167')



----- Forecast for 1102 - Qmotion -----
select * from JDE_DB_Alan.vw_FC f where f.ItemNumber in ('34.306.000')
select * from JDE_DB_Alan.Master_Vendor_Item_CrossRef v where v.ItemNumber in ('34.306.000')
select * from JDE_DB_Alan.vw_Mast_Vendor_Item_CrossRef v where v.ItemNumber in ('34.306.000')

select f.*,m.Description,m.UOM,m.PrimarySupplier
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
     left join JDE_DB_Alan.vw_Mast_Vendor_Item_CrossRef v on f.ItemNumber = v.ItemNumber    
where m.PrimarySupplier in ('1102')
     -- and f.ItemNumber in ('34.363.000')


----- Forecast for 1102 - Qmotion ----- one month old

select a.ItemNumber as HD_Item_Number,v.Customer_Supplier_ItemNumber as Qmotion_Item_Number,m.Description,m.UOM
       ,a.myDate2 as FC_Date,a.FC_Vol as FC_Quantity,a.ReportDate,m.PrimarySupplier,m.PlannerNumber,m.Owner_
from  (

					select fh.*,fh.myDate1 as FCDate_
						 from JDE_DB_Alan.vw_FC_Hist fh												-- Need to Get Last month Saved FC data -- 14/9/2018
						 where fh.myReportDate2 = cast(SUBSTRING(REPLACE(CONVERT(char(10),DATEADD(mm, DATEDIFF(m,0,GETDATE())-1,0),126),'-',''),1,6) as integer)	
							   and	fh.Date	> DATEADD(mm, DATEDIFF(m,0,GETDATE())-1,0) 		-- since using last month data, so need to push out fc 1 month --- 6/12/2018
						       and fh.Date  <  DATEADD(mm, DATEDIFF(m,0,GETDATE())+12,0) 	-- only provide 12 month fc, but need to add 1 since you push out 1 month7/10/2020
							 
							 --and fh.ItemNumber in ('34.306.000')
           ) a left join JDE_DB_Alan.vw_Mast m on a.ItemNumber = m.ItemNumber
		   left join JDE_DB_Alan.vw_Mast_Vendor_Item_CrossRef v on a.ItemNumber = v.ItemNumber 
where m.PrimarySupplier in ('1102')
order by m.PrimarySupplier,a.ItemNumber,a.myDate2


select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('44.013.001','44.014.001')

select * from JDE_DB_Alan.TextileFC f
order by f.Reportdate desc


exec JDE_DB_Alan.sp_Z_Vendor_FC_Report'1102','M-1'
exec JDE_DB_Alan.sp_Z_Vendor_FC_Report'1102','M+0'

exec JDE_DB_Alan.sp_Z_Vendor_FC_Report'20037','M-1'


select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber like ('28.%') and m.StockingType in ('P')


select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('18.607.016','24.7060.0000','24.7102.1858','24.7114.1858','24.7128.1858','24.7129.1858A','24.7136.1858A','24.7201.0000','24.7220.1858','24.7302.1858A','24.7306.1858A','24.7311.1858A','24.7326.0000','24.7327.0000','24.7355.0952A','24.7371.0005A','24.7398.1858A','32.379.200','32.380.855','32.455.855','32.501.000','34.080.000','82.201.935','82.301.935','FT.01391.000.00')

select * from JDE_DB_Alan.


------------------------------
select * from JDE_DB_Alan.vw_FC f
--where f.ItemNumber in ('34.306.000')
where f.ItemNumber in ( select m.ItemNumber from JDE_DB_Alan.vw_Mast m where m.Family in ('E22'))
      and f.FCDate2_ < 202101

select * from JDE_DB_Alan.vw_Mast m where m.Family like ('E22') order by m.ItemNumber                  --- use this one as for Qmotion some product switched to Delfin
--select * from JDE_DB_Alan.vw_Mast m where m.SupplierName like ('%QMO%') order by m.ItemNumber        -- this code will only yield Qmotion supplied product  

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('34.310.000')

--------------------------------

select * from JDE_DB_Alan.OpenPO p where p.ItemNumber in ('44.011.007')
select f.* from JDE_DB_Alan.FCPRO_MI_tmp f  where f.ItemNumber in ('82.696.901')
select f.* from JDE_DB_Alan.FCPRO_MI_2_tmp f  where f.ItemNumber in ('24.5110.7178')
select f.* from JDE_DB_Alan.FCPRO_MI_2_tmp f  where f.ItemNumber in ('82.696.901')


/****** Script for SelectTopNRows command from SSMS  ******/
SELECT t.ItemNumber
       ,count(t.DataType) as cnt
  FROM [JDE_DB_Alan].[JDE_DB_Alan].[FCPRO_MI_2_tmp] t
  group by t.ItemNumber
  
  having count(t.DataType) >10
  order by t.ItemNumber

  SELECT t.ItemID as itm ,t.*
  FROM JDE_DB_Alan.FCPRO_MI_2_Raw_Data_tmp t
  --where t.ItemNumber in ('24.7219.4460')
  where t.ItemID in ('24.7221.0952')

  select * from JDE_DB_Alan.vw_FC f where f.ItemNumber in ('24.7221.0952')

  SELECT t.ItemNumber as itm ,t.*
  FROM [JDE_DB_Alan].[JDE_DB_Alan].[FCPRO_MI_2_tmp] t
  --where t.ItemNumber in ('24.7219.4460')
  where t.ItemNumber in ('24.7221.0952')


    SELECT t.ItemNumber as itm,t.*
  FROM [JDE_DB_Alan].[JDE_DB_Alan].[FCPRO_MI_2_tmp] t
  where t.ItemNumber in ('24.7219.4460')
 -- where t.ItemNumber in ('24.7221.0952')


 select * from JDE_DB_Alan.vw_Mast m where m.SupplierName like ('%hand%')

 ---------------------------------------------------------------------------------------

 --- 11/4/2022 ---

select f.ItemNumber,f.FC_Vol,f.FCDate2_,m.Description,m.StandardCost,UOM,m.SupplierName,m.Owner_
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where f.ItemNumber in ('42.652.000','46.421.000','46.508.500','46.508.700','46.531.500','46.531.700','7137040000','7370250182','7370250914','7370300182','7370300914','7370350182','7370350914','7370400001','7370400182','7370400914','7441500001B','7441500182B','7441500914B','7441700001B','7441700182B','7441700914B','7442700000','7442700001','7442700182','7442700914','7456500182','7457500001','7457500182','7457500914','7460500000','7460700000','7467040100','7467070100','7468500001','7468500182','7468500914','7468700000','7468700001','7468700182','7468700914','7477500001','7477500182','7477500914','7477700000','7477700001','7477700182','7477700914','7478500001','7478500182','7478500914','7478700000','7478700001','7478700182','7478700914','7479500001','7479500182','7479500914','7479700000','7479700001','7479700182','7479700914','7485700000','7488500001','7488500182','7488500914','7488700000','7488700001','7488700182','7488700914','7489500001','7489500182','7489500914','7489700000','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700000','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700000','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700000','7494700001','7494700182','7494700914','7496500001','7496500182','7496500914','7496700001','7496700182','7496700914','7497700000','7497700001','7497700182','7497700914','7498700000','7498700001','7498700182','7498700914','7499700000','7499700001','7499700182','7499700914','7766050000','7766070000','7766250000','7766270000')
--where f.ItemNumber in ('52.008.104')

--where m.FamilyGroup in ('992')
--where m.PrimarySupplier in ('1102') and f.FCDate2_ <'202107'



select f.ItemNumber,f.Value,f.Date
from JDE_DB_Alan.FCPRO_Fcst f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.PrimarySupplier in ('1102') and f.Date <'202001'


select * from JDE_DB_Alan.Master_ML345 m where m.Description like ('%ellipse%')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('44.010.003','44.010.004','44.010.005','44.010.001','44.010.002','44.010.006','44.010.007','44.011.003','44.011.004','44.011.005','44.011.001','44.011.002','44.011.006','44.011.007','44.012.003','44.012.004','44.012.008','44.012.007')

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('38.004.000','38.004.000S')

select * from JDE_DB_Alan.vw_Mast m where m.


select * from JDE_DB_Alan.FCPRO_Fcst

select m.FamilyGroup,sum (case 
		when m.StockValue is null then 0 
		when m.StockValue is not null then m.StockValue
		end ) as stockdollar

  from JDE_DB_Alan.vw_Mast m
  group by m.FamilyGroup
  order by m.FamilyGroup


select * from JDE_DB_Alan.vw_Mast m where m.PrimarySupplier in ('506196')

select * from JDE_DB_Alan.vw_Mast m where m.Family in ('376')

where m.ItemNumber in ('2780034000B','2781211001')

select * from JDE_DB_Alan.Px_AWF_HD_MT_FCPro_upload p where p.ItemNumber in ('1001690')

select * from JDE_DB_Alan.vw_OpenPO p where p.ItemNumber in ('42.210.031')
select * from JDE_DB_Alan.MasterSuperssionItemList l where l.CurrentItemNumber in ('26.802.659t')


select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h
select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('52.008.850') and f.DataType1 in ('Adj_FC')

select * from JDE_DB_Alan.vw_Mast m
where m.ItemNumber in ('63328.3000.00.01','63328.3000.00.02','63328.3000.00.12','63328.3000.00.14','63328.3000.00.15','63328.3000.00.16','63328.3000.00.17','63328.3000.00.18','63328.3000.00.20','63328.3000.00.30','63328.3000.00.50','63328.3000.00.60','82336.3000.00.01','82336.3000.00.02','82336.3000.00.12','82336.3000.00.14','82336.3000.00.15','82336.3000.00.16','82336.3000.00.17','82336.3000.00.18','82336.3000.00.20','82336.3000.00.50','82336.3000.00.60','82336.3000.01.01','82336.3000.01.KB','82336.3000.02.02','82336.3000.12.12','82336.3000.16.16','82336.3000.17.17','82336.3000.18.18','82336.3000.20.20','82336.3000.30.30','82336.3000.50.50','82336.3000.50.KB','82336.3000.60.60','82336.3000.60.KB','82536.3000.00.02','82536.3000.00.12','82536.3000.00.16','82536.3000.00.17','82536.3000.00.20')


select * from JDE_DB_Alan.SlsHistoryHD hd where hd.ItemNumber in ('34.417')

select * from JDE_DB_Alan.TestWO

select * from JDE_DB_Alan.FCPRO_NP_tmp n where n.ItemNumber in ('38.013.001')
select * from JDE_DB_Alan.vw_NP_FC_Analysis n where n.ItemNumber in ('38.013.001')
select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('42.210.031')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('38.013.001','43.525.101')


;WITH n(n) AS
(
    SELECT 1
    UNION ALL
    SELECT n+1 FROM n WHERE n < 50000
)
SELECT n FROM n ORDER BY n
OPTION (MAXRECURSION 0);

---
;WITH x AS (  SELECT TOP (224) [object_id] FROM sys.all_objects )
	 ,t as ( SELECT TOP (50000) n = ROW_NUMBER() OVER (ORDER BY x.[object_id]) 
				FROM x CROSS JOIN x AS y --ORDER BY n 
				)
    ,a as ( select distinct f.ItemNumber from  JDE_DB_Alan.vw_FC f )

select a.ItemNumber,m.Description,rank()over(order by a.itemnumber ) as rnk
from  a left join JDE_DB_Alan.vw_Mast m on a.ItemNumber=m.ItemNumber 

 
select * from JDE_DB_Alan.MasterFamily fm where fm.Code like ('mc%') order by fm.Code
select * from JDE_DB_Alan.SlsHistoryHD hd where hd.ItemNumber in ('45.021.000')
select * from JDE_DB_Alan.SlsHistoryHD hd where hd.ItemNumber in ('82.391.901')
select * from JDE_DB_Alan.SlsHistoryMT mt where mt.ItemNumber in ('45.021.000')
select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h where h.ItemNumber in ('34.709.000')
select * from JDE_DB_Alan.SlsHistoryHD hd where hd.ItemNumber in ('7454010000')
select * from JDE_DB_Alan.SlsHistoryMT mt where mt.ItemNumber in ('7454010000')

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload l where l.ItemNumber in ('82.038.901')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('27.160.661')
select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('27.160.661','27.246.785')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('2780461882','34.345.000')

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload l where l.ItemNumber in ('S3000NET5300N001','46.614.500')
select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload l where l.ItemNumber in ('27.246.785')
select * from JDE_DB_Alan.SlsHistoryHD hd where hd.ItemNumber in ('34.480.000')
select * from JDE_DB_Alan.SlsHistoryMT mt where mt.ItemNumber in ('34.480.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('27.246.785')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('34.528.000')
select * from JDE_DB_Alan.FCPRO_NP_tmp np where np.ItemNumber in ('34.528.000')
select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('34.528.000') order by f.DataType1,Date
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('26.484.000','26.534.000','4171324050','4150155137')
select * from JDE_DB_Alan.Master_ML345 m where m.PrimarySupplier in ('2140857')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('24.7250.4459')
select * from JDE_DB_Alan.FCPRO_Fcst_Accuracy y order by y.Item
select * from JDE_DB_Alan.vw_Mast m 
select * from JDE_DB_Alan.vw_FC
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('82.391.909')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('24.7218.4465','32.501.000','43.211.004','32.379.200','32.380.855','18.607.016','24.7201.0000','24.7102.7052','24.7102.7052','32.455.465','24.7115.0952A','24.7114.0952A','24.7128.0952','709895','24.7353.0000A','24.7136.0155A','709901','24.7120.0952')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('82.391.912')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('24.7218.4465','32.501.000','43.211.004','32.379.200','32.380.855','18.607.016','24.7201.0000','24.7102.7052','24.7102.7052','32.455.465','24.7115.0952A','24.7114.0952A','24.7128.0952','709895','24.7353.0000A','24.7136.0155A','709901','24.7120.0952')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('34.218.000','28.617.002')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('18.010.035')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('82.513.902','82.514.901')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('18.013.089')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('32.521.1858','2780115000','34.710.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('7460700000','45.128.000','46.508.500','82.696.921')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('S3000NET5300N904')
select distinct m.StockingType from JDE_DB_Alan.Master_ML345 m 
select distinct m.UOM from JDE_DB_Alan.Master_ML345 m 
select * from JDE_DB_Alan.vw_FC f where f.ItemNumber in ('18.010.035') and f.DataType1 in ('Adj_Fc')
select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('18.010.035') and f.DataType1 in ('Adj_Fc')
select * from JDE_DB_Alan.FCPRO_MI_2_Raw_Data_tmp f where f.ItemID in ('18.010.035')
select * from JDE_DB_Alan.FCPRO_Fcst f where f.DataType1 in ('Adj_Fc')
select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload
select * from JDE_DB_Alan.Px_AWF_HD_MT_FCPro_upload
select * from JDE_DB_Alan.OpenPO
 select * from JDE_DB_Alan.vw_FC f where f.ItemNumber in ('43.295.532')
 select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h
 select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('s3000net5300n001','82.058.901','43.295.532','82.696.901','82.691.901','6431050000')
 select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('24.7250.0000','24.7250.4459','24.7251.0000','24.7399.0199','24.7399.1858','24.7400.7040','32.503.000','32.504.000','32.505.000','32.506.000','34.425.000','34.426.000','34.427.000','34.428.000','34.429.000','34.431.000','34.433.000','34.434.000','34.480.000','34.481.000','34.482.000')
 select * from JDE_DB_Alan.Px_AWF_HD_MT_FCPro_upload p where p.ItemNumber in ('27.161.810')
 select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('18.010.035','18.010.036','18.615.007','24.7102.0199','24.7127.0155','24.7128.0155','24.7129.0155A','24.7201.0000','24.7206.0000','32.379.200','18.013.089','32.380.002','32.455.155','24.5358.0000','24.7124.0155','24.7203.0000','24.7220.0199','S3000NET5300N001','82.696.901','82.696.930')
  select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('42.210.031','46.598.000',)

select p.ItemNumber,count(p.OrderNumber) as ordercnt
from JDE_DB_Alan.vw_OpenPO p
group by p.ItemNumber
order by count(p.OrderNumber) desc


 select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('0751031000202H')

select * 
from JDE_DB_Alan.FCPRO_Fcst f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where 
-- m.PrimarySupplier in ('1228')


--- Inventory probe ----------------

select * from JDE_DB_Alan.vw_Mast m where m.SupplierName like ('%lei%')

 --- WIP PO value by SKU---
SELECT o.ItemNumber,o.QuantityOrdered,m.StandardCost,o.QuantityOrdered * m.StandardCost as CostDollars
  FROM [JDE_DB_Alan].[JDE_DB_Alan].[OpenPO] o left join JDE_DB_Alan.vw_Mast m on o.ItemNumber = m.ItemNumber


  --- WIP PO value Sum --- Use this one
 SELECT sum( o.QuantityOrdered * m.StandardCost) as Total_PO_Amt
  FROM [JDE_DB_Alan].[JDE_DB_Alan].[OpenPO] o left join JDE_DB_Alan.vw_Mast m on o.ItemNumber = m.ItemNumber

  --- SOH value Sum --- 1
Select sum(case when m.QtyOnHand is null then 0 * m.StandardCost
				when m.QtyOnHand is not null then m.QtyOnHand * m.StandardCost
								end ) as SOH_Amt 
								
 from JDE_DB_Alan.vw_Mast m 
 where m.StockingType not in ('Z')
   
   --Or --- SOH value Sum --- 2       -- Use this one since 'U' stocking type there is some diff in terms of calculation
Select sum(case when m.StockValue is null then 0 
				when m.StockValue is not null then StockValue
								end ) as SOH_Amt 
								
 from JDE_DB_Alan.vw_Mast m 

   
   --- combined together ---
   ;with z as 
   (  Select sum(case when m.StockValue is null then 0 
				when m.StockValue is not null then StockValue
								end ) as SOH_Amt , 0 as PO_Amt								
     from JDE_DB_Alan.vw_Mast m 

	 union 

     SELECT 0 as SOH_Amt,sum( o.QuantityOrdered * m.StandardCost) as PO_Amt
     FROM [JDE_DB_Alan].[JDE_DB_Alan].[OpenPO] o left join JDE_DB_Alan.vw_Mast m on o.ItemNumber = m.ItemNumber

	  )
	 select z.SOH_Amt,z.PO_Amt from z



	 select 'store1' as mystore,convert(int,3) as sales
	 union 
	 select 'store1' as mystore,convert(int,5) as sales
	 union 
	 select 'store2' as mystore,convert(int,1) as sales

     select 1 
	 union 
	 select 1 
	 union 
	 select 2 


	 with a as (Select sum(case when m.StockValue is null then 0 
				when m.StockValue is not null then StockValue
								end )  as S_Amt 								
     from JDE_DB_Alan.vw_Mast m 
	   )
	 ,b as
      ( SELECT  sum( o.QuantityOrdered * m.StandardCost)  as S_Amt
        FROM [JDE_DB_Alan].[JDE_DB_Alan].[OpenPO] o left join JDE_DB_Alan.vw_Mast m on o.ItemNumber = m.ItemNumber
		  )

    select * from 


 --- Safety stock calculation --- Exception Reporting that Item has negative sales ( Credits/Returns causing issues for SS calculation ) --- Good it is working --- 6/6/2019

 select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h 
where h.CYM > 201805 and h.ItemNumber in ('26.058.104')

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h 
where h.CYM > 201805 and  h.SalesQty <0  and  h.ItemNumber in ('18.017.117','26.058.104')

-------
with z as (
		 select h.ItemNumber,sum(case when h.SalesQty <0 then 1 else 0 end ) as NegSls_Cnt
		 from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h
		 where h.CYM > 201805 and  h.SalesQty <0  ---and h.ItemNumber in ('26.058.104')
		  group by h.ItemNumber
		)
	,hist as
		 ( select h.ItemNumber,h.SalesQty,h.CYM,sum(h.SalesQty) over (partition by h.itemnumber) as ItemSlsTotal,avg(h.SalesQty) over (partition by h.itemnumber) as ItemSlsAvg
				from  JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h	
				where h.CYM > 201805		
		   )  
select * from z left join hist as h on z.ItemNumber = h.ItemNumber
where h.CYM > 201805 and  h.SalesQty <0 
order by z.NegSls_Cnt desc

select * from JDE_DB_Alan.vw_Mast_Planning a where a.Item_Number in ('42.210.031','26.529.000','7124170001','27.587.213')


select * from JDE_DB_Alan.SlsHistoryHD a where a.ItemNumber in ('82.028.901')
select * from JDE_DB_Alan.Master_V4102A a where a.Item_Number in ('82.028.901')
select * from JDE_DB_Alan.vw_Mast_Planning a where a.Item_Number in ('82.028.901')
select * from JDE_DB_Alan.vw_Mast a where a.ItemNumber in ('82.028.901')
select * from JDE_DB_Alan.TextileWC a where a.ItemNumber in ('82.028.901')
select * from JDE_DB_Alan.HD_WorkCenter a where a.ItemNumber in ('82.028.901')


select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload

---------- Textile and Metal Work center ------
--- 20/5/2021 ---
 --- Create a code to get distinct ItemNumber with WC name, note some Item might have multiple ( 2 or 3 work center associated with them ) so 
 --- need to get unique item number from 'Textile_Metal_WC' ( at the moment it is called 'Textile_WC'  table , otherwise you will have issue of geting duplicated records when you join 
 --- this table with Master_Planning table or ML_345 table or any other tables

 --- thinking of create another column to differentiate 'Textile' or 'Metal' column ?

    -- select * from JDE_DB_Alan.HD_WorkCenter a

;with t as 
    ( --select a.ItemNumber,count(a.workcenter) as WC_count from JDE_DB_Alan.TextileWC a
	    select a.ItemNumber,a.ShortItemNumber,count(a.WorkCenterCode) as WC_count from JDE_DB_Alan.HD_WorkCenter a
	  --where a.ItemNumber in ('82.028.901')
	  group by a.ItemNumber,a.ShortItemNumber

	  )
    , tb as
	(
		select a1.ItemNumber,a1.ShortItemNumber
		  ,WC_Code = STUFF
			(
			  (select '-' + cast (WorkCenterCode as varchar(100))
			       --  ,'-' + cast (WorkCenterGroup as varchar(100))
			   from JDE_DB_Alan.HD_WorkCenter a2
			   where a1.Itemnumber = a2.Itemnumber
			   for xml path('')
			   ),1,1,''

			 )
          ,WC_Group = STUFF
			(
			  (select '-' + cast (WorkCenterGroup as varchar(100))
			   from JDE_DB_Alan.HD_WorkCenter a2
			   where a1.Itemnumber = a2.Itemnumber
			   for xml path('')
			   ),1,1,''

			 )

		--from JDE_DB_Alan.TextileWC a1
		  from JDE_DB_Alan.HD_WorkCenter a1
		--where a1.ItemNumber  in ('82.028.901')
		group by a1.ItemNumber,a1.ShortItemNumber
	)

	select tb.ShortItemNumber,tb.ItemNumber,tb.WC_Code,tb.WC_Group,t.ItemNumber as Itm,t.WC_count
	       ,row_number() over(order by t.WC_count desc ) rownumber 
	from tb left join t on tb.ItemNumber = t.ItemNumber 
	--order by WC_count desc

	
SELECT Name
FROM sys.procedures
WHERE OBJECT_DEFINITION(OBJECT_ID) LIKE '%TableNameOrWhatever%'

SELECT * 
FROM   INFORMATION_SCHEMA.VIEWS 
WHERE  VIEW_DEFINITION like '%YourTableName%'

------------------------------------------------------------
SELECT Name
FROM sys.procedures
WHERE OBJECT_DEFINITION(OBJECT_ID) LIKE '%TextileWC%'

SELECT * 
FROM   INFORMATION_SCHEMA.VIEWS 
WHERE  VIEW_DEFINITION like '%TextileWC%'


----------Find where specific table or view is used in SQL Server database---------------

select schema_name(o.schema_id) + '.' + o.name as [table],
       'is used by' as ref,
       schema_name(ref_o.schema_id) + '.' + ref_o.name as [object],
       ref_o.type_desc as object_type
from sys.objects o
join sys.sql_expression_dependencies dep
     on o.object_id = dep.referenced_id
join sys.objects ref_o
     on dep.referencing_id = ref_o.object_id
where o.type in ('V', 'U')
      and schema_name(o.schema_id) = 'JDE_DB_Alan'  -- put schema name here
      and o.name = 'TextileWC'   -- put table/view name here
order by [object]

--------------------------------------------------------------------------------------------------

--- create Trigger to update Textile_Metal_WC table ---
  CREATE TRIGGER tr_sales ON sales
    AFTER INSERT
    AS
    BEGIN
      UPDATE sales
      SET created = GETDATE()
      FROM inserted
      WHERE sales.id = inserted.id;
    END
   GO



--------------------------------------------------------------------------------------------------

select * from JDE_DB_Alan.Master_ML345 a

exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2021-04-01','2022-03-01'													 --- does not work when you run first query in the morning, but it works late ?!  --- 13/4/2021
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2022-05-01','2023-04-01'	
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2022-06-01','2023-05-01'	
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2022-11-01','2023-10-01'	

exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,null,null																		 --- works
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '42.210.031,26.529.000,7124170001,27.587.213','2021-04-01','2022-03-01' 			 --- works

exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2021-10-01','2022-09-01'	


exec JDE_DB_Alan.sp_FCPro_ROP_Analysis  null,null,null
exec JDE_DB_Alan.sp_FCPro_ROP_Analysis  null,'2021-04-01','2022-03-01'
exec JDE_DB_Alan.sp_FCPro_ROP_Analysis  null,'2022-04-01','2023-03-01'
exec JDE_DB_Alan.sp_FCPro_ROP_Analysis '26.529.000,42.210.031,27.587.213', '2021-04-01','2022-03-01'			--- has to be C item and under 'ROP' category


select * from JDE_DB_Alan.vw_SafetyStock a where a.ItemNumber in ('42.129.856','27.587.213','27.587.201')						--- SS 1378, x 1.1 for 'B' ; LT extended ( 5 months,with Stdevp of 327 )
 
select * from JDE_DB_Alan.FCPRO_SafetyStock a where a.ItemNumber in ('26.529.000','26.805.000','42.129.856')				--- changed original Jde parameters in Addl System Info        22/3/2021
select * from JDE_DB_Alan.vw_SafetyStock a where a.ItemNumber in ('26.805.000') 
select * from JDE_DB_Alan.FCPRO_SafetyStock a where a.ItemNumber in ('604023820','42.210.031')	

--- get last month SS --
select * from JDE_DB_Alan.FCPRO_SafetyStock a where a.ItemNumber in ('26.529.000','42.210.031')
select * from JDE_DB_Alan.FCPRO_SafetyStock a where a.ReportDate > '2021-05-01'
delete from JDE_DB_Alan.FCPRO_SafetyStock where ReportDate > '2021-05-01'


select a.ItemNumber,a.StockingType,a.Pareto from JDE_DB_Alan.vw_Mast a where a.ItemNumber in ('7441500001','7441500182','7441500914','7441700001','7441700182','7441700914','7442700001','7442700182','7442700914','7456500182','7457500001','7457500182','7457500914','7460500000','7460700000','7468500001','7468500182','7468500914','7468700001','7468700182','7468700914','7477500001','7477500182','7477500914','7477700001','7477700182','7477700914','7478500001','7478500182','7478500914','7478700001','7478700182','7478700914','7479500001','7479500182','7479500914','7479700001','7479700182','7479700914','7485700000','7488500001','7488500182','7488500914','7488700001','7488700182','7488700914','7489500001','7489500182','7489500914','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700001','7494700182','7494700914','7497700001','7497700182','7497700914','7498700001','7498700182','7498700914','7499700001','7499700182','7499700914','7766050000','7766070000','7766250000','46.508.500','46.508.700','46.531.500','46.531.700')	
select * from JDE_DB_Alan.vw_SafetyStock a where a.ItemNumber in ('28.627.462','2950020785')	
select count(a.ItemNumber),a.ReportDate from JDE_DB_Alan.vw_SafetyStock a group by a.ReportDate
select distinct a.ReportDate from JDE_DB_Alan.FCPRO_SafetyStock a
select * from JDE_DB_Alan.FCPRO_SafetyStock a  where a.ItemNumber in ('52.008.104')



------===========================================================================================

--=========================================================
 --- Update Order Policy Or Planning Code in JDE ---
------ ROP Reset ------ 29/3/2021

--=========================================================


select a.Business_Unit,a.Stocking_Type,a.Short_Item_Number,a.Item_Number
       ,a.Order_Policy,a.Order_Policy_Description,a.Order_Policy_Value
	   ,a.Planning_Code,a.Planning_Code_Description,a.Planning_Fence_Rule,a.Planning_Fence_Rule_Description,a.Plan_Time_Fence,a.Jde_ABC_1_Sls

 from JDE_DB_Alan.vw_Mast_Planning a
 where a.FamilyGroup in ('966')
      and a.Order_Policy in ('4')	  

--where a.Item_Number in ('6610200000','6610220000','6610300000','6610940000','6611530000','6611550000','7020080000','7122950001','7122950914','7124100049','7126070914','7127620182','7127710182','7127910001','7129200001','7350250182','7370200182','7370250914','7390950914','7460500000','7460700000','7468500182','7468500914','7468700001','7468700914','7477500001','7477500182','7477500914','7477700001','7477700182','7477700914','7478500001','7478500182','7478500914','7478700001','7478700182','7478700914','7479500001','7479500182','7479500914','7479700001','7479700182','7479700914','7488500001','7488500182','7488500914','7488700001','7488700914','7489500001','7489500182','7489500914','7489700001','7493500001','7493500182','7493500914','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700001','7494700914','7497700001','7497700182','7497700914','7498700001','7498700182','7498700914','7499700001','7499700182','7499700914','7766050000','7766070000','7766270000','14.640.000','40.510.000','45.117.000','45.123.000','45.123.100','45.129.000','46.414.000','46.421.000','46.508.500','6610420000','6610520000','6610580000','6610660000','7122570001','7122570049','7122570182','7122720001','7122720049','7122720182','7122930001','7122930049','7122930182','7123070001','7123070049','7123070182','7123080001','7123080914','7124010001','7124100001','7124100182','7124170001','7126070001','7127600001','7127600182','7127600914','7127710914','7127800001','7127800182','7127800914','7127850001','7127850182','7127850914','7127860001','7127860182','7127860914','7127890001','7127890182','7127890914','7134230001','7151030001','7151030182','7151030914','7231160000','7232080001','7232080049','7232087035','7232147035','7232160001','7232187035','7232247035','7233020000','7236040000','7236080001','7236087035','7350150001','7350150182','7350150914','7350200182','7350200914','7350250914','7350300001','7370200001','7370200914','7390030182','7390030914','7390950001','7390950182','7394160182','7394160914','7394200001','7394200182','7394200914','7394250182','7394250914','7394300914','7394400914','7456500182','7457500182','7457500914','7483500182','7483700914','7488700182','7489700182','7489700914','7491500001','7491500182','7491500914','7491700001','7491700182','7491700914','7494700182','7495500001','7495500182','7495500914','7495700001','7495700182','7495700914','7742140001','7742140182','7742140914','7766030000','14.565.000','14.566.000','14.567.000','26.478.000','34.404.000','34.405.000','34.410.000','34.411.000','34.414.000','34.419.000','34.420.000','34.421.000','34.422.000','34.436.000','34.437.000','34.438.000','34.443.000','34.444.000','34.445.000','34.447.000','34.466.000','34.477.000','34.544.000','34.547.000','40.499.000','40.500.000','40.501.000','40.503.062','42.496.000','42.520.000','42.652.000','42.655.850','45.007.034','45.008.000','45.009.000','45.011.038','45.026.063','45.053.063','45.057.063','45.058.063','45.066.063','45.068.063','45.069.063','45.071.063','45.073.063','45.075.063','45.101.000','45.102.000','45.103.000','45.103.100','45.105.000','45.110.000','45.111.000','45.115.100','45.116.000','45.116.100','45.117.100','45.118.000','45.119.100','45.120.000','45.120.100','45.121.000','45.121.100','45.122.100','45.126.000','45.126.100','45.127.000','45.127.100','45.128.000','45.128.100','45.129.100','45.132.100','45.135.000','45.135.100','45.136.000','45.136.100','45.137.000','45.137.100','45.138.000','45.138.100','45.140.000','45.141.000','45.141.100','45.144.000','45.145.000','45.146.000','45.146.100','45.148.100','45.203.100','45.206.100','45.207.100','45.224.100','45.243.100','45.249.100','45.250.100','45.251.000','45.251.100','45.252.000','45.253.100','45.254.100','45.255.100','45.256.100','45.257.100','45.259.000','45.259.100','45.260.000','45.260.100','45.261.100','45.262.000','45.262.100','45.268.000','45.269.000','45.269.100','45.270.100','45.271.100','45.272.000','45.272.100','45.272.850','45.273.000','45.273.100','45.273.850','45.278.000','45.283.000','45.284.000','45.285.000','45.285.100','45.286.100','45.294.100','45.298.000','45.298.100','45.308.100','45.310.000','45.310.100','45.311.100','45.312.000','45.312.100','45.400.104','45.401.100','45.517.000','45.612.134','45.618.100','45.621.000','45.626.000','45.626.100','45.627.000','45.629.000','45.634.000','45.640.100','45.642.100','45.645.000','45.645.100','45.650.100','45.655.000','45.656.000','45.659.000','45.663.100','45.665.063','45.670.820','45.681.100','45.683.100','46.559.030')



     --- Use below for Uploaded friendly version --- Use this one ! 
select a.Business_Unit,a.Short_Item_Number,a.Item_Number
       ,a.Order_Policy,a.Order_Policy_Value
	   ,a.Planning_Code,a.Planning_Fence_Rule,a.Plan_Time_Fence
	    ,a.Jde_ABC_1_Sls 
	   ,case  when a.Jde_ABC_1_Sls is not null then a.Jde_ABC_1_Sls
		     -- else 'D'
			 -- when len(a.Jde_ABC_1_Sls) = 1  then 'D'
      		  	when len(a.Jde_ABC_1_Sls) = 0 then 'D'       
       end as Jde_ABC_1_Sls_1

	   ,len(a.Jde_ABC_1_Sls) as Charlength
	  
	   --,a.Stocking_Type,a.Order_Policy_Description,a.Planning_Code_Description,a.Planning_Fence_Rule_Description
from JDE_DB_Alan.vw_Mast_Planning a inner join j
 --where a.Item_Number in ('82.058.906','82.058.901','24.7121.0952A','26.528.030','82.038.901','82.058.909','82.038.906','82.058.904','26.804.000','82.691.901','24.7218.4462','46.610.000','82.058.903','82.058.928','52.003.032','82.058.926','82.038.903','82.038.926','24.7120.0952A','24.7121.4459A','82.058.902','24.7122.0952A','82.050.906','82.058.931','24.7128.0155','82.696.926','82.696.910','82.058.927','82.038.909','82.050.901','82.058.930','24.7125.0952A','52.018.000','82.038.927','82.058.905','82.696.933','24.7136.0155A','34.358.000','24.7128.0155A','82.058.907','24.7364.0199','52.012.000','24.7136.1858A','26.169.037','82.633.902','24.7120.4459A','82.038.928','82.696.903','82.038.931','82.696.928','82.058.932','82.696.932','24.7122.4459A','82.696.930','82.696.931','82.696.909','24.7353.0000A','82.058.911','52.002.000','82.696.906','82.050.926','82.050.928','24.7128.1858A','24.7120.0952','24.7125.4459A','82.038.932','82.038.905','82.038.904','82.038.930','82.691.910','52.013.000','82.691.903','82.058.933','82.050.903','82.050.909','82.050.910','82.696.927','1001690','24.7129.1858A','6610660000','82.050.931','82.050.905','82.058.929','82.696.904','82.038.902','82.050.907','18.019.010','82.038.907','24.7129.0155A','24.7163.0000A','46.508.700','52.010.032','82.050.902','82.038.933','4140126000','82.696.902','52.004.000','82.691.926','82.633.908','82.050.932','82.050.933','82.058.910','82.050.904','82.038.910','82.696.911','82.696.912','45.067.063','KIT9125','82.696.907','82.058.912','18.019.005','24.7128.0952A','46.508.500','82.050.927','82.050.930','46.421.000','82.691.928','18.000.003','24.7133.0155A','82.691.907','24.7123.0155A','52.000.063','46.108.063','82.038.929','82.691.931','24.7110.4459A','24.7224.0155A','82.633.909','82.038.911','24.7124.0952A','KIT9126','27.285.178','82.691.912','82.050.929','32.508.000','0850531003021H','82.696.905','52.005.000','82.691.904','4170950885','24.7398.1858A','26.741.603','82.058.908','82.633.901','82.691.933','82.050.911','82.691.911','82.633.904','14.640.000','26.154.030','82.038.908','52.014.000','82.691.927','46.521.500','34.248.000','4150951885','52.016.000','82.633.903','82.691.902','7460700000','7460500000','24.7123.1858A','52.014.104','82.050.912','24.7129.0952A','34.095.000','52.016.134','52.008.134','52.014.134','45.035.000','82.696.929','52.008.000','4170950785','52.016.850','24.7133.1858A','24.7114.0952A','27.251.985','52.021.000','52.020.000','24.7128.4459A','52.006.000','52.020.134','0770531003531H','52.009.000','52.021.134','52.029.010','82.050.908','24.7302.1858A','52.027.000','82.691.905','4150083651','82.633.906','34.247.000','52.008.104','32.507.000','4150951785','6611550000','82.691.932','52.021.104','52.016.104','82.691.909','82.691.929','52.020.104','6610220000','46.550.000','2801490785','52.007.063','4170417000','24.7124.4459A','4151334000','24.7306.1858A','4170439000','4170418000','82.633.907','7441700914','52.014.810','52.021.850','1001715','45.047.063','24.7123.0952A','6610940000','24.7355.0952A','4170440000','52.014.850','26.806.000','82.037.918','24.7371.0005A','82.696.908','6610200000','4170950651','7493700000','24.7111.0155A','82.633.905','7441500914','24.7114.4459A','6611530000','52.020.850','24.7146.0155A','24.7224.0952A','46.522.500','24.7311.1858A','18.618.049','7127910000','7441700001','7441500182','24.7129.4459A','0850531003020H','52.008.850','34.221.000','4178581000','4150951180','24.7169.0155A','7123070182','24.7168.0155A','52.016.100','6610420000','52.008.810','52.021.810','52.008.100','7124100049','2920002520','6610580000','7493500001','7441500001','6610300000','7124010001','7493500914','45.073.063','52.020.810','26.555.821','7124170001','7497700182','7493700001','52.017.850','24.7224.1858A','4152336879','1001693','7493500182','4150951651','82.691.906','52.017.000','7493700914','45.075.063','24.7133.0952A','52.017.104','7766050000','32.509.000','7499700914','52.017.134','52.014.100','7497700914','52.016.810','7766070000','7498700914','7124100182','74486','7020080000','24.7224.4459A','52.031.030','27.165.862','7493700182','24.7210.0199','7124100001','52.020.100','40.033.131','45.068.063','24.7146.1858A','40.501.000','7127950000','82.038.912','45.046.063','34.468.000','24.7115.0155A','24.7134.0155A','7478700914','7766030000','7478700001','7494500182','7766270000','31.132.176','52.014.737','45.007.034','52.022.134','7457500914','7477700001','SC.07119.000.37','7488700000','7489700000','7494700000','52.022.000','52.032.030','7499700182','7127990000','7127960000','7478700182','7122930001','45.009.000','52.022.104','7497700001','24.7210.1858','7499700001','40.503.062','52.016.737','7488500182','7499700000','7498700000','7497700000','24.7169.0952A','7488700914','24.7311.0155A','7477700914','46.410.063','24.7168.0952A','7122930049','7498700182','24.7168.1858A','26.836.000A','7494700914','7489500182','7489700914','7498700001','24.7146.0952A','52.021.737','52.021.100','82.691.930','7489500914','7127600914','46.522.700','7488500914','7477700182','52.008.737','46.414.000','7479700001','7478700000','7479700000','7477700000','4150951133','26.478.000','14.565.000','24.7115.1858A','7489500001','52.016.734','52.008.734','24.7111.1858A','24.7196.7060A','14.566.000','7488700001','82.691.908','7494500914','7468700000','7457500182','7479500182','4171325050','82.501.902','7488500001','7494500001','52.020.734','7494700001','40.510.000','52.021.734','7127900000','45.066.063','46.601.734','82.501.905','40.500.000','24.7254.1858','52.017.810','52.017.100','52.014.734','40.499.000','4171324050','24.7134.0952A','4171324060','4171325060','45.248.000','45.685.034','24.7304.1858A','46.553.063','7122930182','4171325070','52.022.850','7478500914','7390950914','31.133.838','24.7302.0199A','18.320.014','7494700182','7488700182','7442700000','7127620182','52.022.100','7127620000','7127690000','7127970000','7127910001','7477500914','6610520000','24.7254.0199','24.7133.4459A','7489700182','7478500001','7479500914','7468700001','7489700001','7479700182','7477500182','7602209491','45.110.000','31.133.176','24.7123.4459A','42.652.000','4171324070','7602209492','24.7168.4459A','7468700914','7479500001','52.022.810','52.030.000','7479700914','7478500182','7129200001','7232160001','45.058.063','45.026.063','46.556.000','34.437.000','26.854.000A','7146500000','7468500182','7390020000','7127890001','45.268.100','26.837.000A','24.7323.1858A','42.655.850','7477500001','7491700000','7491700914','32.510.000','7127800001','7468500914','45.259.100','45.655.000','24.7398.0155A','32.513.000','34.443.000','34.444.000','7127600001','7127600182','7742140182','24.7134.1858A','7127600000','7491500182','45.269.100','45.284.000','45.111.000','82.297.952','32.514.000','26.838.000A','24.7197.0000A','24.7195.0199A','24.7169.1858A','24.7316.1858A','24.7210.0952','45.011.038','7390950000','46.553.030','45.645.000','7491500914','7127850001','7456500182','7602209490','7390950182','4199150000','7127940000','7129200000','7127710000','7127700000','7126070000','7127150000','82.501.907','45.650.000','45.273.000','4150951862','4199050840','24.7304.0155A','34.471.000','34.245.000','34.421.000','7390950001','7122720001','7127800914','7127850914','52.022.737','7122720049','34.404.000','24.7193.0199A','24.7131.0000A','24.7111.4459A','24.7210.4459','24.7254.0952','45.272.000','45.285.000','4199050360','4199040840','7300137001','7742140000','7742140001','7491700182','7232187035','7742140914','7122720182','45.272.100','45.273.100','7491500001','7127860914','7236087035','24.7169.4459A','18.016.059','52.015.000','7122570001','7122570049','7122570182','7126070914','7127860182','45.243.100','45.286.100','45.260.000','45.253.100','45.018.000','4199050331','4199030331','18.016.074','24.7316.0155A','24.7344.7060A','24.7146.4459A','34.237.000','45.310.000','7233020000','34.477.000','7127850182','7127660000','7127510000','7127650000','7390930000','45.259.000','4171325080','34.365.000','7127890914','45.285.100','45.207.100','18.013.037','52.015.134','45.621.000','46.424.850','46.560.000','45.135.000','45.135.100','45.271.100','45.255.000','45.255.100','45.256.000','45.310.100','45.294.100','7127890182','34.410.000','34.411.000','34.445.000','34.099.000','18.014.008','18.016.046','14.567.000','24.7130.0000A','24.7193.1858A','24.7115.0952A','24.7254.4459','7127800182','45.298.000','7127860001','7232147035','45.203.100','34.438.000','34.547.000','7151030914','7126070001','7127710182','7134230001','7370250914','34.405.000','26.844.000A','26.846.000A','24.7134.4459A','24.7323.0155A','18.016.073','18.019.012','7232080001','45.102.000','45.308.100','45.311.100','45.298.100','45.257.100','45.254.100','45.261.100','45.262.000','45.262.100','45.270.100','45.279.000','45.141.100','45.206.100','45.251.000','45.252.000','45.137.000','45.138.000','45.140.000','45.117.000','45.128.000','45.128.100','45.129.000','45.618.100','45.620.000','45.627.000','45.612.134','45.626.000','45.401.100','7134230000','7232087035','45.205.100','45.101.000','7232080049','34.447.000','7390030000','45.136.000','7390030914','7350250182','7350250914','7350200914','7370200182','7370200914','7127710914','7370200001','45.283.000','45.278.000','45.136.100','45.138.100','45.137.100','45.141.000','45.129.100','45.123.000','45.123.100','45.126.100','45.127.000','45.127.100','45.117.100','45.120.000','45.120.100','45.251.100','45.250.100','45.249.100','45.103.000','45.116.000','45.656.000','19.009.005','19.050.503','24.7138.0155A','18.016.042','18.016.048','18.013.012','18.016.061','18.016.062','18.319.005','45.119.000','7232247035','18.016.064','7350300001','7390030182','18.016.063','7350150001','7151030182','18.013.193','18.016.051','7394250914','7394200182','7394400914','7483500182','7350150182','7350150914','7236080001','7236040000','7151030001','7231160000','7123080001','7123080914','99.999.150','SC.07119.PA510','7123070001','7123070049','52.022.734','52.017.734','52.015.734','52.015.737','52.015.810','52.015.850','52.015.100','7483700914','7394200914','7394250182','7394160182','7394160914','7394200001','7394300914','7350200182','7491700001','42.520.000','40.129.228GB','40.129.131GB','4150951320','46.559.030','45.659.000','45.626.100','45.645.100','45.665.063','45.670.820','45.640.100','45.642.100','45.517.000','45.522.000','45.681.100','45.312.000','45.312.100','45.144.000','45.121.000','45.121.100','45.122.100','45.118.000','45.132.100','45.146.000','45.146.100','45.148.100','45.103.100','45.071.063','45.057.063','45.008.000','18.616.030','24.7138.1858A','24.7192.7060A','24.7195.1858A','18.301.924','18.020.015','18.016.052','18.016.060','18.016.049','18.016.050','18.016.045','18.012.042','18.012.043','1001696','1001717','34.216.000','34.544.000','34.466.000','26.848.000A','26.849.030A','26.856.000A','26.857.000A')
where a.FamilyGroup in ('900','910','913','943','964','965','966','971','972','973','974','975')  and a.Stocking_Type in ('P','S')
	    --and len(a.Jde_ABC_1_Sls) = 0
		and a.Planning_Fence_Rule in ('S')
		 


 --where a.Item_Number in ('42.210.031','34.514.000','46.419.000')

 --where a.FamilyGroup in ('966')
   --   and a.Order_Policy in ('4')


exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2021-05-01','2022-04-01'

------======== End of Update Order Policy Or Planning Code in JDE ============================================================================




---------------- Safety stock Exception --------------------------------------------
SELECT TOP (1000) [ItemNumber]
      ,[Description]
      ,[Date]
      ,[Value_Sls_Old]
      ,[Value_Sls_Adj]
      ,[ValidStatus]
      ,[Date_Updated]
      ,[ReportDate]
      ,[Index_Row_Number]
  FROM [JDE_DB_Alan].[JDE_DB_Alan].[SlsHist_Excp_FCPro_upload] a
  --order by a.ReportDate
  where a.ReportDate > '2021-06-12'


  select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload a where a.ItemNumber in ('43.212.001','43.211.004')

  select * from JDE_DB_Alan.vw_SafetyStock a where a.ItemNumber in ('43.212.003')
  select * from [JDE_DB_Alan].[FCPRO_SafetyStock_Excp] a


  ;with _s as 
	             
				 ( select a.*
							--a.ItemNumber,a.SS_,a.SS_Adj,a.ValidStatus_Adj_Flag
				       --  ,max(a.ReportDate) over(partition by a.itemNumber) as SS_Latest_upd_date	
						--,min(a.ReportDate) over(partition by a.itemNumber) as SS_Oldest_upd_date
						--,rank() over ( partition by a.itemNumber order by a.reportdate Desc) rk_0
						--,rank() over ( partition by a.itemNumber order by a.reportdate desc) rk_1
						,rk_num_dense = dense_rank() over ( partition by a.itemNumber order by a.reportdate desc )
					  from JDE_DB_Alan.FCPRO_SafetyStock a
					  --where a.ReportDate = max(a.ReportDate)
					  --group by a.ItemNumber,a.SS_,a.SS_Adj			
					)

              ,s as ( select * from _s a where a.rk_num_dense = 1)

		
  select * from _s where _s.ItemNumber in ('42.210.031')
  order by _s.ReportDate


  	--update s
 ;set s.SS_Adj = e.SS_New
		,s.ValidStatus_Adj_Flag = e.ValidStatus
	--select * 
	from  s inner join 
			  ( 
				select * from ( select a.*
				                       ,datediff(m,min(a.Date_Updated) over(partition by a.ItemNumber order by Date_Updated),DATEADD(mm, DATEDIFF(m,0,GETDATE()),0) ) as Mth_SS_Adj_Elapsed
								       ,dense_rank()over(partition by a.Itemnumber order by Date_Updated desc ) as rn				--- use dense_rank, also use date_updated desc to pick up latest records 12/6/2020 
								from JDE_DB_Alan.FCPRO_SafetyStock_Excp a  ) b
						where b.rn = 1 
						     and b.Date_Updated > DATEADD(mm, DATEDIFF(m,0,GETDATE())-12,0)		
							 					   
					  --order by b.Date_Updated,b.ReportDate
			  ) e

			on s.ItemNumber = e.ItemNumber --and s.CYM = e.Date
		where  e.ValidStatus = 'Y'



  --- update safety stock using 'SS_Adj_jde' from 4102A table ---       17/5/2022

  select m.ItemNumber, m.SS_Adj_Jde from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('87.002.001')

  select * from JDE_DB_Alan.vw_SafetyStock a  where a.ItemNumber in ('42.210.031')
 select * from JDE_DB_Alan.FCPRO_SafetyStock a where a.ItemNumber in ('7479700914') order by a.ReportDate 
 select * from JDE_DB_Alan.FCPRO_SafetyStock a
  where a.ItemNumber in ('42.652.000','46.421.000','46.508.500','46.508.700','46.531.500','46.531.700','7137040000','7370250182','7370250914','7370300182','7370300914','7370350182','7370350914','7370400001','7370400182','7370400914','7441500001B','7441500182B','7441500914B','7441700001B','7441700182B','7441700914B','7442700000','7442700001','7442700182','7442700914','7456500182','7457500001','7457500182','7457500914','7460500000','7460700000','7467040100','7467070100','7468500001','7468500182','7468500914','7468700000','7468700001','7468700182','7468700914','7477500001','7477500182','7477500914','7477700000','7477700001','7477700182','7477700914','7478500001','7478500182','7478500914','7478700000','7478700001','7478700182','7478700914','7479500001','7479500182','7479500914','7479700000','7479700001','7479700182','7479700914','7485700000','7488500001','7488500182','7488500914','7488700000','7488700001','7488700182','7488700914','7489500001','7489500182','7489500914','7489700000','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700000','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700000','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700000','7494700001','7494700182','7494700914','7496500001','7496500182','7496500914','7496700001','7496700182','7496700914','7497700000','7497700001','7497700182','7497700914','7498700000','7498700001','7498700182','7498700914','7499700000','7499700001','7499700182','7499700914','7766050000','7766070000','7766250000','7766270000') 
  order by a.ReportDate 


 update c
 set c.SS_Adj = ( case 
		                 when c.SS_Adj < d.SS_Adj_Jde then d.SS_Adj_Jde
						 when c.SS_Adj > d.SS_Adj_Jde then
									(case 	when c.Pareto in ('A','B') then  c.SS_ *1.1
											when c.Pareto in ('C') then c.SS_ *1.15
											 end )					 
						  else c.SS_Adj
					end )											
 -- select *
  from 
			 ( select * from 
								(  select a.*,rk_num_dense = dense_rank() over ( partition by a.itemNumber order by a.reportdate desc)
									from JDE_DB_Alan.FCPRO_SafetyStock a 
									--where a.ItemNumber in ('87.001.001')	
									) b
				          where rk_num_dense = 1	
					  			
					) c				              

		      	 inner join	( select m.ItemNumber, m.SS_Adj_Jde from JDE_DB_Alan.vw_Mast m ) d  on c.ItemNumber = d.ItemNumber --and s.CYM = e.Date
 
-- where c.ItemNumber in ('87.002.001')			 
 where c.ItemNumber in ('42.652.000','46.421.000','46.508.500','46.508.700','46.531.500','46.531.700','7137040000','7370250182','7370250914','7370300182','7370300914','7370350182','7370350914','7370400001','7370400182','7370400914','7441500001B','7441500182B','7441500914B','7441700001B','7441700182B','7441700914B','7442700000','7442700001','7442700182','7442700914','7456500182','7457500001','7457500182','7457500914','7460500000','7460700000','7467040100','7467070100','7468500001','7468500182','7468500914','7468700000','7468700001','7468700182','7468700914','7477500001','7477500182','7477500914','7477700000','7477700001','7477700182','7477700914','7478500001','7478500182','7478500914','7478700000','7478700001','7478700182','7478700914','7479500001','7479500182','7479500914','7479700000','7479700001','7479700182','7479700914','7485700000','7488500001','7488500182','7488500914','7488700000','7488700001','7488700182','7488700914','7489500001','7489500182','7489500914','7489700000','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700000','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700000','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700000','7494700001','7494700182','7494700914','7496500001','7496500182','7496500914','7496700001','7496700182','7496700914','7497700000','7497700001','7497700182','7497700914','7498700000','7498700001','7498700182','7498700914','7499700000','7499700001','7499700182','7499700914','7766050000','7766070000','7766250000','7766270000')			 


 --- Reinstate original safety stock using system calculation if anything goes wrong ---
 update c
 set c.SS_Adj =  (case 	when c.Pareto in ('A','B') then  c.SS_ *1.1
						when c.Pareto in ('C') then c.SS_ *1.15
				 end )
 -- select *
  from 
			 ( select * from 
								(  select a.*,rk_num_dense = dense_rank() over ( partition by a.itemNumber order by a.reportdate desc)
									from JDE_DB_Alan.FCPRO_SafetyStock a 
									--where a.ItemNumber in ('87.001.001')	
									) b
				          where rk_num_dense = 1	
					  			
					) c				              

		     --	 inner join	( select m.ItemNumber, m.SS_Adj_Jde from JDE_DB_Alan.vw_Mast m ) d  on c.ItemNumber = d.ItemNumber --and s.CYM = e.Date
 
 where c.ItemNumber in ('7479700914','7442700182','7370400182')			 
 where c.ItemNumber in ('42.652.000','46.421.000','46.508.500','46.508.700','46.531.500','46.531.700','7137040000','7370250182','7370250914','7370300182','7370300914','7370350182','7370350914','7370400001','7370400182','7370400914','7441500001B','7441500182B','7441500914B','7441700001B','7441700182B','7441700914B','7442700000','7442700001','7442700182','7442700914','7456500182','7457500001','7457500182','7457500914','7460500000','7460700000','7467040100','7467070100','7468500001','7468500182','7468500914','7468700000','7468700001','7468700182','7468700914','7477500001','7477500182','7477500914','7477700000','7477700001','7477700182','7477700914','7478500001','7478500182','7478500914','7478700000','7478700001','7478700182','7478700914','7479500001','7479500182','7479500914','7479700000','7479700001','7479700182','7479700914','7485700000','7488500001','7488500182','7488500914','7488700000','7488700001','7488700182','7488700914','7489500001','7489500182','7489500914','7489700000','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700000','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700000','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700000','7494700001','7494700182','7494700914','7496500001','7496500182','7496500914','7496700001','7496700182','7496700914','7497700000','7497700001','7497700182','7497700914','7498700000','7498700001','7498700182','7498700914','7499700000','7499700001','7499700182','7499700914','7766050000','7766070000','7766250000','7766270000')			 


		
				
------------------------------------------------------------------------------



select m.ItemNumber,m.StockingType,m.PlannerNumber,m.SellingGroup
from JDE_DB_Alan.vw_Mast m 
where m.FamilyGroup in ('913')
      and m.StockingType not in ('O','U')
order by m.StockingType


 select distinct n.ItemNumber from JDE_DB_Alan.FCPRO_NP_tmp n
 --select * from JDE_DB_Alan.FCPRO_NP_tmp n
 where n.Comment like ('%lutron%')
       and n.CN_Number like ('%8705%')


exec JDE_DB_Alan.sp_FCPro_FC_Accy_SKU 'LT'
select top 3 * from JDE_DB_Alan.FCPRO_FC_Accy_SKU a where a.DataType in ('Units')


exec JDE_DB_Alan.sp_Cal_SafetyStock 

---- data for accuracy SKU level ---
select z.Item,z.Sales,z.Fcst,z.Bias,z.ABS_,z.ErrPct,z.AccuracyPct,z.Description,z.FamilyGroup_,z.Family_0,z.PrimarySupplier,z.PlannerNumber,z.StockingType,z.FamilyGroup,z.Family,z.Leadtime_Mth,z.LT_Type
from JDE_DB_Alan.FCPRO_FC_Accy_SKU z
where z.DataType in ('Units')
 
---- data for accuracy Family Group level ---

select f.Reportdate,COUNT(*)  from JDE_DB_Alan.FCPRO_FC_Accy_Group f group by f.Reportdate
select * from JDE_DB_Alan.FCPRO_FC_Accy_Group f where f.Reportdate > '20200429'
select * from JDE_DB_Alan.FCPRO_FC_Accy_Group f where f.Reportdate > '2020-04-29 11:00:00'
select * from JDE_DB_Alan.FCPRO_FC_Accy_Group f where f.Reportdate < '20200408'
delete from JDE_DB_Alan.FCPRO_FC_Accy_Group  where Reportdate > '20200408'
delete from JDE_DB_Alan.FCPRO_FC_Accy_Group  where Reportdate > '20200429'
delete from JDE_DB_Alan.FCPRO_FC_Accy_Group  where Reportdate > '2020-04-30 9:00:00'


select * from JDE_DB_Alan.FCPRO_FC_Accy_Group f order by f.DataType,f.Hierarchy_Cat desc,f.Reportdate

select f.Hierarchy_0,f.Sls_,f.FC_,f.Bias_,f.Abs_,f.err1,f.err2,f.err3,f.acc1,f.acc2,f.acc3,f.Reportdate
from JDE_DB_Alan.FCPRO_FC_Accy_Group f
where f.Reportdate = ( select max(a.Reportdate) from JDE_DB_Alan.FCPRO_FC_Accy_Group a )
     and f.DataType in ('Units')
	 and f.Hierarchy_Cat in ('FamilyGroup_')

---- data for accuracy Family level ---

select * from JDE_DB_Alan.FCPRO_FC_Accy_Group f

select f.Hierarchy_0,f.Sls_,f.FC_,f.Bias_,f.Abs_,f.err1,f.err2,f.err3,f.acc1,f.acc2,f.acc3,f.Reportdate
from JDE_DB_Alan.FCPRO_FC_Accy_Group f
where f.Reportdate = ( select max(a.Reportdate) from JDE_DB_Alan.FCPRO_FC_Accy_Group a )
     and f.DataType in ('Units')
	 and f.Hierarchy_Cat in ('Family_')

----------------------------
select f.Hierarchy_0,f.Sls_,f.FC_,f.Bias_,f.Abs_,f.err3,f.acc3,DATEADD(mm, DATEDIFF(m,0,GETDATE()),0) as date_ from JDE_DB_Alan.vw_FC_Accy_FamilyGroup_Rpt f
where f.Hierarchy_0 not in ('Grand_Total')



exec JDE_DB_Alan.sp_FCPro_FC_Accy_Rpt_New 'LT'
exec JDE_DB_Alan.sp_FCPro_FC_Accy_Rpt_New 'Non_LT'

exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis 'cs100','2019-08-01','2020-07-03'

exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '28.670.000','2020-10-01','2021-09-03'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2022-04-01','2023-03-03'


exec JDE_DB_Alan.sp_Mismatch_Textile_RCCP '82.036.915,82.011.908',null,'2020-08-03'
exec JDE_DB_Alan.sp_Mismatch_Textile_RCCP  null,null,'2021-01-03'				-- works ! 14/2/2020
exec JDE_DB_Alan.sp_Mismatch_Multi '42.210.031',null,'2020-08-03'


exec JDE_DB_Alan.sp_Exp_SO_Inquiry_Super_Mast 
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '2801381661,2801381862,2801381320,2801381276,2801381810,2801381324,2801382661,2801382785,2801382320,2801382810,2801382689,2801382180,2801382862,2801382048,2801382879,2801382580,2801382324,2801382276,2801382609,2801382551,2801382669,2801382496,2801406661,2801406862,2801406072,2801406276,2801406351,2801406324,2801407661,2801407862,2801407072,2801407276,2801407351,2801407324,2801389661,2801389785,2801389072,2801389351,2801389689,2801389167,2801389862,2801389048,2801389354,2801389245,2801389324,2801389276,2801389609,2801389551,2801389669,2801389095,2801390661,2801390785,2801390072,2801390351,2801390689,2801390167,2801390862,2801390048,2801390354,2801390245,2801390324,2801390276,2801390609,2801390551,2801390669,2801390095,2801385661,2801385862,2801385320,2801385276,2801385810,2801385324,2801386661,2801386785,2801386320,2801386810,2801386689,2801386180,2801386862,2801386048,2801386879,2801386580,2801386324,2801386276,2801386609,2801386551,2801386669,2801386496,2801395661,2801395862,2801395072,2801395276,2801395351,2801395324,2801396661,2801396785,2801396072,2801396351,2801396689,2801396167,2801396862,2801396048,2801396354,2801396245,2801396324,2801396276,2801396609,2801396551,2801396669,2801396095,2801404000,2801403661,2801403862,2801403072,2801403276,2801403351,2801403324,2801436661,2801436785,2801436072,2801436351,2801436689,2801436167,2801436862,2801436048,2801436354,2801436245,2801436324,2801436276,2801436609,2801436551,2801436669,2801436095,2801405661,2801405785,2801405072,2801405351,2801405689,2801405167,2801405862,2801405048,2801405354,2801405245,2801405324,2801405276,2801405609,2801405551,2801405669,2801405095,KIT2758,KIT2759,2911529661,2911529862,2911529072,2911529276,2911529351,2911529324,2911530661,2911530862,2911530072,2911530276,2911530351,2911530324,2911531661,2911531785,2911531072,2911531351,2911531689,2911531167,2911531862,2911531048,2911531354,2911531245,2911531324,2911531276,2911531609,2911531551,2911531669,2911531095,2911532661,2911532785,2911532072,2911532351,2911532689,2911532167,2911532862,2911532048,2911532354,2911532245,2911532324,2911532276,2911532609,2911532551,2911532669,2911532095,2801471000,7502000000,7502001000,7501005000,7501001000,7804000000,2801499661,2801499785,2801499072,2801499351,2801499689,2801499167,2801499862,2801499048,2801499354,2801499245,2801499324,2801499276,2801499609,2801499551,2801499669,2801499095,2801999000,2781208000,2801454000,2801350000,2801433661,2801433862,2801433072,2801433276,2801433351,2801433324,2801434661,2801434862,2801434072,2801434276,2801434351,2801434324,2801490661,2801490785,2801490072,2801490351,2801490689,2801490167,2801490862,2801490048,2801490354,2801490245,2801490324,2801490276,2801490609,2801490551,2801490669,2801490095,2801491661,2801491785,2801491072,2801491351,2801491689,2801491167,2801491862,2801491048,2801491354,2801491245,2801491324,2801491276,2801491609,2801491551,2801491669,2801491095,2851512661,2851218661,2851224661,2851230661,2851236661,2851284661,2851512785,2851218785,2851224785,2851230785,2851236785,2851284785,2851512072,2851218072,2851224072,2851230072,2851236072,2851284072,2851512351,2851218351,2851224351,2851230351,2851236351,2851284351,2851218689,2851224689,2851230689,2851236689,2851284689,2851512167,2851218167,2851224167,2851230167,2851236167,2851284167,2851512862,2851218862,2851224862,2851230862,2851236862,2851284862,2851284048,2851218354,2851224354,2851230354,2851236354,2851284354,2851218245,2851224245,2851230245,2851236245,2851284245,2851284324,2851218276,2851224276,2851230276,2851236276,2851284276,2851284609,2851218551,2851224551,2851230551,2851236551,2851284551,2851284669,2851284095','2018-10-01','2019-09-03'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '18.017.031,82.336.901,82.336.901','2019-03-01','2019-12-03'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis 'S3000NET5300N904,WS03AA-A118118,26.228.000,2982028000B,40.129.131','2019-11-01','2020-10-03'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2020-09-01','2021-08-03'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '82.058.901,43.295.532,43.207.637M,63328.3000.00.12,43.207.565M,0850531003030H,44.011.007','2019-11-01','2020-10-03'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '2991497000,45.104.000,34.480.000,34.519.000,24.7361.1858,24.7378.1858,34.710.000,34.711.000','2019-06-01','2020-03-03'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '26.528.030,26.519.030,6000130009004H,4199030822','2019-09-01','2020-08-03'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '24.7250.0000,24.7250.4459,24.7251.0000,24.7399.0199,24.7399.1858,24.7400.7040,32.503.000,32.504.000,32.505.000,32.506.000,34.425.000,34.426.000,34.427.000,34.428.000,34.429.000,34.431.000,34.433.000,34.434.000,34.480.000,34.481.000,34.482.000','2019-05-01','2020-04-03'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis 'S3000NET5250N001,S3000NET5250N002,S3000NET5250N003,S3000NET5250N010,S3000NET5250N012,S3000NET5250N025,S3000NET5250N301,S3000NET5250N901,S3000NET5250N903,S3000NET5250N904,S3000NET5300N001,S3000NET5300N002,S3000NET5300N003,S3000NET5300N010,S3000NET5300N012,S3000NET5300N025,S3000NET5300N301,S3000NET5300N901,S3000NET5300N902,S3000NET5300N903,S3000NET5300N904','2019-09-01','2020-08-03'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '2780142000B,2780157000B,4199020000,4199070000,82.081.901,28.602.000','2019-12-01','2020-11-03'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '34.263.0155,34.264.0155,34.265.0155,34.266.0000,34.267.0155,34.268.0000,34.269.0000,34.270.0000,34.271.0300,34.272.0155,34.273.0155,34.274.0155,34.275.0155,34.276.0000,34.277.0155,34.278.0300,34.279.0300,34.280.0300,34.281.0155,34.283.0300,34.284.0300,34.285.0155','2020-10-01','2021-09-03'


exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '31.001.131,31.001.952,31.002.131,31.002.952,31.003.131,31.003.952,31.004.131,31.004.952,31.005.063,31.006.063,31.034.000,31.035.000,31.008.952,31.009.952,31.010.030,31.010.131,31.011.030,31.011.131,31.012.030,31.012.131,31.013.131,31.013.133,31.014.131,31.014.133,31.015.131,31.015.133,31.016.131,31.016.133,31.017.133,31.018.133,31.019.131,31.019.133,31.020.131,31.020.133,31.021.133,31.022.133,31.023.131,31.023.133,31.024.131,31.024.133,31.025.131,31.025.133,31.026.131,31.026.133,31.027.131,31.027.133,31.028.131,31.028.133,31.029.131,31.029.952,31.030.131,31.030.133,31.031.952,31.032.131,31.032.952,31.033.131,31.033.952','2019-07-01','2020-06-03'

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('31.010.030','31.005.063')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('31.010.030','31.005.063')

exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis 'S3000NET5250N001,S3000NET5250N002,S3000NET5250N003,S3000NET5250N010,S3000NET5250N012,S3000NET5250N025,S3000NET5250N301,S3000NET5250N901,S3000NET5250N903,S3000NET5250N904,S3000NET5300N001,S3000NET5300N002,S3000NET5300N003,S3000NET5300N010,S3000NET5300N012,S3000NET5300N025,S3000NET5300N301,S3000NET5300N901,S3000NET5300N902,S3000NET5300N903,S3000NET5300N904','2019-09-01','2020-08-03'

exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde_AdHoc '38.013.001,38.013.002'

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload u 
where u.SalesQty_Adj = 600 and u.CYM = 202007
order by u.FamilyGroup

select * from JDE_DB_Alan.vw_FC f where f.ItemNumber in ('4152336785B')     --- tension body  -- Duette

 -------------    Sales & FC Discrepancy ------------------------
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2019-02-01','2020-01-03','rnk'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2019-01-01','2019-06-03','Ratio_Sls_FC'

select * from JDE_DB_Alan.vw_NP_FC_Analysis a
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('24.7363.0199','24.7364.0199','24.7363.1858','24.7364.1858')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('82.691.930','43.525.101')
select * from JDE_DB_Alan.Master_ML345

select * from JDE_DB_Alan.MasterFamily a


exec JDE_DB_Alan.sp_MI_2_Raw_Combine_Sim_Mismatch_1mOff '6610350000','2019-06-03'
exec JDE_DB_Alan.sp_MI_2_Raw_Combine_Sim_Mismatch_1mOff '46.005.000,46.012.000,46.011.000,46.606.000,46.607.000,46.608.000','2020-06-03'


select * from JDE_DB_Alan.Px_AWF_HD_MT_FCPro_upload p where p.Family is null
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('05.980.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('7520065000','43.216.001','2780144451','43.216.002','2780145451','43.216.003','4152336450','43.216.004','2780144680','45.133.000','45.134.100','45.133.100','2780145680')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('24.7129.0155A')
select * from JDE_DB_Alan.vw_Mast m where m.Family in ('635') 
select * from JDE_DB_Alan.vw_Mast m where m.FamilyGroup in ('964')  and m.StockingType in ('P','S')
select * from JDE_DB_Alan.vw_Mast m where m.Family in ('89J','89K','89L') 
select distinct m.ItemNumber from JDE_DB_Alan.vw_Mast m where m.FamilyGroup in ('965')  and m.StockingType in ('P','S')

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload p where p.ItemNumber in ('28.672.000')


---------------- PO All --------------- 25/2/2021

select * from JDE_DB_Alan.PO_All 

select * from JDE_DB_Alan.PO_All p where p.Item_Number in ('34.223.000*OP100','7390060182')				-- 7390060182 standard lead time is 105 days however actual shipment takes from 94 ( by air ?? ) - 141 days, how much you need to stretch ? maxium ? or Average ? 
select * from JDE_DB_Alan.PO_All p where p.Order_Number in ('511999')              --- this order has air freight line in it
select * from JDE_DB_Alan.PO_All p where p.Order_Number in ('515133')				-- comma delimit issue ( 1,033.20 )

select * from JDE_DB_Alan.PO_All p where p.Address_Number in ('1228')

select p.Item_Number,p.Order_Number,p.Quantity_Ordered,p.Order_Date,p.Actual_Ship_Date,p.Descrip,p.UM from JDE_DB_Alan.PO_All_Staging p where p.Item_Number in ('34.223.000*OP100')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('7390060182','24.7219.0952')

-- supplier which has most spending dollars with, their supplier DIFOT change ( graphy ) over last 12 month ( how good or how bad they are );is it only US or global - what is total picture look like; supplier DIFOT by planner, 
--- what is maximum delay you can see ? what category has been impacted most ? how about margin impact ?
-- what is conclusion and recommendations going forward ? Tier 1 / Tier 2 supplier ; also is it a fact that we are paying air freifght only for volumes exceeding our normal yearly FC ? so that means even if we are incurring high amount of
--- air freight cost, we are getting more sales and profits albeit at a bit of cost
--- For any PO which past due date - you can design exception report


select * 
from JDE_DB_Alan.PO_All

 ----- old, no need use 'View' ------
;with p as
  ( 	select p.Short_Item_No,p.Item_Number,p.Or_Ty,p.Order_Number,p.Order_Date,p.Actual_Ship_Date,p.Shipment_Number,p.Quantity_Ordered,p.Quantity_Open
              ,p.Address_Number as Vendor_,p.Buyer_Number,p.Unit_Cost,p.Extended_Price,p.Next_Stat,p.Last_Stat,m.LeadtimeLevel
		from JDE_DB_Alan.PO_All p left join JDE_DB_Alan.vw_Mast m on p.Item_Number = m.ItemNumber
		where p.Item_Number in ('7390060182','24.7219.0952')
	)

select * from p
--where p.Order_Date > '2020-06-01'


select * from JDE_DB_Alan.vw_Mast_Planning m where m.Item_Number in ( '7457500182','7456500182','42.210.031')

select * from JDE_DB_Alan.vw_Mast a where a.ItemNumber like ('25%') order by a.FamilyGroup_

select * from JDE_DB_Alan.FCPRO_SafetyStock a where a.ItemNumber in ('42.210.031')
select * from JDE_DB_Alan.vw_SafetyStock a where a.ItemNumber in ('42.210.031')

select a.ItemNumber,a.SS_Adj,max(a.ReportDate)
from JDE_DB_Alan.FCPRO_SafetyStock a
--where a.ReportDate = max(a.ReportDate)
group by a.ItemNumber,a.SS_Adj


select * from JDE_DB_Alan.MasterFamily a where a.Code like ('H58%')
select distinct f.DataType1 from JDE_DB_Alan.vw_FC f
select * from JDE_DB_Alan.vw_FC f


select * from JDE_DB_Alan.vw_Mast_Planning p where p.Item_Number in ('42.210.031')
select * from JDE_DB_Alan.Master_V4102A p where p.Item_Number in ('42.210.031')
select distinct p.ABC_1_Sls from JDE_DB_Alan.Master_V4102A p where p.Item_Number in ('42.210.031')

select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('42.210.031')

select * from JDE_DB_Alan.vw_SafetyStock m where m.ItemNumber in ('42.210.031')
select distinct m.ReportDate from JDE_DB_Alan.vw_SafetyStock m where m.ItemNumber in ('42.210.031')

  ---===================================================
  ----- Delivery lead time analysis for Safety stock ---- 8/3/2021
  ---========================================================

  --- Use 'View ' --- Simple
  --- Note that this view 'vw_PO_All' has built  in Delivery Lead Time - DLT analysis for assessment of demonstrated lead time using 
  --- All PO history without the need to ask Planner to confirm actual lead time with their Vendors... , 08/03/2021, 3/10/2021


 select * from JDE_DB_Alan.vw_PO_All p where p.Item_Number in ('7457500182','7390060182','24.7219.0952')

;with p as ( 
		select 
			   max(LT_Diff) over(partition by p.item_number) as Max_Gap_day	
			  ,min(LT_Diff) over(partition by p.item_number) as Min_Gap_day	
			  ,rank() over ( partition by p.item_number order by order_number) rk_1
			  ,dense_rank() over ( partition by p.item_number order by order_number) rk_2
			  ,count(Order_Number) over( partition by p.item_number) as Orde_Count
			  ,avg(Actual_Ship_LT_Days) over( partition by p.item_number) as Average_Ship_Days
				,p.*
		      --,p.LT_Diff

		from JDE_DB_Alan.vw_PO_All p
		where p.Item_Number in ('7390060182','24.7219.0952')
		  )

select p.* 
from p
where  p.Order_Date > DATEADD(mm, DATEDIFF(m,0,GETDATE())-11,0)
--order by p.Item_Number,p.LT_Diff desc
order by p.Item_Number,p.rk_1

select distinct p.Item_Number from JDE_DB_Alan.vw_PO_All p

select * from JDE_DB_Alan.vw_OpenPO
select * from JDE_DB_Alan.vw_PO_All								--- Note that this view 'vw_PO_All' has built  in Delivery Lead Time - DLT analysis for assessment of demonstrated lead time using All PO history without the need to ask Planner to confirm actual lead time with their Vendors... , 08/03/2021, 3/10/2021
select * from JDE_DB_Alan.Master_V4102A
select * from JDE_DB_Alan.vw_Mast

--------------------------- xxxxxxxx ----------------------------------------


select schema_name(o.schema_id) + '.' + o.name as [table],
       'is used by' as ref,
       schema_name(ref_o.schema_id) + '.' + ref_o.name as [object],
       ref_o.type_desc as object_type
from sys.objects o
join sys.sql_expression_dependencies dep
     on o.object_id = dep.referenced_id
join sys.objects ref_o
     on dep.referencing_id = ref_o.object_id
where o.type in ('V', 'U')
      and schema_name(o.schema_id) = 'JDE_DB_Alan'  -- put schema name here
      and o.name = 'vw_NP_FC_Analysis'   -- put table/view name here
order by [object]



select * from JDE_DB_Alan.FCPRO_Fcst f  where f.ItemNumber in ('18.010.035') and f.DataType1 in ('adj_fc')

select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('s3000net5250n001')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('2801748000','2801749000','2801482000','2801483000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('34.345.000','34.346.000','34.347.000','34.348.000','34.349.000','34.350.000','34.351.000','34.359.000','34.360.000','34.361.000','34.370.000','34.449.000','34.451.000','34.452.000')
select * from JDE_DB_Alan.SlsHistoryHD hd where hd.ItemNumber in ('34.345.000','34.346.000','34.347.000','34.348.000','34.349.000','34.350.000','34.351.000','34.359.000','34.360.000','34.361.000','34.370.000','34.449.000','34.451.000','34.452.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('18.017.154')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('4150249103')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('34.429.000','34.460.000','34.474.000','34.475.000','34.476.000','34.478.000')
select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload l where l.ItemNumber in ('KIT9125')
select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload l where l.ItemNumber in ('18.013.089','18.009.029')
select * from JDE_DB_Alan.Px_AWF_HD_MT_FCPro_upload l where l.ItemNumber in ('18.013.089','18.009.029')
select distinct l.ItemNumber from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload l
select distinct l.ItemNumber from JDE_DB_Alan.Px_AWF_HD_MT_FCPro_upload l
select * from JDE_DB_Alan.FCPRO_SafetyStock s where s.ItemNumber in ('7501001000')
select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h where h.ItemNumber in ('7501001000')
select * from JDE_DB_Alan.FCPRO_SafetyStock
select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('38.001.001') and f.DataType1 like ('Adj%')
select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber like ('XEC%')

select * from JDE_DB_Alan.vw_Mast m where m.FamilyGroup in ('989') and m.StockingType not in ('O','U') and m.ItemNumber in ('44.015.405')


exec JDE_DB_Alan.sp_FCPro_FC_Sales_Analysis null,null,null
exec JDE_DB_Alan.sp_FCPro_FC_Accy_Data 
exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde null,'82.633.901,82.633.908,82.633.909,38.001.001,38.003.001,38.004.000,38.001.002,38.001.003,38.001.004,38.001.005,38.001.006,38.002.001,38.002.002,38.002.003,38.002.004,38.002.005,38.002.006,38.003.002,38.003.003,38.003.004,38.003.005,38.003.006','Adj_FC'

select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('P4H108A547')

select  f.ItemID as ItemNumber,f.Date, f.Value
		                from JDE_DB_Alan.FCPRO_MI_2_Raw_Data_tmp f
						where  f.ItemID in ('32.501.000')
select * from JDE_DB_Alan.FCPRO_MI_2_Raw_Data_tmp l order by l.ItemID


select * from JDE_DB_Alan.FCPRO_Fcst_Accuracy a order by a.DataType,a.Item,a.Date_
select * from JDE_DB_Alan.FCPRO_Fcst_Accuracy a where a.Item in ('42.210.031') order by a.Item,a.Date_
select distinct a.ReportDate from JDE_DB_Alan.FCPRO_Fcst_Accuracy a
select * from JDE_DB_Alan.FCPRO_Fcst_History h where h.ItemNumber in ('42.210.031') and h.ReportDate > '2018-09-02' 
order by h.Date

select * 
 from JDE_DB_Alan.FCPRO_NP_tmp np
--from JDE_DB_Alan.vw_NP_FC_Analysis np
where np.ItemNumber in ('4600000230')


select * from JDE_DB_Alan.vw_FC

--select * from JDE_DB_Alan.FCPRO_MI_2_Raw_Data_tmp t order by t.ItemID
--select * from JDE_DB_Alan.FCPRO_MI_2_Raw_Data_tmp t where t.ItemID in ('18.013.089','18.009.029')
--insert into JDE_DB_Alan.FCPRO_MI_2_Raw_Data_tmp values ('18.009.029','2018-10-01',15,'test','test','test','test','2018-08-16','Y','test','2018-08-16')
--delete from JDE_DB_Alan.FCPRO_MI_2_Raw_Data_tmp  where ItemID in ('18.009.029')


select * from JDE_DB_Alan.FCPRO_MI_2_tmp t order by t.ItemNumber
select * from JDE_DB_Alan.FCPRO_MI_2_tmp t order by t.ItemNumber
select * from JDE_DB_Alan.FCPRO_MI_2_tmp t where t.ItemNumber in  ('18.013.089','18.009.029') order by t.ItemNumber
--insert into JDE_DB_Alan.FCPRO_MI_2_tmp values ('18.009.029','2018-10-01',15,'Market Intelligence_2','test','test','test','2018-08-16','Y','test','2018-08-16')
--delete from JDE_DB_Alan.FCPRO_MI_2_tmp  where ItemNumber in ('18.009.029')
select * from JDE_DB_Alan.FCPRO_MI_2_tmp t where ItemNumber in ('24.7218.4462')


select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('43.207.536M')
select * from JDE_DB_Alan.Master_ML345 m where m.Description like ('%lina%')
select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h where h.ItemNumber in ('6001130009009H')
select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('38.001.001')

select h.*,m.Colour,m.Description from JDE_DB_Alan.SlsHistoryHD h
                     left join JDE_DB_Alan.vw_Mast m on h.ShortItemNumber = m.ShortItemNumber
 where h.ItemNumber in ('26.353.000','26.353.131','26.353.133','26.353.256','26.353.737','26.353.688','26.353.746')


select * from JDE_DB_Alan.FCPRO_MI_2_Raw_Data_tmp t where t.ItemID in ('18.010.035')

select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('34.247.000')

select * from JDE_DB_Alan.MasterFamily a 

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload a

select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('38.001.001','38.003.001','38.004.000','38.001.002','38.001.003','38.001.004','38.001.005','38.001.006','38.002.001','38.002.002','38.002.003','38.002.004','38.002.005','38.002.006','38.003.002','38.003.003','38.003.004','38.003.005','38.003.006')
 order by m.ItemNumber
 
 select * 
 from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('42.421.855','46.019.000','46.019.063','46.002.000','46.002.063','9761001','9707027','42.180.049','42.603.855','44.209.000','44.210.000','46.504.000','46.505.000','46.506.000','46.507.000','46.614.700','46.614.500','42.204.000','42.230.000','42.236.000','46.203.000','46.524.000','46.510.000','46.011.000','46.011.100','46.011.134','46.011.734','46.011.737','46.011.810','46.011.850','46.602.000','46.602.100','46.602.134','46.602.734','46.602.737','46.602.810','46.011.850','46.021.000','46.517.000','46.005.000','46.005.100','46.005.134','46.005.734','46.005.737','46.005.810','46.005.850','46.004.000','46.004.100','46.004.134','46.004.734','46.004.737','46.004.810','46.005.850','46.012.000','46.012.100','46.012.134','46.012.734','46.012.737','46.012.810','46.012.850','46.603.000','46.603.100','46.603.134','46.603.734','46.603.737','46.603.810','46.012.850','46.013.000','46.013.100','46.013.134','46.013.734','46.013.737','46.013.810','46.013.850','46.604.000','46.604.100','46.604.134','46.604.734','46.604.737','46.604.810','46.013.850','46.608.000','46.608.100','46.608.134','46.608.734','46.608.737','46.608.810','46.608.850','46.606.000','46.606.100','46.606.134','46.606.734','46.606.737','46.606.810','46.606.850','46.607.000','46.607.100','46.607.134','46.607.734','46.607.737','46.607.810','46.607.850','46.610.000','46.609.000','46.611.000','46.306.000','46.599.000','42.064.000','42.065.000','42.066.000','42.067.000','46.518.063','42.068.000','46.108.063','46.530.063','46.405.063','46.406.063','46.407.000','46.408.000','46.409.000','46.410.063','46.411.000','46.412.000','46.025.000','46.414.000','46.416.100','46.419.000','46.419.100','46.420.000','46.020.000','46.020.100','46.205.000','46.502.100','46.502.837','46.502.122','46.512.000','46.513.000','46.514.000','46.515.000','46.516.000','46.500.000','46.520.000','42.198.000','46.550.000','46.551.855','46.552.855','46.553.030','46.553.063','46.556.000','46.557.000','46.558.000','46.559.030','46.560.000','46.561.000','44.132.000','510006','42.063.000','42.056.000','42.057.000','42.058.000','42.501.855','42.505.000','42.506.030','42.512.000','42.649.850','42.651.000','42.522.000','44.131.855','34.095.000','34.099.000','34.075.000','34.076.000','34.098.000','34.080.000','34.097.000','34.020.000','34.216.000','34.230.000','34.215.000','34.231.000','2984495001','34.240.000','34.241.000')
 order by m.ItemNumber

 select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('3400715320','1001690','1001693','1001694','1001696','1001698','1001701','1001707','1001710','1001711','1001715','1001717','1001720','1001726')
  select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('27.285.178','82.691.901')
  select * from JDE_DB_Alan.Px_AWF_HD_MT_FCPro_upload p where p.ItemNumber in ('27.285.178')

select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in  ('S3000NET5250N071','S3000NET5250N201','S3000NET5250N801','S3000NET5250N902','S3000RR3250RR23','S3000RR3250RR44','S3000RR3250RR84','S3000RR3250RR98')
select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('42.210.031') and f.DataType1 in ('adj_fc') and f.Date between '2021-03-01' and '2022-02-01'

exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '2974000000','2018-11-01','2019-07-01'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '085552500D064','2018-09-01','2019-07-01'
exec JDE_DB_Alan.sp_FCPro_FC_Sales_Analysis 
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '24.7218.4462','2018-09-01','2019-07-01'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '24.7364.1858,24.7200.0001T,24.7221.1858','2018-09-01','2019-07-01'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '7127970914,7493500182,7146040000','2018-09-01','2019-07-01'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '82.696.921,S3000NET5300N904,82.604.904,26.418.000','2019-02-01','2019-12-01'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '4181301785,82.691.932,43.207.532M','2019-11-01','2020-12-01'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '42.210.031','2021-03-01','2022-02-01'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2021-03-01','2022-02-01'




---when using Portfolio report, some points need to remember: 
 --1) Is it Awning ? avoid seasonal trap,not wise to use recent 4 months sales for immediate futue 4 month FC ?
 --) Is it new product ? if it is, then chances are last 3-4 months you may not have sales yet
 --)  




exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '34.073.000,34.095.000,34.099.000,34.221.000,34.223.000,34.237.000,34.245.000,34.247.000,34.248.000,34.295.000,FT.01391.000.00,FT.01468.000.01','2019-03-01','2019-12-01'

exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2019-04-01','2020-03-01'

exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde null,'82.633.906,82.633.904,82.633.903,82.633.908,82.633.905,82.633.901,82.633.907,82.633.902,82.633.909,46.610.000,46.603.134,46.504.000,24.5405.0000,46.606.850,24.7002.0001,46.409.000,24.7102.1858,46.602.000,24.7114.1858,46.604.737,24.7121.1858,46.608.000,24.7122.1858,18.010.035,24.7125.1858,46.414.000,24.7127.1858,46.517.000,24.7129.1858A,46.602.737,24.7202.0001,46.604.000,24.7206.0000,46.606.134,24.7218.4462,46.607.734,32.340.000,46.608.737,32.379.200,7545000000,32.380.855,46.407.000,32.455.462,46.411.000,32.501.000,46.419.100,42.064.000,46.507.000,42.065.000,46.524.000,42.066.000,46.602.134,42.067.000,46.603.000,42.068.000,46.603.737,42.421.855,46.604.134,42.603.855,46.606.000,46.002.000,46.606.737,46.002.063,46.607.100,46.004.000,46.607.810,46.004.100,46.608.134,46.004.134,46.608.850,46.004.734,46.614.500,46.004.737,7602209491,46.004.810,18.607.016,46.005.000,46.408.000,46.005.100,46.410.063,46.005.134,46.412.000,46.005.734,46.419.000,46.005.737,46.420.000,46.005.810,46.506.000,46.005.850,46.510.000,46.011.000,46.518.063,46.011.100,46.530.063,46.011.134,46.602.100,46.011.734,46.602.734,46.011.737,46.602.810,46.011.810,46.603.100,46.011.850,46.603.734,46.012.000,46.603.810,46.012.100,46.604.100,46.012.134,46.604.734,46.012.734,46.604.810,46.012.737,46.606.100,46.012.810,46.606.734,46.012.850,46.606.810,46.013.000,46.607.000,46.013.100,46.607.134,46.013.134,46.607.737,46.013.734,46.607.850,46.013.737,46.608.100,46.013.810,46.608.734,46.013.850,46.608.810,46.019.000,46.609.000,46.019.063,46.611.000,46.021.000,46.614.700,7543000000,7602209490,82.696.931,7602209492,7541002000,18.010.036,46.405.063,18.615.007,46.406.063,46.025.000,S3000NET5250N903,46.108.063,46.306.000','Adj_FC'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '82.691.910,82.696.910','2019-12-01','2020-07-01'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '38.001.001,38.003.001,38.004.000,38.001.002,38.001.003,38.001.004,38.001.005,38.001.006,38.003.002,38.003.003,38.003.004,38.003.005,38.003.006','2019-03-01','2020-02-03'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2019-02-01','2020-01-03'
select * from JDE_DB_Alan.Master_ML345 m where m.itemnumber in ('18.615.007')

select * from JDE_DB_Alan.MasterSupplier s where s.SupplierName like ('%del%')
select * from JDE_DB_Alan.vw_Mast m where m.Description like ('%zen%') and m.StockingType not in ('O','U') and m.FamilyGroup in ('982') and m.Description like ('%bounty%')

select * from JDE_DB_Alan.vw_Mast m where m.StockingType not in ('O','U') and m.FamilyGroup in ('982') order by m.Family


select * from JDE_DB_Alan.FCPRO_SafetyStock ss where ss.ItemNumber in ('7501001000')
select * from JDE_DB_Alan.FCPRO_NP_tmp

select * from JDE_DB_Alan.FCPRO_Fcst m where m.ItemNumber in ('7602209490')
select * from JDE_DB_Alan.FCPRO_Fcst m where m.ItemNumber in ('42.210.031') and m.DataType1 in ('Adj_FC')
select * from JDE_DB_Alan.vw_FC_Hist m where m.ItemNumber in ('42.210.031') and m.DataType1 in ('Adj_FC')
select * from JDE_DB_Alan.vw_FC f where f.ItemNumber in ('42.210.031')
select * from JDE_DB_Alan.FCPRO_Fcst_History h where h.ItemNumber in ('42.210.031')
select distinct h.DataType1 from JDE_DB_Alan.FCPRO_Fcst_History h
select distinct h.DataType1 from JDE_DB_Alan.FCPRO_Fcst h

 select * from JDE_DB_Alan.v m where m.ItemNumber in ('FA.S3300.280.CT','42.210.031')

select * from JDE_DB_Alan.Master_ML345 m where m.Description like ('%petra%') and m.StockingType in ('P','S')
select * from JDE_DB_Alan.Master_ML345 m where m.Description like ('%chester%') and m.StockingType in ('P','S') order by m.ItemNumber
select * from JDE_DB_Alan.Master_ML345 m where (m.Description like ('%linna%') or m.Description like ('%chester%')) and m.StockingType in ('S')  and m.ManFC in ('M') order by m.ItemNumber
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('2780144000','2780143000','2780155000','2780159000')


---  Sales Analysis ------
select distinct h.ItemNumber from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h 
where substring(h.FamilyGroup,1,3) in ( '913','981','982','983')
       
--select top 3 * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h 
select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h 
where substring(h.FamilyGroup,1,3) in ( '913','981','982','983')
       and h.cym > 201712 and h.CYM < 201901
order by h.FamilyGroup,h.ItemNumber,h.CYM

select * from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber   
  where f.ItemNumber in ( 
			  select distinct h.ItemNumber from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h 
				where substring(h.FamilyGroup,1,3) in ( '913','981','982','983')
				   and h.cym > 201712 and h.CYM < 201901
			--order by h.FamilyGroup,h.ItemNumber,h.CYM
)


select * from JDE_DB_Alan.vw_Mast m
where m.SupplierName like ('%turnils%')

--- Love light Roller blind change over --- RB Fabric but exclude Lux Designer fabric/Internal Sunscreen -- total 725 (494+231) SKUs
select distinct f.ItemNumber,FamilyGroup,m.Family 
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.FamilyGroup in ('986')
       and m.Family in ('70P','70Q','BSF','BSG')
order by m.FamilyGroup,m.family


select distinct f.ItemNumber,FamilyGroup,m.Family 
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.FamilyGroup in ('982')
       and m.Family in ('H50','H51','H52','H53','H54','H27')								--- Aria only
order by m.FamilyGroup,m.family


select distinct f.ItemNumber,FamilyGroup,m.Family 
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.FamilyGroup in ('982')
       and m.Family in ('H47','H48')								--- Zen only
order by m.FamilyGroup,m.family


select distinct f.ItemNumber,FamilyGroup,m.Family 
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.FamilyGroup in ('973','979')
      -- and m.Family in ('H47','H48')								--- Zen only
order by m.FamilyGroup,m.family


select f.ItemNumber,f.DataType1,f.FC_Vol,f.FCDate_
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.FamilyGroup in ('973','979')
      -- and m.Family in ('H47','H48')								--- Zen only
order by m.FamilyGroup,m.family


select * from JDE_DB_Alan.vw_FC a where a.ItemNumber in ('4171325080')

select distinct f.ItemNumber,m.StockingType,m.PlannerNumber,m.Owner_,f.ReportDate 
from JDE_DB_Alan.FCPRO_Fcst_History f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.FamilyGroup in ('982') and ReportDate between '2019-10-31' and '2019-11-01 9:00:00' 


select distinct f.ItemNumber,m.Description,m.StockingType,m.PlannerNumber,m.Owner_,m.FamilyGroup,m.Family
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
where m.FamilyGroup in ('982')


select distinct f.ItemNumber,m.Description, m.Family from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber   
  where f.ItemNumber in ( 
				  select distinct h.ItemNumber from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h 
			    	--where substring(h.FamilyGroup,1,3) in ( '900') and SUBSTRING(h.family,1,3) in ('E24') 
					  where substring(h.FamilyGroup,1,3) in ( '982')
					   and  (h.cym > 201712 and h.CYM < 201901)
							--order by h.FamilyGroup,h.ItemNumber,h.CYM
							)
order by m.Family


select f.ItemNumber,m.Description,f.FCDate_,f.FC_Vol,m.UOM,m.StockingType,m.PlannerNumber,m.Owner_,m.FamilyGroup,m.Family,v.Customer_Supplier_ItemNumber
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber
                         left join JDE_DB_Alan.vw_Mast_Vendor_Item_CrossRef v on f.ItemNumber = v.ItemNumber
where f.ItemNumber in ('44.013.001','44.014.001')
--where m.FamilyGroup in ('982')

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload

------------- Sales by different UOM -----------------

select  s.ItemNumber
          ,m.ShortItemNumber
		  ,s.Sold_To,s.Date_Req,s.Secondary_Quantity,s.Secondary_UOM,m.FamilyGroup,m.Description
	      ,u.UOM_From,u.UOM_To,u.ShortItemNumber Conv_shtItm,u.Conv_Factor,u.Conv_Factor_2ndToPmy
		  ,s.Secondary_Quantity/u.Conv_Factor as Pack_Qty,s.Extended_Amount,s.Doument_Type,s.Sold_To_Name
		 -- ,GETDATE() as reportdate
	from (JDE_DB_Alan.vw_SO s left join JDE_DB_Alan.vw_Mast m on s.ItemNumber = m.ItemNumber) 
			left join JDE_DB_Alan.Master_UOMConversion u on m.ShortItemNumber = u.ShortItemNumber  and m.UOM = u.UOM_To
   where m.FamilyGroup in ('966')
   


select * from JDE_DB_Alan.TesTSO s where s.Second_Item_Number in ('40.498.004')
select * from JDE_DB_Alan.vw_Mast m where m.ShortItemNumber in ('764158')
select * from JDE_DB_Alan.Master_UOMConversion u where u.ShortItemNumber in ('739833')




select s.Second_Item_Number,s.Sold_To,s.Secondary_Quantity,s.Secondary_Quantity,s.Secondary_UOM,m.ShortItemNumber,m.FamilyGroup
		,u.UOM_From,u.UOM_To,u.Conv_Factor
	from JDE_DB_Alan.TesTSO s left join JDE_DB_Alan.vw_Mast m on s.Second_Item_Number = m.ItemNumber 
			left join JDE_DB_Alan.Master_UOMConversion u on m.ShortItemNumber = u.ShortItemNumber

select * from JDE_DB_Alan.vw_Mast m 
where m.Description like ('%anvil%')
     and m.Family_0 like ('%baha%')

--'913' and left(h.Family,3) = 'X01'

select substring(h.FamilyGroup,1,3) from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h where h.ItemNumber in ('42.210.031')


select * from JDE_DB_Alan.FCPRO_Fcst_History fh where fh.ItemNumber in ('43.205.532M') and fh.ReportDate between '2018-02-01' and '2018-03-01'
select * from JDE_DB_Alan.FCPRO_Fcst_History fh where fh.ItemNumber in ('43.205.532M') and fh.ReportDate > '2020-01-28' and fh.ReportDate <'2020-02-01' 

--- display all record where save date is later than Oct 2019
select * from JDE_DB_Alan.FCPRO_Fcst_History fh where fh.ItemNumber in ('43.205.532M') and
						cast(SUBSTRING(REPLACE(CONVERT(char(10),fh.reportdate,126),'-',''),1,6) as integer) = 202001


---****************************************************************************** ---
--------------------------- xxxxxxxx ----------------------------------------

------- Query forecast For Ana ----- 3/3/2021

select * from JDE_DB_Alan.vw_FC f
select * from JDE_DB_Alan.vw_Mast m where m.PrimarySupplier in ('1228')

select distinct f.ItemNumber
from JDE_DB_Alan.FCPRO_Fcst f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber=m.ItemNumber
--where f.ItemNumber in ('34.247.000')
where m.PrimarySupplier in ('2092128') and f.DataType1 in ('Adj_FC')


select f.ItemNumber,f.DataType1,f.Date,f.Value,
		m.PlannerNumber,m.PrimarySupplier,m.FamilyGroup,m.SupplierName
from JDE_DB_Alan.FCPRO_Fcst f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber=m.ItemNumber
--where f.ItemNumber in ('34.247.000')
where m.PrimarySupplier in ('503947') and f.DataType1 in ('Adj_FC')
     and f.Date <'2020-02-01'


select f.ItemNumber,m.Description,f.DataType1,f.FCDate2_,f.FC_Vol,m.UOM
		,m.PlannerNumber,m.Owner_,m.PrimarySupplier,m.FamilyGroup,m.SupplierName
from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber=m.ItemNumber
--where f.ItemNumber in ('4181301661','4181301048','4181301320','4181301765','4181301785','4181301176','3051303661','3051303048','3051303320','3051303765','3051303785','3051303176','4231301661','4231301048','4231301320','4231301765','4231301785','4231301176','6121302','2151308','2151307','2781211000','6281301','6281303','5241301','2131301','4231303','4231302','1081401','7231303','15281','6191403','8291401','CS5822105','CS5822210','4161301','XEC785','XEC105','XEC118','XEC124','XEC131','XEC199')
 where f.ItemNumber in ('34.502.000','34.503.000','34.504.000','34.505.000','34.218.000','34.219.000','34.026.000','34.084.000','34.024.000','34.025.000','34.085.000','34.086.000')

where m.PrimarySupplier in ('1228') and f.DataType1 in ('Adj_FC')				--- 1228 is 'HUNTER DOUGLAS SCANDINAVIA  AB'
     and f.Date <'2022-01-01'


select * from JDE_DB_Alan.FCPRO_SafetyStock s where s.ItemNumber in ('7491700001','7491700914','26.144.0952')


---****************************************************************************** ---



---============= Update FC table =========
 
   --- update forecast value using same table, replacing one month saved fc value with previous month value --- if something is wrong --- 11/2/2020  --- Yeah works !
;update f
 set f.value = f2.value
  from JDE_DB_Alan.FCPRO_Fcst_History f inner join JDE_DB_Alan.FCPRO_Fcst_History f2 on f.ItemNumber = f2.ItemNumber  and f.Date = f2.Date     ---N0 Need ? Need !                                                                                
     where f.ItemNumber = '43.205.532M' 
	       and cast(SUBSTRING(REPLACE(CONVERT(char(10),f.reportdate,126),'-',''),1,6) as integer) =202001
		   and cast(SUBSTRING(REPLACE(CONVERT(char(10),f2.reportdate,126),'-',''),1,6) as integer) =201912


;update f
set f.Value = 803
from JDE_DB_Alan.FCPRO_Fcst f
where f.DataType1 = 'Adj_FC' and f.ItemNumber in ('24.7220.1858')

select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('24.7220.1858') and f.DataType1 in ('Adj_FC')


select * from JDE_DB_Alan.vw_FC f where f.ItemNumber in ('18.013.089')
select * from JDE_DB_Alan.FCPRO_MI_orig mi 
order by mi.Date,mi.Itemid

select * from JDE_DB_Alan.FCPRO_MI_tmp
select * from JDE_DB_Alan.FCPRO_MI_2_tmp

exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde_ZeroOut '1385969'

exec JDE_DB_Alan.sp_MI_FC_Check_upload 'MI_1'
exec JDE_DB_Alan.sp_MI_FC_Override_upload 'MI_1'

exec JDE_DB_Alan.sp_FCPRO_Px_MI_PlaceHolder_upload  MI_2
exec JDE_DB_Alan.sp_FCPRO_SlsHistory_MI_PlaceHolder_upload MI_2
 exec [JDE_DB_Alan].sp_FCPRO_SlsHistory_MI_PlaceHolder_upload 'MI_2'


select * from JDE_DB_Alan.FCPRO_MI_tmp mi where mi.ItemNumber in ('311202') order by mi.Date
select * from JDE_DB_Alan.FCPRO_MI_tmp mi where mi.ItemNumber in ('709901') order by mi.Date

select * from JDE_DB_Alan.FCPRO_MI_2_Raw_Data_tmp mi2 order by mi2.ItemID,mi2.Date

select * from JDE_DB_Alan.MasterFamilyGroup
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in  ('82.633.903','82.633.908','S3000NET5300N0AL','S3000NET5300N0PW','S3000NET5300N0SS','S3000NET5300NAMB','S3000NET5300NMMS','S3000NET5300NMTS','S3000NET5300NPMB','S3000NET5300NSAP','S3000NET5300NWWP')
-------------------------------------------------------------------------------------------
with cte as (
				select m.*
						,row_number() over(partition by m.itemNumber order by itemnumber ) as rn 
				from JDE_DB_Alan.Master_ML345 m )
	,cte_ as (
					select cte.*
					       ,case when cte.stockingType in ('O','U') then 'N' 			-- if discontinue it is 'N'	otherwise it is 'Y'			         
								  else 'Y'   end as JdeValidStatus
				     from cte where rn =1 					
				 )
	,tb as ( select np.*,cte_.StockingType,cte_.JdeValidStatus
					,case when cte_.JdeValidStatus is null then 'NotFind' else cte_.JdeValidStatus end as STKTYP_St 		  --- in case Your ML345 is not updated hence you could hve 'Null' - left join
			 from JDE_DB_Alan.FCPRO_NP_tmp np left join cte_ on np.ItemNumber = cte_.ItemNumber
			  --where np.ItemNumber in ('34.528.000') 		  
			 )
    
	--- Get Your final list ---
	,tb_ as (select tb.*,case when tb.ValidStatus ='N' then 'N'				-- Considering Your input in Excel file ( 'ValidStatus')
	                 when tb.STKTYP_St ='NotFind' then 'N'			    -- Considering JdeValidStatus
	                 else tb.STKTYP_St									-- Considering JdeValidStatus
					 end as fSTKTYP_St
			from tb
			)
    --select distinct t.ItemNumber
	select t.ItemNumber,t.Date,t.Value,t.DataType,t.CN_Number,t.Comment,t.Creator,t.LastUpdated,t.fSTKTYP as ValidStatus_,t.RefNum,t.ReportDate
	from tb_ t
	where t.fSTKTYP_St = 'N'
	where t.ItemNumber in ('34.528.000','34.527.000','KIT8105')
	order by t.ItemNumber,t.Date

--------------------------------------------------------------------------------------------------------------------

--- Get Your Hot list for FC review ---15/4/2022

select 'Total' as RowLabel,a.SellingGroup_,a.FamilyGroup_,a.Family_0,a.ItemNumber,a.SupplierName,a.Owner_,a.Pareto
from JDE_DB_Alan.vw_Mast a
where a.ItemNumber in ('46.616.000','46.617.000','46.618.000','46.617.100','46.618.100','46.617.134','46.618.134','46.617.734','46.618.734','46.617.737','46.618.737','46.617.810','46.618.810','46.617.850','46.618.850','46.617.104','46.618.104')			--- Alpha parts side channel from 5.8 to 5.2m to reduce waste

--where a.ItemNumber in ('42.652.000','46.421.000','46.508.500','46.508.700','46.531.500','46.531.700','7137040000','7370250182','7370250914','7370300182','7370300914','7370350182','7370350914','7370400001','7370400182','7370400914','7441500001B','7441500182B','7441500914B','7441700001B','7441700182B','7441700914B','7442700000','7442700001','7442700182','7442700914','7456500182','7460500000','7460700000','7467040100','7467070100','7468500001','7468500182','7468500914','7468700000','7468700001','7468700182','7468700914','7477500001','7477500182','7477500914','7477700000','7477700001','7477700182','7477700914','7479500001','7479500182','7479500914','7479700000','7479700001','7479700182','7479700914','7485700000','7489500001','7489500182','7489500914','7489700000','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700000','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700000','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700000','7494700001','7494700182','7494700914','7496500001','7496500182','7496500914','7496700001','7496700182','7496700914','7499700000','7499700001','7499700182','7499700914')			-- Non core list total 91 SKus ( not in ALn list but provided by Salman
--where a.ItemNumber in ('7146500000','7146500001','7146500182','7146500914','7457500001','7457500182','7457500914','7478500001','7478500182','7478500914','7478700000','7478700001','7478700182','7478700914','7488500001','7488500182','7488500914','7488700000','7488700001','7488700182','7488700914','7497700000','7497700001','7497700182','7497700914','7498700000','7498700001','7498700182','7498700914','7766050000','7766070000','7766250000','7766270000')    -- core list total 33 SKus , by Alan all SKus are long profile

--where a.ItemNumber in ('7478500001')

--- Update Forecast history With Jde download Forecast ( this might be a monthly activity ? ) --- 21/3/2022

/****** Script for SelectTopNRows command from SSMS  ******/
SELECT a.*
	  ,convert(varchar(7),a.Jde_Request_Date,120) as jde_fc_date_1
	  ,convert(varchar(7),a.JdeFC_ReportDate,120) as jde_rpt_date
  FROM [JDE_DB_Alan].[JDE_DB_Alan].[JDE_Fcst_Download] a
  where a.ItemNumber in ('87.202.001')
 --   where a.ItemNumber like ('%87%')


 --- Jde fcst download ---
 
 select distinct a.ItemNumber,c.FamilyGroup,c.Family_0 from JDE_DB_Alan.JDE_Fcst_Download a left join JDE_DB_Alan.vw_Mast c
 select *  from JDE_DB_Alan.JDE_Fcst_Download a 
 
   select a.*,c.FamilyGroup,c.Family_0 from JDE_DB_Alan.JDE_Fcst_Download a left join JDE_DB_Alan.vw_Mast c
				on a.ItemNumber = c.ItemNumber
   where   -- c.FamilyGroup in ('992') and c.Family in ('C04')
			--and a.ItemNumber in ('87.001.001') 	
			 a.ItemNumber like ('7%') 		
   order by a.ItemNumber,a.JdeFC_ReportDate,a.Jde_Request_Date

---*** Sql table Fcst  ***---    19/4/2022 965 Fabric Awning FC review
select distinct a.ItemNumber,b.Description,b.Colour,b.FamilyGroup
 --select a.ItemNumber,b.FamilyGroup_,b.Family_0,a.FCDate2_,b.Description,b.Colour,a.FC_Vol 
    from JDE_DB_Alan.vw_FC a left join JDE_DB_Alan.vw_Mast b on a.ItemNumber = b.ItemNumber
where   b.FamilyGroup in ('965') and b.Family in ('THC')			--- fabric awning, Cabrera
	 and a.ItemNumber in ('7122720049') 


--- Sql table Fcst History ---
select * from JDE_DB_Alan.vw_Mast a where a.ItemNumber in ('87.001.001')

select a.* from JDE_DB_Alan.FCPRO_Fcst_History a left join JDE_DB_Alan.vw_Mast b on a.ItemNumber = b.ItemNumber
where   b.FamilyGroup in ('992') and b.Family in ('c04')      
	 and a.ItemNumber in ('87.001.001') 
	 and a.ReportDate in ('2022-02-28 15:00:00') 
	 and a.Date  in ('2022-08-01 00:00:00','2022-09-01 00:00:00' )


--- Sql table Fcst History join with vw_Mast ---

with t as (

		 select a.*,convert(varchar(7),a.ReportDate,120) as fc_mth,c.FamilyGroup,c.Family_0
		        ,sum(a.value) over ( partition by a.ItemNumber ) as ItemTTL
		 from JDE_DB_Alan.FCPRO_Fcst_History a  inner join JDE_DB_Alan.vw_Mast c on a.ItemNumber = c.ItemNumber                                                
		   where  -- c.FamilyGroup in ('992') and c.Family in ('C04')
		          a.ItemNumber in ('7493700914')
				 -- a.ItemNumber in ('7493500182','7491500001','7493500914','7493700914')
				  --a.ItemNumber in ('42.652.000','46.421.000','46.508.500','46.508.700','46.531.500','46.531.700','7137040000','7370250182','7370250914','7370300182','7370300914','7370350182','7370350914','7370400001','7370400182','7370400914','7441500001B','7441500182B','7441500914B','7441700001B','7441700182B','7441700914B','7442700000','7442700001','7442700182','7442700914','7456500182','7457500001','7457500182','7457500914','7460500000','7460700000','7467040100','7467070100','7468500001','7468500182','7468500914','7468700000','7468700001','7468700182','7468700914','7477500001','7477500182','7477500914','7477700000','7477700001','7477700182','7477700914','7478500001','7478500182','7478500914','7478700000','7478700001','7478700182','7478700914','7479500001','7479500182','7479500914','7479700000','7479700001','7479700182','7479700914','7485700000','7488500001','7488500182','7488500914','7488700000','7488700001','7488700182','7488700914','7489500001','7489500182','7489500914','7489700000','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700000','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700000','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700000','7494700001','7494700182','7494700914','7496500001','7496500182','7496500914','7496700001','7496700182','7496700914','7497700000','7497700001','7497700182','7497700914','7498700000','7498700001','7498700182','7498700914','7499700000','7499700001','7499700182','7499700914','7766050000','7766070000','7766250000','7766270000') 
				  and a.ReportDate between ('2022-08-01 15:00:00') and ('2022-09-01 15:00:00')
				  and a.Date between ('2022-09-01 00:00:00') and ('2023-08-01 00:00:00' )
				 -- and convert(varchar(7),a.ReportDate,120) = convert(varchar(7),DATEADD(mm, DATEDIFF(m,0,GETDATE())-1,0),120)	
				  --order by a.ReportDate desc,a.Date
      )
 
--select distinct t.ItemNumber from t
select * from t
order by t.ItemNumber,t.ReportDate,t.Date


;update t
set t.Value = t.Value +1
--from JDE_DB_Alan.FCPRO_Fcst_History a
from (	 select a.*
			,convert(varchar(7),a.ReportDate,120) as rpt_mth
			,convert(varchar(7),a.Date,120) as fc_mth
			,c.FamilyGroup,c.Family_0
		  from JDE_DB_Alan.FCPRO_Fcst_History a  inner join JDE_DB_Alan.vw_Mast c on a.ItemNumber = c.ItemNumber
		  where   c.FamilyGroup in ('992') and c.Family in ('C04')
				  and a.ItemNumber in ('87.001.001')
				  and a.ReportDate in ('2022-02-28 15:00:00') 
				  and a.Date  in ('2022-08-01 00:00:00','2022-09-01 00:00:00') 

				  ) t


--- Sql Fcst History updated with Jde_fcst_download for particular family GP/family or product for particular period --- 
--- update Fcst history for Curtains family C04 products only with Jde forecast saved @ 28/2/2022 ---
;update t
set t.Value = t.Jde_FC_Value 
--from JDE_DB_Alan.FCPRO_Fcst_History a
from (	 select a.*
			,convert(varchar(7),a.ReportDate,120) as rpt_mth
			,convert(varchar(7),a.Date,120) as fc_mth
			,c.FamilyGroup,c.Family_0
			,b.ItemNumber as itm
			,b.JdeFC_ReportDate,b.Jde_Request_Date,b.Jde_FC_Value
		  from JDE_DB_Alan.FCPRO_Fcst_History a  inner join JDE_DB_Alan.JDE_Fcst_Download b
					 on a.ItemNumber = b.ItemNumber and convert(varchar(7),a.Date,120) = convert(varchar(7),b.Jde_Request_Date,120)
					    
				inner join JDE_DB_Alan.vw_Mast c on a.ItemNumber = c.ItemNumber
		       
		  where   c.FamilyGroup in ('992') and c.Family in ('C04')
				 -- and a.ItemNumber in ('87.001.001')
				  and a.ReportDate > ('2022-10-13 15:00:00')																	--- critical as you only want to updae 1 month fc history; define time in Fcst History table
				--and convert(varchar(7),a.ReportDate,120) = convert(varchar(7),DATEADD(mm, DATEDIFF(m,0,GETDATE())-1,0),120)	  -- or use formula to set last month report date
				--  and a.Date  in ('2022-08-01 00:00:00','2022-09-01 00:00:00') 

           --order by a.ItemNumber,a.ReportDate,a.Date  
				  ) t

select distinct a.ItemNumber from JDE_DB_Alan.JDE_Fcst_Download a where a.ItemNumber in ('7493700914')
select a.*,convert(varchar(7),a.Jde_Request_Date,120) as date2 from JDE_DB_Alan.JDE_Fcst_Download a where a.ItemNumber in ('7493700914')


select * from JDE_DB_Alan.FCPRO_Fcst a where a.ItemNumber in ('7478700914','87.001.001','7127960000') order by a.ItemNumber,a.DataType1

select * from JDE_DB_Alan.FCPRO_Fcst a where a.ItemNumber in ('7478700914','87.202.001','7127960000') and a.ReportDate > '2022-04-11 15:00:00' order by a.ItemNumber,a.DataType1

select * from JDE_DB_Alan.FCPRO_Fcst a left join JDE_DB_Alan.vw_Mast b on a.ItemNumber = b.ItemNumber
  where b.Family in ('X08')
  a.ItemNumber in ('82700.3000.00.02') and a.DataType1 in ('Adj_FC')


--- update Fcst history for Awning products - mill colour only with Jde forecast saved @ 28/2/2022 ---
;update t
--set t.Value = 0
set t.Value = t.Jde_FC_Value 
--from JDE_DB_Alan.FCPRO_Fcst_History a
from (	 select a.*
			,convert(varchar(7),a.ReportDate,120) as rpt_mth
			,convert(varchar(7),a.Date,120) as fc_mth
			,c.FamilyGroup,c.Family_0
			,b.ItemNumber as itm
			,b.JdeFC_ReportDate,b.Jde_Request_Date,b.Jde_FC_Value
		  from    JDE_DB_Alan.FCPRO_Fcst a inner join JDE_DB_Alan.JDE_Fcst_Download b 
				 -- JDE_DB_Alan.FCPRO_Fcst_History a  inner join JDE_DB_Alan.JDE_Fcst_Download b
					on a.ItemNumber = b.ItemNumber and convert(varchar(7),a.Date,120) = convert(varchar(7),b.Jde_Request_Date,120)   --- use month name to join so elimiate problem of using first day or last day of month as date format is different in Jde and SQL db
				--JDE_DB_Alan.FCPRO_Fcst a	    
				inner join JDE_DB_Alan.vw_Mast c on a.ItemNumber = c.ItemNumber
		       
		  where  -- c.FamilyGroup in ('992') and c.Family in ('C04') and		--- Curtains - Soft collection 
		         a.DataType1 in ('Adj_FC') 
		        -- c.FamilyGroup in ('965') and c.Family in ('THC')			--- Fabric awning - Cabrera 
				--and c.FamilyGroup in ('913') and c.Family in ('X08')			--- Fabric awning - Cabrera 
				--  and a.ItemNumber in ('87.200.001')
				-- and a.ItemNumber like ('7%')
				  --   a.ItemNumber in ('7126070000','7127150000','7127510000','7127600000','7127620000','7127650000','7127660000','7127690000','7127700000','7127710000','7127900000','7127910000','7127940000','7127950000','7127960000','7127970000','7127990000','7129200000','7134210000','7134230000','7146500000','7236040000','7390020000','7390030000','7390930000','7390950000','7442700000','7468700000','7477700000','7478700000','7479700000','7488700000','7489700000','7491700000','7493700000','7494700000','7497700000','7498700000','7499700000','7742140000')				--- mill colour ??
				--and  a.ItemNumber in ('7127950000','7127960000','7127940000','7390030000','7127900000','7493700000','7468700000','7127990000','7126070000','7127150000','7127910000','7127970000','7390020000','7442700000','7488700000','7489700000','7491700000','7494700000','7742140000','7134230000','7478700000','7479700000','7127510000','7129200000','7477700000','7127620000','7127710000','7127700000','7127600000','7390950000','7499700000','7497700000','7498700000','7127660000','7146500000','7127650000','7127690000','7390930000')

				--  a.ItemNumber in ('7146500000','7146500001','7146500182','7146500914','7457500001','7457500182','7457500914','7478500001','7478500182','7478500914','7478700000','7478700001','7478700182','7478700914','7488500001','7488500182','7488500914','7488700000','7488700001','7488700182','7488700914','7497700000','7497700001','7497700182','7497700914','7498700000','7498700001','7498700182','7498700914','7766050000','7766070000','7766250000','7766270000')             --- 33 Long profile SKUs
				and a.ItemNumber in ('7441500001','7441500182','7441500914','7441700001','7441700182','7441700914')
				
				--and a.ItemNumber in ('42.652.000','46.421.000','46.508.500','46.508.700','46.531.500','46.531.700','7137040000','7370250182','7370250914','7370300182','7370300914','7370350182','7370350914','7370400001','7370400182','7370400914','7441500001B','7441500182B','7441500914B','7441700001B','7441700182B','7441700914B','7442700000','7442700001','7442700182','7442700914','7456500182','7457500001','7457500182','7457500914','7460500000','7460700000','7467040100','7467070100','7468500001','7468500182','7468500914','7468700000','7468700001','7468700182','7468700914','7477500001','7477500182','7477500914','7477700000','7477700001','7477700182','7477700914','7478500001','7478500182','7478500914','7478700000','7478700001','7478700182','7478700914','7479500001','7479500182','7479500914','7479700000','7479700001','7479700182','7479700914','7485700000','7488500001','7488500182','7488500914','7488700000','7488700001','7488700182','7488700914','7489500001','7489500182','7489500914','7489700000','7489700001','7489700182','7489700914','7491500001','7491500182','7491500914','7491700000','7491700001','7491700182','7491700914','7493500001','7493500182','7493500914','7493700000','7493700001','7493700182','7493700914','7494500001','7494500182','7494500914','7494700000','7494700001','7494700182','7494700914','7496500001','7496500182','7496500914','7496700001','7496700182','7496700914','7497700000','7497700001','7497700182','7497700914','7498700000','7498700001','7498700182','7498700914','7499700000','7499700001','7499700182','7499700914','7766050000','7766070000','7766250000','7766270000')      --- Salman' List of 122 SKUs in April 2022
				--and a.ItemNumber in ('46.616.000','46.617.000','46.618.000','46.617.100','46.618.100','46.617.134','46.618.134','46.617.734','46.618.734','46.617.737','46.618.737','46.617.810','46.618.810','46.617.850','46.618.850','46.617.104','46.618.104')			--- Alpha parts side channel from 5.8 to 5.2m to reduce waste
				--and a.ItemNumber  in ('28.665.002','28.665.131','28.665.388','28.665.462','28.665.481','28.665.858')					--- Veri shade Tracks
				--  and b.ItemNumber like ('38.%')			--- veri shade fabric
				--  and b.ItemNumber like ('24.7%')         --- roller parts

				--and a.ItemNumber in ('24.7128.1858','24.7128.0952','24.7128.0155')
				-- and a.ReportDate between '2022-12-01 15:00:00' and '2022-12-19 15:00:00' 																	--- critical as you only want to updae 1 month fc history; define time in Fcst History table
				--and convert(varchar(7),a.ReportDate,120) = convert(varchar(7),DATEADD(mm, DATEDIFF(m,0,GETDATE())-1,0),120)	  -- or use formula to set last month report date
				--  and a.Date  in ('2022-08-01 00:00:00','2022-09-01 00:00:00') 

           --order by a.ItemNumber,a.ReportDate,a.Date  
				  ) t

-----------------------------------------------------------------------------------------------------------------------
select * from JDE_DB_Alan.FCPRO_Fcst_History a where a.ItemNumber in ('28.665.002') and a.ReportDate > ('2022-10-01 15:00:00')
select * from JDE_DB_Alan.vw_FC a where a.ItemNumber in ('7766270000','28.665.002','7468700000') and a.DataType1 in ('Adj_FC')
select * from JDE_DB_Alan.vw_FC a where a.ItemNumber in ('7441700001') and a.DataType1 in ('Adj_FC')


select * from JDE_DB_Alan.vw_SafetyStock a where a.ItemNumber in ('46.508.500','46.508.700','46.521.500','46.521.700')

select distinct hd.FinancialYear,hd.FinancialMonth from JDE_DB_Alan.SlsHistoryHD hd order by   hd.FinancialYear,hd.FinancialMonth

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h where h.ItemNumber in ('45.665.063','45.004.855','45.047.063','45.067.063')
select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h where h.ItemNumber in ('Z18088A141')

select distinct f.ItemNumber from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('2780136000')
where f.ItemNumber in ('42.210.031') and f.DataType1 in ('Adj_FC')
where f.ItemNumber in ('82.391.901') and f.DataType1 in ('Adj_FC')
where f.ItemNumber in ('45.142.100') and f.DataType1 in ('Adj_FC')

select replace(convert(varchar(8), DATEADD(mm, DATEDIFF(m,0,GETDATE())-13,0),126),'-','')


select dateadd(d,-1,dateadd(mm,1,'2018-01-01'))
select dateadd(d,-1,dateadd(mm,1,'2018-02-01'))


;update p
set p.StockingType = 'U'
from JDE_DB_Alan.Master_ML345 p
where p.ShortItemNumber in ( '1377977','1379753','1379770','1379788')


select distinct mi.ItemNumber  from JDE_DB_Alan.FCPRO_MI_tmp mi
select * from JDE_DB_Alan.FCPRO_Fcst_Pareto
select * from JDE_DB_Alan.FCPRO_SafetyStock

select m.ItemNumber,m.LeadtimeLevel,m.PrimarySupplier from JDE_DB_Alan.Master_ML345 m 
where m.PlannerNumber in ('20072')


select distinct f.ItemNumber from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber like ('%e%')

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h where h.ItemNumber in ('2801471000')

select * from JDE_DB_Alan.SlsHistoryAWF_HD_MT h where h.ItemNumber in ('18.012.053','18.012.047')
select * from JDE_DB_Alan.SlsHistoryHD hd where hd.ItemNumber in ('18.012.053','18.012.047')
select * from JDE_DB_Alan.SlsHistoryMT mt where mt.ItemNumber in ('8328001')
select * from JDE_DB_Alan.SlsHistoryHD hd where hd.ItemNumber in ('8328001')
select * from JDE_DB_Alan.SlsHistorymt mt where mt.ItemNumber in ('4231301320')


select * from JDE_DB_Alan.FCPRO_MI_tmp mi where mi.ItemNumber in ('26.526.030')
select * from JDE_DB_Alan.FCPRO_MI_tmp mi where mi.ItemNumber in ('27.161.320')
select * from JDE_DB_Alan.FCPRO_MI_tmp mi where mi.ItemNumber in ('1081401')
select * from JDE_DB_Alan.FCPRO_NP_tmp np where np.ItemNumber in ('82.604.904')
select distinct np.ItemNumber from JDE_DB_Alan.FCPRO_NP_tmp np

select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('27.170.450')
select * from JDE_DB_Alan.FCPRO_Fcst_History fh where fh.ItemNumber in ('24.7002.0000')
select * from JDE_DB_Alan.SlsHistoryHD hd where hd.ItemNumber in ('2789000748')
select * from JDE_DB_Alan.SlsHistoryHD hd where hd.ItemNumber in ('2789000713')
select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('18.018.015') order by f.DataType1,f.Date

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h where h.ItemNumber in ('18.015.020')



select * from JDE_DB_Alan.OpenPO

select m.ItemNumber,count(m.Description) ct from  JDE_DB_Alan.Master_ML345 m
group by m.ItemNumber
order by ct desc

select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('F8174A908','2932623885') order by m.ItemNumber


select * from JDE_DB_Alan.FCPRO_Fcst f where f.DataType1 not like ('Adj%')
delete from JDE_DB_Alan.FCPRO_Fcst_ where DataType1 not like ('Adj%')

select * into JDE_DB_Alan.FCPRO_Fcst_ from JDE_DB_Alan.FCPRO_Fcst
select * from JDE_DB_Alan.FCPRO_Fcst_

select top 3 * from JDE_DB_Alan.vw_Mast_Planning


select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('4170681133','4170681320','4170681785','4170681862','4170681885','4170681651','4170681180','4170681426','4171290133','4171290120','4171290785','4171290862','4171290885','4171290651','4171290180','4171290426')
order by m.ItemNumber


select * from JDE_DB_Alan.FCPRO_NP_tmp n where n.ItemNumber in ('34.527.000')

select * from JDE_DB_Alan.SlsHistorymt mt where mt.ItemNumber in ('34.079.000')
select * from JDE_DB_Alan.SlsHistoryHD hd where hd.ItemNumber in ('34.079.000')
select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h where h.ItemNumber in ('34.079.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('34.079.000')

select * from JDE_DB_Alan.SlsHistorymt mt where mt.ItemNumber in ('2801385810')
select * from JDE_DB_Alan.SlsHistoryHD hd where hd.ItemNumber in ('2801385810')


select * from JDE_DB_Alan.SlsHistorymt mt where mt.ItemNumber in ('7454010000','46.414.000')
select * from JDE_DB_Alan.SlsHistoryHD hd where hd.ItemNumber in ('7454010000','46.414.000')

select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('7454010000')
select * from JDE_DB_Alan.FCPRO_MI_tmp mi where mi.ItemNumber in ('3024954849F')

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h where h.ItemNumber in ('34.107.000')
select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h where h.ItemNumber in ('27.252.713')


select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('7127400022')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('03.986.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('18.012.055','18.012.056')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('45.200.100')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('42.210.031')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('26.881.030')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('24.023.165')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('4231301320')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('03.986.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('05.980.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('D7174Q748')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('46.614.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('38.001.005')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('18.618.041')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('43.212.001','43.212.002','43.212.003','43.212.004')
select * from JDE_DB_Alan.vw_FC f where f.ItemNumber in ('42.210.031') 
select * from JDE_DB_Alan.vw_FC_Hist f where f.ItemNumber in ('42.210.031') and f.ReportDate between ('2018-09-30') and ('2018-09-30 17:00:00')


select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('82.604.905CL')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('34.528.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('KIT8105','4152336450','2801471000','45.133.000','45.133.100','45.134.000','45.134.100','2780145680','2780145451','2780144680','2780144451')
select distinct np.ItemNumber from JDE_DB_Alan.FCPRO_NP_tmp np where np.ItemNumber in  ('KIT8105','4152336450','2801471000','45.133.000','45.133.100','45.134.000','45.134.100','2780145680','2780145451','2780144680','2780144451')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('34.524.000','34.525.000','34.526.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('4152336451B','4152336849B','4152336450B')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('26.484.000')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('82.296.956')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('42.210.031')
select * from JDE_DB_Alan.MasterFamily fm where fm.Code like ('h%')
select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('28.676.000')
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '34.215.000,34.216.000,34.230.000,34.232.000,34.233.000,34.234.000,34.242.000','2020-01-02','2020-12-01'


select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('28.676.000')

select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('34.215.000','34.216.000','34.230.000','34.232.000','34.233.000','34.234.000','34.242.000')

exec JDE_DB_Alan.sp_Mismatch_Multi '42.210.031',null,'2020-09-01'
exec JDE_DB_Alan.sp_Mismatch_Multi '34.215.000,34.216.000,34.230.000,34.232.000,34.233.000,34.234.000,34.242.000',null,'2020-09-01'
exec JDE_DB_Alan.sp_Mismatch_Multi_1mOff '34.215.000,34.216.000,34.230.000,34.232.000,34.233.000,34.234.000,34.242.000',null,'2020-09-01'
exec JDE_DB_Alan.sp_Mismatch_Multi '44.003.102,44.003.102CL,44.003.102K,44.003.103,44.003.103CL,44.003.104,44.003.104CL,44.003.104K,44.003.105,44.003.105CL,44.003.106,44.003.106CL,44.003.107,44.003.107CL,44.003.108,44.003.108CL,44.003.109,44.003.109CL,44.003.110,44.003.110CL,44.003.111,44.003.111CL,44.003.112,44.003.112CL,44.003.113,44.003.113CL,44.003.113K,44.003.114,44.003.114CL,44.003.114K,44.004.102,44.004.102CL,44.004.102K,44.004.103,44.004.103CL,44.004.104,44.004.104CL,44.004.104K,44.004.105,44.004.105CL,44.004.106,44.004.106CL,44.004.107,44.004.107CL,44.004.108,44.004.108CL,44.004.109,44.004.109CL,44.004.110,44.004.110CL,44.004.111,44.004.111CL,44.004.112,44.004.112CL,44.004.113,44.004.113CL,44.004.113K,44.004.114,44.004.114CL,44.004.114K,44.004.115,44.004.115CL,44.004.116,44.004.116CL,44.004.117,44.004.117CL,44.004.118,44.004.118CL,44.005.102,44.005.102CL,44.005.102K,44.005.104,44.005.104CL,44.005.104K,44.005.109,44.005.109CL,44.005.110,44.005.110CL,44.005.111,44.005.111CL,44.010.001,44.010.001CL,44.010.002,44.010.002CL,44.010.003,44.010.003CL,44.010.004,44.010.004CL,44.010.005,44.010.005CL,44.010.006,44.010.006CL,44.010.007,44.010.007CL,44.011.001,44.011.001CL,44.011.002,44.011.002CL,44.011.003,44.011.003CL,44.011.004,44.011.004CL,44.011.005,44.011.005CL,44.011.006,44.011.006CL,44.011.007,44.011.007CL,44.012.003,44.012.003CL,44.012.004,44.012.004CL,44.012.007,44.012.007CL,44.012.008,44.012.008CL,44.015.404,44.015.405,44.016.107,44.016.404,44.016.405,44.016.408,44.016.505,44.016.808,44.017.405,44.132.000,44.207.000,44.209.000,44.210.000',null,'2020-09-05'
exec JDE_DB_Alan.sp_Mismatch_Multi '63328.3000.00.01,63328.3000.00.02,63328.3000.00.12,63328.3000.00.15,63328.3000.00.16,63328.3000.00.17,63328.3000.00.18,63328.3000.00.20,63328.3000.00.30,63328.3000.00.50,63328.3000.00.60,82336.2000.15.30,82336.3000.00.01,82336.3000.00.02,82336.3000.00.12,82336.3000.00.14,82336.3000.00.15,82336.3000.00.16,82336.3000.00.17,82336.3000.00.18,82336.3000.00.20,82336.3000.00.30,82336.3000.00.50,82336.3000.00.60,82336.3000.01.01,82336.3000.01.KB,82336.3000.02.02,82336.3000.12.12,82336.3000.15.30,82336.3000.16.16,82336.3000.17.17,82336.3000.18.18,82336.3000.20.20,82336.3000.30.30,82336.3000.50.50,82336.3000.50.KB,82336.3000.60.60,82336.3000.60.KB,82536.3000.00.02,82536.3000.00.12,82536.3000.00.16,82536.3000.00.17,82536.3000.00.20,83.106.902,83.106.903',null,'2020-09-03'
exec JDE_DB_Alan.sp_Mismatch_Multi '42.210.031',null,null
exec JDE_DB_Alan.sp_Mismatch_Multi '18.010.035,18.010.036,18.607.016,18.615.007,24.5403.0000,24.7102.0199,24.7114.0155,24.7125.0155,24.7127.0155,24.7128.0155,24.7129.0155A,24.7201.0000,24.7203.0001,24.7206.0000,24.7220.1858,32.340.000,32.379.200,32.380.855,32.455.855,32.501.000,43.207.565M,82.633.908',null,'2019-09-03'
exec JDE_DB_Alan.sp_Mismatch_Multi '42.210.031','2020-01-05','2020-09-03'

exec JDE_DB_Alan.sp_Mismatch_Multi_V9 '42.210.031','2019-09-03',null,null							-- no 'Start_Fc-SavedDate' or 'End_Fc-SavedDate' - using default setting mean to using current month FC
exec JDE_DB_Alan.sp_Mismatch_Multi_V9 '42.210.031','2019-09-03','2018-09-28','2018-09-30 17:00:00'  -- has 'Start_Fc-SavedDate' or 'End_Fc-SavedDate' range, use FC saved during that range period

exec JDE_DB_Alan.sp_Mismatch_HD_RCCP_1mOff 'GRP_1','2022-03-01'			--works		1'09"
exec JDE_DB_Alan.sp_Mismatch_HD_RCCP_1mOff 'GRP_2','2022-03-01'			--works		1'07"

exec JDE_DB_Alan.sp_Mismatch_HD_RCCP_1mOff 'GRP_1','2022-03-01',null			-- does not work properly
exec JDE_DB_Alan.sp_Mismatch_HD_RCCP_1mOff 'GRP_2','2022-03-01',null			-- does not work properly



select * from JDE_DB_Alan.MasterSuperssionItemList

select * from JDE_DB_Alan.Master_ML345  m
where m.ItemNumber in ('82.691.901','82.691.902','82.691.903','82.691.904','82.691.905','82.691.906','82.691.907','82.691.908','82.691.909','82.691.910','82.691.911','82.691.912','82.691.919','82.691.920','82.691.921','82.691.922','82.691.923','82.691.924','82.691.924','82.691.925','82.691.926','82.691.927','82.691.928','82.691.929','82.691.930','82.691.931','82.691.932','82.691.933','82.691.934','82.696.901','82.696.902','82.696.903','82.696.904','82.696.905','82.696.906','82.696.907','82.696.908','82.696.909','82.696.910','82.696.911','82.696.912','82.696.913','82.696.914','82.696.915','82.696.916','82.696.917','82.696.918','82.696.919','82.696.920','82.696.921','82.696.922','82.696.923','82.696.924','82.696.924','82.696.925','82.696.926','82.696.927','82.696.928','82.696.929','82.696.930','82.696.931','82.696.932','82.696.933','82.696.934','82.696.940','82.696.941','82.696.942')

select * from JDE_DB_Alan.FCPRO_MI_tmp mi order by mi.ItemNumber
select top 1 m.* from JDE_DB_Alan.FCPRO_MI_tmp m
select top 1 n.* from JDE_DB_Alan.FCPRO_NP_tmp n
select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload s where s.ItemNumber in ('42.210.031')

select * from JDE_DB_Alan.FCPRO_Fcst
select * from  JDE_DB_Alan.FCPRO_SafetyStock s where s.ItemNumber in ('38.003.006')

select m.ItemNumber,m.ShortItemNumber,m.Description,m.FamilyGroup from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('34.486.000','34.487.000','34.489.000','34.516.000','34.517.000','34.518.000','34.520.000','34.547.000','34.362.000','34.363.000','34.364.000','34.400.000','34.401.000','34.402.000','34.403.000','34.404.000','34.405.000','34.406.000','34.407.000','34.408.000','34.409.000','34.410.000','34.411.000','34.412.000','34.413.000','34.414.000','34.415.000','34.416.000','34.417.000','34.418.000','34.419.000','34.420.000','34.421.000','34.422.000','34.423.000','34.436.000','34.437.000','34.438.000','34.439.000','34.440.000','34.441.000','34.442.000','34.443.000','34.444.000','34.445.000','34.468.000','34.469.000','34.470.000','34.471.000','34.472.000','34.473.000','34.474.000','34.475.000','34.476.000','34.477.000','34.478.000','34.479.000','34.490.000','34.491.000','34.492.000R','34.519.000','34.521.000R','34.522.000R','34.528.000','34.529.000','34.530.000','34.531.000','34.533.000','34.546.000','34.535.000','34.536.000','34.537.000','34.538.000','34.539.000')
select m.ItemNumber,m.ShortItemNumber,m.Description,m.FamilyGroup,m.StockingType from JDE_DB_Alan.vw_Mast m where m.ItemNumber in  ('34.362.000','34.363.000','34.364.000','34.400.000','34.401.000','34.403.000','34.404.000','34.405.000','34.406.000','34.407.000','34.408.000','34.409.000','34.410.000','34.411.000','34.412.000','34.414.000','34.415.000','34.417.000','34.418.000','34.419.000','34.421.000','34.422.000','34.436.000','34.437.000','34.438.000','34.441.000','34.442.000','34.443.000','34.444.000','34.445.000','34.468.000','34.471.000','34.477.000','34.486.000','34.487.000','34.489.000','34.516.000','34.517.000','34.520.000','34.528.000','34.529.000','34.530.000','34.531.000','34.533.000','34.535.000','34.536.000','34.537.000','34.538.000','34.539.000','34.547.000','34.478.000','34.469.000','34.491.000','34.492.000R','34.413.000','34.439.000','34.479.000','34.472.000','34.475.000','34.518.000','34.420.000','34.546.000','34.470.000','34.522.000R','34.476.000','34.490.000','34.474.000','34.416.000','34.521.000R','34.440.000','34.519.000','34.473.000','34.402.000','34.423.000')

select m.ItemNumber,m.ShortItemNumber,m.Description,m.FamilyGroup,m.StockingType,m.StandardCost from JDE_DB_Alan.vw_Mast m where m.ItemNumber in  ('4150083133','4150083180','4150083320','4150083651','4150083765','4150083785','4150083862','4150083885','4150084133','4150084180','4150084320','4150084651','4150084765','4150084785','4150084862','4150084885','KIT2796','','KIT2692','KIT2695','KIT2698','KIT2704','KIT2706','KIT2707','KIT2709','2989899000B','2989900000B','2989901000B','2989902000B')

select * from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('34.363.000')
select * from JDE_DB_Alan.FCPRO_Fcst_Pareto p where p.ItemNumber in ('05.980.000')

select round(5.53,0)


select 
 select * from JDE_DB_Alan.FCPRO_Fcst f where f.DataType1 in ('Adj_FC')

 --- pull out all forecast ---
 exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde null,null,'Adj_FC'


 --- pull out forecast by Item number ---
 exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde  null,'34.523.000,34.522.000,34.521.000,34.519.000,34.514.000,34.515.000,34.516.000,34.520.000,34.513.000,34.517.000,34.518.000','Adj_FC'
 exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde  null,'38.004.000S','Adj_FC'


  exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde  null,'82.448.901,82.448.903,82.448.926','Adj_FC'


  exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde  null,'25.010.0155,25.010.1858,25.012.0155,25.012.1858,25.020.0155,25.020.1858,25.021.0155,25.021.1858,25.022.0155,25.022.1858,25.023.0155,25.023.1858,25.024.0155,25.024.1858,25.025.0155,25.025.1858,25.026.0155,25.026.1858,25.027.0155,25.027.1858,25.028.0155,25.028.1858,25.029.000,25.030.0155,25.030.1858,25.031.0155,25.031.1858,25.032.000,25.033.000,25.034.000,25.035.000,25.036.000,25.037.030,25.038.0155,25.038.1858,25.039.0155,25.039.1858,25.040.0155,25.040.1858','Adj_FC'
  exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde  null,'25.010.0155,25.010.1858,25.012.0155,25.012.1858,25.020.0155,25.020.1858,25.021.0155,25.021.1858,25.022.0155,25.022.1858,25.023.0155,25.023.1858,25.024.0155,25.024.1858,25.025.0155,25.025.1858,25.026.0155,25.026.1858,25.027.0155,25.027.1858,25.028.0155,25.028.1858,25.029.000,25.030.0155,25.030.1858,25.031.0155,25.031.1858,25.032.000,25.033.000,25.034.000,25.035.000,25.036.000,25.037.030,25.038.0155,25.038.1858,25.039.0155,25.039.1858,25.040.0155,25.040.1858','Adj_FC'

  exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde  null,'42.198.000,42.421.855,46.598.000,42.327.215,52.003.032,42.206.031,44.011.007,42.151.855,42.187.855,52.002.000,46.610.000,42.328.000,40.367.173,42.218.031,52.018.000,46.019.000,42.357.252,44.011.003,44.016.404,18.013.090,42.056.000,44.011.004,46.599.000,52.012.000,44.016.408,44.132.000,82.401.024,52.004.000,44.011.006,46.002.000,42.220.031,42.512.000,46.306.000,42.613.886,52.001.134,46.508.500,44.010.007,46.612.700,52.013.000,44.015.404,42.211.031,42.210.031,44.016.405,44.012.007,42.057.000,42.212.031,42.357.131,45.032.063,46.011.000,42.357.481,46.506.000,42.357.804,46.005.000,46.019.063,42.357.493,52.010.032,44.016.808,52.005.000,46.612.500,42.607.032,52.016.000,46.524.000,46.011.134,42.157.031,44.011.002,46.012.000,44.017.405,46.607.000,42.184.049,46.606.000,52.020.000,44.011.005,52.000.063,52.015.000,42.236.000,46.607.134,82.401.015,46.606.134,52.008.000,52.021.000,82.401.022,42.601.886,46.203.000,42.209.031,46.611.000,46.521.700,46.609.000,42.357.286,46.507.000,44.010.004,42.334.000,7156010000,46.002.063,46.419.000,44.012.004,82.401.012,42.077.032,52.014.000,46.108.063,46.505.000,44.015.405,46.011.850,44.012.003,46.021.000,46.005.850,42.213.031,46.517.000,44.011.001,46.005.134,52.016.100,46.011.100,46.012.850,46.615.063,42.230.000,46.606.850,46.607.850,45.624.000,46.502.837,45.658.000,46.500.000,42.320.493,46.012.134,42.614.063,52.008.100,46.607.100,46.607.810,46.606.100,52.011.030S,42.180.049,52.020.100,52.021.100,52.016.134,46.614.700,42.323.031,46.606.810,42.320.850,46.608.000,52.007.063,44.016.107,46.005.100,52.027.000,46.504.000,52.006.000,52.029.010,46.011.810,82.401.013,42.206.063,44.010.006,46.602.134,82.401.004,46.421.000,52.009.000,52.015.100,52.014.100,52.030.000,44.012.008,52.021.134,42.645.002,42.505.000,52.020.134,42.506.030,46.005.810,42.064.000,42.058.000,46.607.734,52.008.134,46.606.734,46.012.810,52.001.850,42.320.481,52.004.000V,52.022.000,82.401.023,52.015.134,46.422.030,46.012.100,82.401.001,46.423.100,42.357.273,44.016.505,42.357.810,42.357.805,46.530.063,46.011.734,82.401.002,44.004.103,46.614.500,52.014.134,46.004.134,46.602.000,46.004.000,40.340.173,42.320.252,18.616.003,44.003.104K,42.320.804,46.608.134,82.296.943,82.401.019,44.005.104K,46.603.134,44.010.003,46.602.100,46.603.000,44.005.102K,42.062.000,82.401.016,34.249.000,46.502.100,52.016.810,18.099.032,34.097.000,46.513.000,42.060.000,52.008.810,46.606.737,52.021.850,82.401.008,46.518.063,46.005.734,46.607.737,82.296.972,6610260000,52.021.810,46.601.000,42.501.855,52.020.850,82.401.017,46.600.000,46.012.734,82.401.009,46.013.000,52.020.810,18.696.031,46.602.810,46.502.122,46.004.100,44.004.114K,46.011.737,40.371.173,52.017.000,46.608.850,42.357.104,44.010.001,52.016.850,46.608.100,46.005.737,46.602.734,42.361.493,46.004.810,52.014.850,52.015.810,34.260.000,44.004.104K,34.096.000,52.014.737,82.401.020,46.514.000,42.632.855,46.608.810,46.603.100,52.022.100,34.020.000,42.655.000,45.623.000,52.008.734,46.012.737,52.016.734,46.603.810,44.003.114K,44.003.113K,42.631.855,52.014.810,82.296.965,42.361.173,44.010.005,42.214.031,52.015.734,46.419.100,52.021.734,42.649.850,42.157.063,82.296.953,6610200000,34.216.000,52.020.734,82.401.003,52.015.850,44.010.002,42.333.000,46.608.734,34.230.000,52.016.737,42.651.000,46.004.734,82.296.986,52.021.737,52.020.737,42.361.481,52.017.134,42.630.493,42.320.810,6610300000,52.008.737,46.550.000,46.016.000,7761030001,42.063.000,44.005.102,82.296.973,46.602.737,45.305.000,42.623.031,42.211.063,46.013.100,42.630.252,42.361.804,46.013.850,46.608.737,46.603.734,46.004.737,42.361.252,46.013.134,52.022.134,42.320.273,42.068.000,40.379.000,52.008.850,42.113.032,46.420.000,52.015.737,82.296.925,42.611.886,46.601.100,82.296.918,82.296.947,46.600.100,42.221.031,52.014.734,42.054.000,46.521.500,42.630.173,46.512.000,42.320.805,82.296.996,42.320.104,46.603.737,34.231.000,42.630.481,82.296.970,82.296.939,42.630.804,82.296.913,7156130000,46.013.810,46.601.810,82.297.949,42.212.063,42.196.031,42.466.030,82.296.909,7441500182,82.296.905,82.296.950,82.297.957,82.296.969,82.296.944,42.610.855,52.022.850,42.222.031,42.157.030,82.296.906,7460700000,46.013.737,44.003.114,42.622.000,52.022.810,82.296.907,82.296.957,46.604.000,42.647.493,82.296.936,42.647.173,42.194.031,42.215.031,46.510.000,46.013.734,42.152.850,45.682.100,46.515.000,82.296.946,52.032.030,46.423.850,42.647.804,82.401.018,45.678.100,52.031.030,46.604.134,42.630.185,52.017.100,45.679.100,34.095.000,46.604.100,82.296.933,42.209.063,42.361.810,82.296.956,42.502.000,42.630.810,34.258.000,34.259.000,46.553.063,42.647.481,45.680.100,82.401.006,45.223.100,34.240.000,42.630.104,52.022.734,45.677.100,45.683.100,42.503.000,42.213.063,45.681.100,42.647.252,34.506.000,82.296.934,46.600.810,45.071.063,42.361.273,42.647.104,46.604.737,82.296.951,82.296.932,7478700914,42.361.805,7493700914,82.296.948,82.401.007,46.414.000,6610340000,6611550000,42.062.173,7479500001,52.022.737,46.604.734,82.297.950,42.055.000,82.296.922,82.296.940,42.647.810,44.133.120,7127930001,42.361.104,46.604.810,46.423.134,46.601.734,82.296.931,46.601.737,45.143.000,46.425.100,45.522.000,82.297.952,7122930182,82.297.948,46.600.734,45.221.100,7457500182,46.600.737,45.057.063,45.403.100,82.297.956,42.065.000,82.296.952,42.180.131,44.004.113K,7127910001,46.020.000,46.205.000,42.223.031,7233020000,46.025.000,7390060182,46.516.000,46.553.030,52.034.000,7127990182,82.296.949,7232127035,7127860182,46.424.100,45.506.000,45.632.000,7232147035,34.224.000,7127890001,52.017.810,7495500001,7153080914,46.020.100,7491500182,7122570182,45.645.100,7126070001,42.611.000,7126070914,7127890914,42.647.185,7127910914,7390400914,7127990001,7468500182,7495500914,82.296.935,42.647.805,45.517.000,7394350914,7468500914,34.239.000,45.625.820,45.402.100,7394350001,7236010182,7468700182,7495700914,45.288.100,7151040914,45.254.100,7326080000,42.066.000,7468700914,34.201.000,7123080182,34.246.000,7495500182,7127850182,45.642.100,45.659.000,45.646.000,7390400001,45.132.100,7127940914,7468500001,45.656.100,7493700001,42.067.000,7127940001,7326020000,7127890182,46.561.000,46.560.000,7127620182,45.273.100,45.122.100,7370250001,7491700914,34.237.000,7390300001,7370200182,7370400914,45.283.000,7370350001,7326030000,7152070182,7350200001,7390030182,7127710914,7122910049,45.115.000,45.148.100,7122720182,7232187035,45.123.100,45.127.000,7390030001,7350150001,45.312.100,45.404.100,45.298.100,45.136.000,45.121.000,45.117.100,7151030914,45.118.000,7390030914,45.120.100,7326010000,45.670.820,45.311.100,82.296.910,7151030001,42.359.286,45.252.100,45.126.100,7122950914,7390200182,7127710001,45.129.100,7122720049,34.241.000,7742140001,7151040001,7350200914,7127710182,7127660182,45.618.100,45.312.000,45.401.100,45.665.063,52.017.734,7122930049,7390400182,7476500182,7127910182,45.103.100,45.146.000,45.127.100,7495700001,7370300182,6610520000,45.138.100,7151030182','Adj_FC'
   exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde  null,'34.263.0155,34.264.0155,34.265.0155,34.266.0000,34.267.0155,34.268.0000,34.269.0000,34.270.0000,34.271.0300,34.272.0155,34.273.0155,34.274.0155,34.275.0155,34.276.0000,34.277.0155,34.278.0300,34.279.0300,34.280.0300,34.281.0155,34.283.0300,34.284.0300,34.285.0155','Adj_FC'


  exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde_ZeroOut '1032266,867528,867499'


   exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde_ZeroOut '1382047,1381992,1382127,1382021,1382063,1382080,1382071,1382004,1382055,1382101,1382098,1381976,1382119,1382012,1381984,1382039,1351013,1351005,1351048,1365520,1351030,1351056,1351064,1351021'
    exec JDE_DB_Alan.sp_Exp_FPFcst_func2Jde_ZeroOut '1148891,1148904,1148912,1255515,1255523,1255540,1255558,1255566,1255574,1255582,1255591,1255603,1255611,1255620,1255638,1255654,1255662,1255689,1255726,1255734,1255751,1255769,1255902,1255911,1255697,1255929,1255937,1255945,1255953,1264817,1338257,1338281,1338345,1371428,1371436,1371452,1392000,1392018,1392042,1403266,1403274,1403223,1403231,1403291,1407540,1407558,1407566,1407574,1407582,1423689,1338353,1338265,1371479,1437360,1255646,1255700,1338361,1338290,1338329,1392026,1255742,1408884,1338273,1437386,1338337,1371461,1338311,1255671,1437378,1255718,1392034,1338302,1255531,1255777'

  select * from JDE_DB_Alan.FCPRO_NP_tmp n where n.ItemNumber in ('26.544.407')
  

select* from JDE_DB_Alan.FCPRO_Fcst_Pareto
select * from JDE_DB_Alan.FCPRO_Fcst_History f where f.ItemNumber in ('46.508.700','46.508.500','46.612.700','7470500000','7470700000')
      and f.ReportDate > '2018-05-05'

select DATEADD(mm, DATEDIFF(m,0,GETDATE())+5,0)


select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('7300110000','','')
select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber in ('25.037.030')

--- Signature New Product Post launch Analysis ---
 exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis @Item_id = '2851542072,2851548072,2851542167,2851548167,2851542245,2851548245,2851542351,2851548351,2851542661,2851548661,2851542669,2851548669,2851542689,2851548689,2851542785,2851548785,2851542862,2851548862,2801381661,2801381862,2801381320,2801381276,2801381810,2801381324,2801382661,2801382785,2801382320,2801382810,2801382689,2801382180,2801382862,2801382048,2801382879,2801382580,2801382324,2801382276,2801382609,2801382551,2801382669,2801382496,2801406661,2801406862,2801406072,2801406276,2801406351,2801406324,2801407661,2801407862,2801407072,2801407276,2801407351,2801407324,2801389661,2801389785,2801389072,2801389351,2801389689,2801389167,2801389862,2801389048,2801389354,2801389245,2801389324,2801389276,2801389609,2801389551,2801389669,2801389095,2801390661,2801390785,2801390072,2801390351,2801390689,2801390167,2801390862,2801390048,2801390354,2801390245,2801390324,2801390276,2801390609,2801390551,2801390669,2801390095,2801385661,2801385862,2801385320,2801385276,2801385810,2801385324,2801386661,2801386785,2801386320,2801386810,2801386689,2801386180,2801386862,2801386048,2801386879,2801386580,2801386324,2801386276,2801386609,2801386551,2801386669,2801386496,2801395661,2801395862,2801395072,2801395276,2801395351,2801395324,2801396661,2801396785,2801396072,2801396351,2801396689,2801396167,2801396862,2801396048,2801396354,2801396245,2801396324,2801396276,2801396609,2801396551,2801396669,2801396095,2801404000,2801403661,2801403862,2801403072,2801403276,2801403351,2801403324,2801436661,2801436785,2801436072,2801436351,2801436689,2801436167,2801436862,2801436048,2801436354,2801436245,2801436324,2801436276,2801436609,2801436551,2801436669,2801436095,2801405661,2801405785,2801405072,2801405351,2801405689,2801405167,2801405862,2801405048,2801405354,2801405245,2801405324,2801405276,2801405609,2801405551,2801405669,2801405095,KIT2758,KIT2759,2911529661,2911529862,2911529072,2911529276,2911529351,2911529324,2911530661,2911530862,2911530072,2911530276,2911530351,2911530324,2911531661,2911531785,2911531072,2911531351,2911531689,2911531167,2911531862,2911531048,2911531354,2911531245,2911531324,2911531276,2911531609,2911531551,2911531669,2911531095,2911532661,2911532785,2911532072,2911532351,2911532689,2911532167,2911532862,2911532048,2911532354,2911532245,2911532324,2911532276,2911532609,2911532551,2911532669,2911532095,2801471000,7502000000,7502001000,7501005000,7501001000,7804000000,2801499661,2801499785,2801499072,2801499351,2801499689,2801499167,2801499862,2801499048,2801499354,2801499245,2801499324,2801499276,2801499609,2801499551,2801499669,2801499095,2801999000,2781208000,2801454000,2801350000,2801433661,2801433862,2801433072,2801433276,2801433351,2801433324,2801434661,2801434862,2801434072,2801434276,2801434351,2801434324,2801490661,2801490785,2801490072,2801490351,2801490689,2801490167,2801490862,2801490048,2801490354,2801490245,2801490324,2801490276,2801490609,2801490551,2801490669,2801490095,2801491661,2801491785,2801491072,2801491351,2801491689,2801491167,2801491862,2801491048,2801491354,2801491245,2801491324,2801491276,2801491609,2801491551,2801491669,2801491095,2851512661,2851218661,2851224661,2851230661,2851236661,2851284661,2851512785,2851218785,2851224785,2851230785,2851236785,2851284785,2851512072,2851218072,2851224072,2851230072,2851236072,2851284072,2851512351,2851218351,2851224351,2851230351,2851236351,2851284351,2851218689,2851224689,2851230689,2851236689,2851284689,2851512167,2851218167,2851224167,2851230167,2851236167,2851284167,2851512862,2851218862,2851224862,2851230862,2851236862,2851284862,2851284048,2851218354,2851224354,2851230354,2851236354,2851284354,2851218245,2851224245,2851230245,2851236245,2851284245,2851284324,2851218276,2851224276,2851230276,2851236276,2851284276,2851284609,2851218551,2851224551,2851230551,2851236551,2851284551,2851284669,2851284095'
 exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis @Item_id = '2801404000,KIT2758,KIT2759,2801396785,2801386785,2801382785,2801396661,2801386661,2801382661,2801999000,2781208000,2801396862,2801350000,2801454000,2801389785,2801390785,2801396167,2801386862,2801382862,2801389661,2801396072,2801390661,2801396354,2801396669,2801396609,2801396276,2801389167,2801389072,2801386180,2801382180,2801386879,2801382879,2801386669,2801382669,2801386609,2801382609,2801386276,2801382276,2801389862,2801395661,2801386320,2801382320,2801389354,2801389689,2801389276,2801389669,2801389609,2801390862,2801390167,2801395862,2801390072,2801390354,2801390669,2801390609,2801390276,2801389048,2801389351,2801389245,2801390245,2801390689,2801396048,2801396689,2801390351,2801386689,2801382689,7804000000,2801389095,2801389324,2801390048,2801386048,2801382048,2801389551,2801396245,2801390095,2801390324,2801405785,2801396351,2801436785,2851230785,2801499785,7502000000,2801390551,2801386810,2801382810,2801471000,2801490785,2801385661,2801381661,2801405661,2801490661,2801436661,2851230661,2801499661,2801491785,2801386580,2801382580,2801491661,2801405862,2801396095,2801395276,2801436862,2801499862,2851230862,2911531785,2801490072,2801405167,2911532354,2911531661,2911532276,2911532669,2911531862,2911532609,2801405354,2801405669,2801405276,2801436167,2801405609,2801436354,2801436669,2801499167,2801436276,2801436609,2801405072,2801490167,2801499354,2851284609,2801499276,2801499609,2801499669,2851284669,2801385862,2801395324,2801436072,2801386496,2801385320,2801381862,2801382496,2801381320,2801396551,2801491072,2851230072,2801406661,2801499072,2851230354,2851230167,2851230276,2801490354,2801490669,2801490862,2911532661,2801490276,2801490609,2911532862,2801407661,2851224785,2801406072,2801491167,2801490048,2801490689,2801405689,2801395351,2801386551,2801382551,2801406862,2801436689,2801491354,2801491862,2801406276,2801491609,2801491276,2801491669,2911532072,2911531354,2911532785,2801405048,2801499689,2801407862,2801407072,2801407276,2801436048,2851284048,2801499048,2851284661,2851230689,2801406351,2801491048,2801491689,2851224661,2801396324,2801395072,2801407351,2801490351,2851284785,2801405351,7502001000,7501005000,2801386324,2801406324,2801382324,2911531245,2911532095,2911531072,2911531324,2911532167,2911531095,2911531167,2911531276,2911531669,2911532689,2801436351,2911532551,2911531551,2911531609,2801499351,2851236785,2851230351,2801491351,2801490095,2801403661,2851542785,2851548785,2851224862,2801407324,2801405245,2851218785,2801491095,2801499245,2851236661,2801436245,2801385810,2801381810,2801490245,2851230245,2851224354,2801433661,2911531351,2911531689,2911532245,2911532048,2851224072,2851224167,2851542862,2851542661,2851548072,2851542072,2851542167,2851224276,2851548167,2851548862,2851548661,2851284354,2851284072,2851218661,2851284862,2851236862,2851284167,2851284245,2851284551,2851284276,2851284689,2851284351,2851230551,2801491245,2801434661,2801405095,2801433072,2801499095,2851236072,2851218862,2801403072,2801403862,2801436095,2851284095,2801385324,2801385276,2851224689,2801381276,2801381324,2801403324,2801490551,2911529862,2801434072,2911529661,2851236354,2851236167,2851512785,2851224351,2851548351,2851236276,2801436551,2851548669,2911530276,2801405551,2851542689,2851548689,2801499551,2851542245,2851542351,2851542669,2851548245,2801405324,2801491551,7501001000,2801434862,2911530862,2801433276,2911530661,2801434276,2851218354,2851512661,2801436324,2851218167,2851218072,2851218276,2851236689,2801433862,2911529276,2911530072,2801491324,2801434324,2801490324,2911531048,2911532351,2801433324,2911532324,2801499324,2851284324,2851224245,2851512862,2851218689,2851236351,2851224551,2911530324,2801403351,2801433351,2911529072,2911529324,2911530351,2851512072,2801403276,2851218245,2851236245,2851512167,2851512351,2851218351,2851236551,2851218551,2801434351,2911529351'
 exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '2801404000','2018-05-01','2018-12-01'       -- works
 exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis null,'2019-03-02','2020-03-03'		-- works
  exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '6001130009009H,34.247.000','2019-03-01','2020-02-01'
exec JDE_DB_Alan.sp_FCPro_Portfolio_Analysis '27.239.664,27.239.470,27.239.502,27.239.467,27.239.487,27.240.664,27.240.470,27.240.502,27.240.467,27.240.487','2019-02-02','2019-12-03'


select m.ItemNumber,m.WholeSalePrice,m.UOM from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('18.010.035','18.010.036','18.607.016','18.615.007','24.5405.0000','24.7002.0001','24.7102.1858','24.7114.1858','24.7121.1858','24.7122.1858','24.7125.1858','24.7127.1858','24.7129.1858A','24.7202.0001','24.7206.0000','24.7218.4462','32.340.000','32.379.200','32.380.855','32.455.462','32.501.000','82.396.931','S3000NET5250N903')

exec JDE_DB_Alan.sp_FCPro_FC_Accy_Data '42.210.031'
exec JDE_DB_Alan.sp_FCPro_FC_Accy_Data '82.501.904'
exec JDE_DB_Alan.sp_FCPro_FC_Accy_Data '42.210.031,32.379.200'

select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber like ('%850531%')
select * from JDE_DB_Alan.FCPRO_Fcst_History h where h.ItemNumber in ('42.210.031') order by h.ItemNumber,h.ReportDate,h.Date

 ------------------------------------------------------------------------------------------------------------------------------------------------------------
 ----- Last Consecutive 12 month -----

 ------ Get past 12 month and future 12 month -- below is my work draft - 28/5/2018
;WITH R(N,_T,T_,T,X,X2,XX,YY,start) AS
	(
	 select 1 as N,-24 as _T,24 as T_,-23 as T,24 as X,24 as X2
			,24 as XX,24 as YY,cast(DATEADD(mm, DATEDIFF(mm, 0, GETDATE())-24, 0) as datetime) as start
	 UNION ALL
	 select  N+1, _T+1,T_-1,case when T+1<0 then T+1 else case when T+1 =0 then 1 else T+1 end end as T	
							,case when X-1 >= 0  then X-1			-- this algorithm is complicated
							   else  					   
								      case when X > 1 then X+1
										 else X+ 1  
                                      end
								end as X
                             
                            ,case when N >= 24  then _T+1			-- this is simple algorithm because use N 
							   else  					   
								     X
								end as X2

                            ,case when N >= 24  then _T+1
							   else  					   
								     X-1
								end as XX
                           ,case when N >= 24  then T							     
							   else  
							       YY-1
								end as YY
			 ,dateadd(mm,1,start)
	  from R
	 where N < 49
	)
select * from r
select R.N,case when R._T < 0 then R.T_ else R._T end as T, start  

----------------- Below is production code----------------------------------------------------

;WITH R(N,_T,T_,T,XX,YY,start) AS
	(
	 select 1 as N,-24 as _T,24 as T_,-23 as T,24 as XX,24 as YY,cast(DATEADD(mm, DATEDIFF(mm, 0, GETDATE())-24, 0) as datetime) as start      -- pay attention T starts -23,you need this so you can get XXX Column/Field in current month you start as 1, otherwise you can use XX field
	 UNION ALL
	 select  N+1, _T+1,T_-1,case when T+1<0 then T+1 else case when T+1 =0 then 1 else T+1 end end as T						
                            ,case when N >= 24  then _T+1
							   else  
							       XX-1
								end as XX
                             ,case when N >= 24  then T							     
							   else  
							       YY-1
								end as YY
			 ,dateadd(mm,1,start)
	  from R
	 where N < 49
	)
--select * from r
--select R.N,case when R._T < 0 then R.T_ else R._T end as T, start from R
--select R.N,case when R._T < 0 then R.T_ else R.YY end as T, start from R
  select  n as rnk
        ,YY
        ,cast(SUBSTRING(REPLACE(CONVERT(char(10),start,126),'-',''),1,6) as integer) as [StartDate]		
		,LEFT(datename(month,start),3) AS [month_name]
        ,datepart(month,start) AS [month]
        ,datepart(year,start) AS [year]				
  from R
	order by rnk asc


------------------------------
;WITH R(N) AS
(
SELECT 0
UNION ALL
SELECT N+1 
FROM R
WHERE N < 12
)
SELECT  n as rnk
		,LEFT(datename(month,dateadd(month,N,GETDATE())),3) AS [month_name]
        ,datepart(month,dateadd(month,-N,GETDATE())) AS [month]
        ,datepart(year,dateadd(month,-N,GETDATE())) AS [year]		
FROM R
order by rnk desc



--------------------------------------------------
 select * 
 from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload  h
    where h.ItemNumber in ('18.008.021')
      where h.CYM = cast(SUBSTRING(REPLACE(CONVERT(char(10),DATEADD(mm, DATEDIFF(m,0,GETDATE())-1,0),126),'-',''),1,6) as integer)		

	  	  
--------------------------------------------------------------------------------------------------------------
--- table variable join Mismatch ---

declare @mymi as table
( ItemID varchar(100) not null primary key ,
  FcDate varchar(100) not null,
  FcQty  decimal(18,2) not null )
  
 Insert into @mymi ( ItemId,FcDate,FcQty)
 values 
('32.501.000','2018-09',397.08),
('18.010.035','2018-09',183.6),
('18.615.007','2018-09',183.6),
('18.010.036','2018-09',183.6),
('2780229000','2018-09',1533.96),
('82.391.909','2018-09',500.22),
('32.379.200','2018-09',423.72),
('18.013.089','2018-09',183.6),
('24.7002.0001','2018-09',409.68),
('24.7334.4459','2018-09',183.6),
('24.7102.1858','2018-09',367.38),
('24.7219.4459','2018-09',405.9),
('32.455.155','2018-09',183.6),
('24.7121.4459','2018-09',367.38),
('24.7122.4459','2018-09',183.6),
('24.7124.4459','2018-09',183.6),
('24.7127.4459','2018-09',183.6),
('24.5349.4459','2018-09',183.6),
('24.7120.4459','2018-09',183.6),
('24.7250.4459','2018-09',433.8),
('24.7251.4459','2018-09',433.8),
('24.7253.4459','2018-09',183.6),
('24.7146.4459A','2018-09',183.6),
('24.7207.4459','2018-09',826.02),
('24.7168.4459A','2018-09',367.38),
('24.7169.4459A','2018-09',367.38),
('24.7163.0000A','2018-09',1101.96);
   
--select * from @mymi

 with         
			 po as (
						 select tb.ItemNumber,tb.DataType1,tb.PODate_,tb.poyr,tb.pomth,tb.BuyerName,tb.BuyerNumber,tb.TransactionOriginator,tb.TransactionOrigName,tb.SupplierName
							,sum(tb.PO_Volume) as PO_Vol
					    from JDE_DB_Alan.vw_OpenPO tb
					 -- where tb.ItemNumber in  ( select splitdata from JDE_DB_Alan.dbo.fnSplitString(@Item_id,','))	
					  group by tb.ItemNumber,tb.DataType1,tb.PODate_,tb.poyr,tb.pomth,tb.BuyerName,tb.BuyerNumber,tb.TransactionOriginator,tb.TransactionOrigName,tb.SupplierName

					  )
				--select * from po

				,fc as 
				   ( select f.ItemNumber,f.Date,f.FCDate_,f.FC_Vol,f_.FcQty
				            ,case when FcQty is null then f.FC_Vol
							      when FcQty is not null then f.FC_Vol + f_.FcQty 
								   --   else f.FC_Vol + f_.FcQty
							   end as  FC_Vol_f	   
				     from JDE_DB_Alan.vw_FC f left join @mymi f_ on f.ItemNumber = f_.ItemID and f.FCDate_ = f_.FcDate 
					-- where f.ItemNumber in ( '42.210.031','24.7207.4459')
					     --  and f.Date < '2019-03-01'
					 )
               --select * from fc   
				,tb as 
					(  select f.ItemNumber,f.Date,f.FCDate_,f.FC_Vol_f as FC_Vol
							,isnull(p.PO_Vol,0) PO_Vol
							--,isnull(m.QtyOnHand,0) SOH_Vol
							,isnull(m.QtyOnHand,0) as SOH_Begin_M
							 ,0 as SOH_Vol				 
							--, isnull(m.QtyOnHand,0) as SOH_End_M
							,0 as SOH_End_M
							,m.WholeSalePrice
							 
					 from fc f left join po p on f.ItemNumber = p.ItemNumber and f.FCDate_ = p.PODate_
											left join JDE_DB_Alan.vw_Mast m on f.ItemNumber  = m.ItemNumber and f.FCDate_ = m.SOHDate   -- SOHDate is current month name,also note 'vw_Mast' is clearn without duplicated records
					-- where f.Date< @dt
					 where f.Date < '2019-03-01'
						  -- and f.ItemNumber in ('45.103.000')
								 )
						
			  -- select * from tb        
				  ,tb_ as (
							select tb.ItemNumber,tb.Date,tb.FCDate_,tb.FC_Vol,tb.PO_Vol,tb.SOH_Vol 
									,case 
										   when tb.Date >DATEADD(mm, DATEDIFF(m,0,GETDATE()),0)  then (tb.PO_Vol -tb.FC_Vol)
										   when tb.date = DATEADD(mm, DATEDIFF(m,0,GETDATE()),0) then (tb.PO_Vol -tb.FC_Vol + tb.SOH_Begin_M)
										   else tb.SOH_Vol
										  end as  SOH_Vol_
								  -- ,(tb.PO_Vol -tb.FC_Vol) as SOH_Vol_
								   ,tb.SOH_Begin_M,tb.SOH_End_M
								   ,tb.WholeSalePrice					  
							from tb				
							)  
				 --select * from tb_
						   --- running total preparation ---      
				   ,tbl as ( select *,
									row_number() over ( partition by tb_.ItemNumber order by tb_.FCDate_ ) as rnk 
								from tb_      
                
							)
							--- running total To get End period inventory ---
				 ,tbl_ as 
						(	select *
								  ,sum(tbl.SOH_Vol_) over (partition by tbl.ItemNumber order by tbl.rnk ) as SOH_End_M_
								from tbl
						 )
      
				 -- select * from tbl_
							--- Beginning period inventory preparation ---
				  ,stk_beg as
						  ( select tbl_.ItemNumber as myItemNumber,tbl_.Date as myDate
									,DATEADD(mm, DATEDIFF(m,0,tbl_.Date)+1,0) dte
									,tbl_.SOH_End_M_ as mySOH_Begin_M_
			            
							 from tbl_)
					   --select * from stk_beg

				 ,t as ( select *
								 from tbl_ left join stk_beg on tbl_.ItemNumber = stk_beg.myItemNumber and tbl_.Date = stk_beg.dte 
							  )
					--  select * from t
							  --- Get Begining period inventory ---
				 ,t_ as ( select t.ItemNumber,t.Date,t.FCDate_,t.FC_Vol,t.PO_Vol,t.SOH_Vol,t.SOH_Vol_
									,case 
											when t.mySOH_Begin_M_ is null then t.SOH_Begin_M
											else t.mySOH_Begin_M_
									  end as  Final_SOH_Begin_M_
									,t.SOH_End_M_,t.rnk
									,t.WholeSalePrice
									--,t.myWSP
								 from t
								 )

					  --select * from t_
					  -- ,pri as ( select t_.ItemNumber,t_.WholeSalePrice from t_ where t_.WholeSalePrice is not null)

					 --  select * from pri
					--   ,_t as ( select t_.*,																			-- cost too long time to run
								   --       case when t_.WholeSalePrice is null then pri.WholeSalePrice
											 --   else t_.WholeSalePrice
										  --  end as mywholesaleprice
									--from t_ left join pri on t_.ItemNumber = pri.ItemNumber )
          
				  ,_t as ( --select t_.ItemNumber,t_.Date,t_.FCDate_,t_.FC_Vol,t_.PO_Vol,t_.SOH_Vol,t_.SOH_Vol_,t_.Final_SOH_Begin_M_,t_.SOH_End_M_,m.WholeSalePrice     -- will spit out column by column saves the performance issue ? Not really  -- 14/5/2018
								select t_.*, mm.WholeSalePrice as Mywholesaleprice,(mm.WholeSalePrice * t_.FC_Vol) FC_Amt
									   , case when t_.Final_SOH_Begin_M_ <= 0  then 'Y 'else 'N' end as Stk_Out_Stauts
									   ,sum(t_.FC_Vol) over (partition by t_.ItemNumber order by t_.FCDate_ Rows between current row and 2 following ) as CumulativeTotal_FC_Vol_3M			-- only works in SQL 2012 upwards, if you using 2008 need to use below...  https://docs.microsoft.com/en-us/sql/t-sql/queries/select-over-clause-transact-sql?view=sql-server-2017
									   ,sum(t_.FC_Vol) over (partition by t_.ItemNumber order by t_.FCDate_ Rows between 1 following and 3 following ) as CumulativeTotal_FC_Vol_Nxt3M	
									   ,avg(t_.FC_Vol) over (partition by t_.ItemNumber) as Avg_FC_Vol_Nxt8M			--- SQL2008 support this 
									 --  ,mm.PlannerNumber
						 				,case mm.PlannerNumber 
											--when '20071' then 'Domenic Cellucci'		
											when '20071' then 'Rosie Ashpole'
											when '20072' then 'Salman Saeed'
											when '20004' then 'Margaret Dost'	
											when '20005' then 'Imelda Chan'										  
											else 'Unknown'
										end as Owner_
									   ,mm.PrimarySupplier,mm.Description,mm.FamilyGroup_,mm.Family_0									   
								from t_ left join JDE_DB_Alan.vw_Mast mm on t_.ItemNumber = mm.ItemNumber )				-- note that 'vw_Mast ' has clean data 
		 
					   --select * from _t
						--where _t.ItemNumber in ('45.103.000','45.200.100','42.210.031') 
						 -- where _t.ItemNumber in ('0751031003001H')
						 --order by _t.ItemNumber,_t.Date		 

				 ,com as ( select _t.ItemNumber,_t.Date d1,_t.FCDate_ d2,'FC_Qty' as DataType,_t.FC_Vol as Value,_t.Stk_Out_Stauts,_t.Owner_,_t.PrimarySupplier,_t.Description,_t.FamilyGroup_,_t.Family_0 from _t
							   union all
							   select _t.ItemNumber,_t.Date d1,_t.FCDate_ d2,'PO_Qty' as DataType,_t.PO_Vol as value,_t.Stk_Out_Stauts,_t.Owner_,_t.PrimarySupplier,_t.Description,_t.FamilyGroup_,_t.Family_0 from _t
							  union all
							   select _t.ItemNumber,_t.Date d1,_t.FCDate_ d2,'SOH_Qty' as DataType,_t.SOH_Vol_ as value,_t.Stk_Out_Stauts,_t.Owner_,_t.PrimarySupplier,_t.Description,_t.FamilyGroup_,_t.Family_0 from _t
							  union all
								select _t.ItemNumber,_t.Date d1,_t.FCDate_ d2,'Start_Stk' as DataType,_t.Final_SOH_Begin_M_ as value,_t.Stk_Out_Stauts,_t.Owner_,_t.PrimarySupplier,_t.Description,_t.FamilyGroup_,_t.Family_0 from _t
							  union all
								select _t.ItemNumber,_t.Date d1,_t.FCDate_ d2,'End_Stk' as DataType,_t.SOH_End_M_ as value,_t.Stk_Out_Stauts,_t.Owner_,_t.PrimarySupplier,_t.Description,_t.FamilyGroup_,_t.Family_0 from _t
							  union all
								select _t.ItemNumber,_t.Date d1,_t.FCDate_ d2,'FC_Amt' as DataType,_t.FC_Amt as value,_t.Stk_Out_Stauts,_t.Owner_,_t.PrimarySupplier,_t.Description,_t.FamilyGroup_,_t.Family_0 from _t				   
                              union all
								select _t.ItemNumber,_t.Date d1,_t.FCDate_ d2,'Weeks_Cover1' as DataType,coalesce(_t.SOH_End_M_/nullif(_t.CumulativeTotal_FC_Vol_Nxt3M/12,0),0) as value,_t.Stk_Out_Stauts,_t.Owner_,_t.PrimarySupplier,_t.Description,_t.FamilyGroup_,_t.Family_0 from _t				  
							--  union all
							--	select _t.ItemNumber,_t.Date d1,_t.FCDate_ d2,'Weeks_Cover2' as DataType,(_t.SOH_End_M_)/(_t.Avg_FC_Vol_Nxt8M/4) as value,_t.Stk_Out_Stauts,_t.Owner_,_t.PrimarySupplier,_t.Description,_t.FamilyGroup_,_t.Family_0 from _t				  							  						  	 
							   )             

				 select * from com 
				 --where com.Stk_Out_Stauts in ('Y')
					--   where com.ItemNumber in ('24.7207.4459')
					      where com.ItemNumber in ('32.501.000','18.010.035','18.615.007','18.010.036','2780229000','82.391.909','32.379.200','18.013.089','24.7002.0001','24.7334.4459','24.7102.1858','24.7219.4459','32.455.155','24.7121.4459','24.7122.4459','24.7124.4459','24.7127.4459','24.5349.4459','24.7120.4459','24.7250.4459','24.7251.4459','24.7253.4459','24.7146.4459A','24.7207.4459','24.7168.4459A','24.7169.4459A','24.7163.0000A')
				  --where com.ItemNumber in ( select splitdata from JDE_DB_Alan.dbo.fnSplitString(@Item_id,','))
				  order by com.ItemNumber,com.DataType,com.d2 		



---------------------------------------------------------------------------------------------------------------------------------------
--- Below code is used in JDE_DB_Alan_     --- 6/07/2018 database

/****** Script for SelectTopNRows command from SSMS  ******/
SELECT distinct a.ReportDate
  FROM [JDE_DB_Alan_].[JDE_DB_Alan].[FCPRO_Fcst_Accuracy] a

  --- check numb of records in 'FC_history' table in JDE_DB_Alan_ database
   ;with cte as 
  (
	  select convert(varchar(13),y.ReportDate,120) as Date_Uploaded
				,count(*)  as Records_Uploaded
	  from JDE_DB_Alan.FCPRO_Fcst_Accuracy y
	  group by  convert(varchar(13),y.ReportDate,120) )
  
  select *, sum(cte.Records_Uploaded) over (order by Date_Uploaded) TTL_Records_AccuTbl from cte 
 -- where cte.Date_Uploaded between '2018-05-01' and '2018-05-25'
  order by cte.Date_Uploaded asc


  select * from JDE_DB_Alan.JDE_DB_Alan.FCPRO_Fcst_Accuracy
  select * from JDE_DB_Alan.JDE_DB_Alan.FCPRO_Fcst 
  insert into JDE_DB_Alan.JDE_DB_Alan.FCPRO_Fcst_Accuracy select * from JDE_DB_Alan_.JDE_DB_Alan.FCPRO_Fcst_Accuracy				--- transfer data from one tabel to another table

--- table and its size ---
  
SELECT 
    t.NAME AS TableName,
    s.Name AS SchemaName,
    p.rows AS RowCounts,
    SUM(a.total_pages) * 8 AS TotalSpaceKB, 
    CAST(ROUND(((SUM(a.total_pages) * 8) / 1024.00), 2) AS NUMERIC(36, 2)) AS TotalSpaceMB,
    SUM(a.used_pages) * 8 AS UsedSpaceKB, 
    CAST(ROUND(((SUM(a.used_pages) * 8) / 1024.00), 2) AS NUMERIC(36, 2)) AS UsedSpaceMB, 
    (SUM(a.total_pages) - SUM(a.used_pages)) * 8 AS UnusedSpaceKB,
    CAST(ROUND(((SUM(a.total_pages) - SUM(a.used_pages)) * 8) / 1024.00, 2) AS NUMERIC(36, 2)) AS UnusedSpaceMB
FROM 
    sys.tables t
INNER JOIN      
    sys.indexes i ON t.OBJECT_ID = i.object_id
INNER JOIN 
    sys.partitions p ON i.object_id = p.OBJECT_ID AND i.index_id = p.index_id
INNER JOIN 
    sys.allocation_units a ON p.partition_id = a.container_id
LEFT OUTER JOIN 
    sys.schemas s ON t.schema_id = s.schema_id
WHERE 
    t.NAME NOT LIKE 'dt%' 
    AND t.is_ms_shipped = 0
    AND i.OBJECT_ID > 255 
GROUP BY 
    t.Name, s.Name, p.Rows
ORDER BY 
    t.Name


--- spaced used by index  ---

SELECT
    OBJECT_NAME(i.OBJECT_ID) AS TableName,
    i.name AS IndexName,
    i.index_id AS IndexID,
    8 * SUM(a.used_pages) AS 'Indexsize(KB)'
FROM
    sys.indexes AS i JOIN 
    sys.partitions AS p ON p.OBJECT_ID = i.OBJECT_ID AND p.index_id = i.index_id JOIN 
    sys.allocation_units AS a ON a.container_id = p.partition_id
GROUP BY
    i.OBJECT_ID,
    i.index_id,
    i.name
ORDER BY
    OBJECT_NAME(i.OBJECT_ID),
    i.index_id


	------------------------------------------------

select * from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload h
where h.ItemNumber in ('0751031000202H','0751031000207H','0751031003001H','0751031003030H','0751031003061H','0850525000202H','0850525000207H','0850525000220H','0850525000222H','0850525000707H','0850525003001H','0850525003020H','0850525003021H','0850525003030H','0850525003061H','085052500M178H','0850531000202H','0850531000207H','0850531000220H','0850531000221H','0850531000222H','0850531000707H','0850531000720H','0850531002022H','0850531003001H','0850531003010H','0850531003020H','0850531003021H','0850531003030H','0850531003061H','085053100M178H','43.205.532M','43.205.535M','43.205.536M','43.205.537M','43.205.563M','43.205.568M','43.205.569M','43.205.574M','43.205.582M','43.205.583M','43.205.584M','43.207.532M','43.207.535M','43.207.536M','43.207.537M','43.207.565M','43.207.582M','43.207.584M','43.295.530','43.295.532','43.295.535','43.295.536','43.295.537')


----------------------------------------

-- To Get Details of Test CO/WO ---
select * from JDE_DB_Alan.TestCO 
select * from JDE_DB_Alan.TestWO


;with tb as
   ( select w.ItemNumber,w.OrderQuantity,w.UM,w.WONumber,c.OrderNumber as CO,c.CustomerName
            ,c.ItemNumber as FinItemNumber,c.ItemDescription as FinItemDesp,c.SlsCd2,SlsCd3,c.CO_Name as Proj_Name,c.StateCode2
		from JDE_DB_Alan.TestWO w left join JDE_DB_Alan.TestCO c 
		       on w.WONumber = c.RelatedWONum

     )
   ,tbl as ( select tb.*,m.StockingType,m.WholeSalePrice,m.Description
				from tb left join JDE_DB_Alan.vw_Mast m
                        on tb.ItemNumber = m.ItemNumber
						)
            

    select * from tbl


 select *  from JDE_DB_Alan.FCPRO_Fcst f where f.ItemNumber in ('38.001.001') and f.DataType1 like ('%adj%')         
  select fh.ItemNumber,fh.Date,fh.myDate2,fh.myReportDate1,fh.myReportDate2,fh.myReportDate3,fh.myReportDate4   from JDE_DB_Alan.vw_FC_Hist fh    where fh.ItemNumber in ('38.001.001') 
   select max(fh.reportdate)
   from JDE_DB_Alan.vw_FC_Hist fh 
  where fh.ItemNumber in ('38.001.001') 
        and fh.myDate2 = '201810' 



----------------------------------------------------------
exec JDE_DB_Alan.sp_FCPro_FC_Accy_Rpt 'non-lt'
select * from JDE_DB_Alan.FCPRO_Fcst_Accuracy y where y.Item in ('42.210.031') order by y.DataType desc,y.Item
		 

----------- Isolate Textfile forecast 15/1/2019 -----------------------------------
select * from JDE_DB_Alan.vw_Mast;

with _t as (
			select m.PlannerNumber,m.Owner_,StockingType,count(m.ItemNumber) as SKU_Cnt
			from JDE_DB_Alan.vw_Mast m
			group by m.PlannerNumber,m.Owner_,StockingType
			--order by m.PlannerNumber,SKU_Cnt desc
			)
      ,t_ as ( select t.PlannerNumber,t.Owner_,t.StockingType,t.SKU_Cnt
	                  ,sum(t.SKU_Cnt) over ( partition by t.plannerNumber order by t.SKU_Cnt ) as RunnTTL
	            from _t as t 
				)
      select * from t_
	  order by t_.PlannerNumber desc


select 155832/24

;with fc as (
	select f.*,p.Pareto 
	from JDE_DB_Alan.FCPRO_Fcst f left join JDE_DB_Alan.FCPRO_Fcst_Pareto p on f.ItemNumber = p.ItemNumber
	where f.DataType1 like ('%Adj_FC')		 
	)
select fc.ItemNumber,fc.DataType1,fc.Date,fc.value as QTY,fc.Value * m.WholeSalePrice as FC_Revenue,m.PlannerNumber,m.Owner_
       ,m.UOM
	   ,m.FamilyGroup_,m.Family_0
	   ,fc.Pareto
  from fc left join JDE_DB_Alan.vw_Mast m on fc.ItemNumber = m.ItemNumber
  where m.PlannerNumber in ('20003')



  ---

  select * from JDE_DB_Alan.Master_ML345 m where m.ItemNumber in ('09.400.951','09.566.000','82.865.000')



  select * from JDE_DB_Alan.vw_Hist_RM r
  where r.ItemNumber in ('09.400.951')

  select distinct fh.ItemNumber,fh.ReportDate  from JDE_DB_Alan.vw_FC_Hist fh 
  where fh.ReportDate between '2019-01-01 13:20' and '2019-01-10 17:39:00'
    

 select * from JDE_DB_Alan.vw_Mast m where m.ItemNumber like ('%171%')

---
select distinct fh.ItemNumber
from JDE_DB_Alan.vw_FC_Hist fh 
where fh.ReportDate  > '2019-01-10' and fh.ReportDate < '2019-02-10'

select fh.ItemNumber,count(fh.DataType1) cnt
from JDE_DB_Alan.vw_FC_Hist fh 
where fh.ReportDate  > '2019-01-05' and fh.ReportDate < '2019-02-01'
group by fh.ItemNumber


select distinct fh.ItemNumber,ReportDate 
from JDE_DB_Alan.vw_FC_Hist fh 
where fh.ReportDate  > '2019-01-20'
      and fh.ItemNumber in ('82.068.930')


------------------------
   ------ Modifiers  Manupilation ------ 8/10/2019

   with x as 
    ( select * 
	   from JDE_DB_Alan.FCPRO_Modifiers_tmp t
	   
      )
   ,_tb as 
   (
	select  t.*,c.ItemNumber as itm ,c.Comment,c.LastUpdated,c.Modifier as modifier_,c.ReportDate
		from JDE_DB_Alan.FCPRO_Modifiers_tmp t full outer join JDE_DB_Alan.FCPRO_Modifiers_cmt c on t.ItemNumber = c.ItemNumber
	   )
   ,tb_ as 
      ( select _tb.*,m.StockingType 
		from _tb left join JDE_DB_Alan.vw_Mast m on _tb.ItemNumber = m.ItemNumber )

   select * from tb_
   

   ----------------------- Sales Order Super Inquiry ------------------------- 17/10/2019

   select * from JDE_DB_Alan.SO_Inquiry_Super
   select * from JDE_DB_Alan.vw_SO_Inquiry_Super s where s.Item_Number in ('43.207.637M','46.598.000')
   select s.Item_Number,s.Description,s.Qty_Ordered,s.YM_Req,s.Extended_Cost,s.Extended_Price from JDE_DB_Alan.vw_SO_Inquiry_Super s

   ;with OpenSO as 
		 ( select 'OpenSO' as Datatype,s.Item_Number,s.Qty_Ordered_LowestLvl,s.Date_Req as Date_
			from JDE_DB_Alan.vw_SO_Inquiry_Super s 
			where s.LastStatus in ('520','540','900','902','904')					-- '520' Sales order entered;'540' Ready to pick;'900' Back order in S/O Entry
         )     
   ,SaleSO as 
		 ( select 'SaleSO' as Datatype ,s.Item_Number,s.Qty_Ordered_LowestLvl,s.Date_Req as Date_
			from JDE_DB_Alan.vw_SO_Inquiry_Super s 
			where s.LastStatus not in ('520','540','900','902','904')				
			--where s.LastStatus in ('902','904','912','980')	-- '902' Backorder in Commitments;'904' Backorder in Ship. Conf.;'912'Added in Commitments';'980' Canceled in Order Entry
         )     

   ,fc as ( select 'FC' as Datatype,f.ItemNumber,f.FC_Vol,f.FCDate2_
				from JDE_DB_Alan.vw_FC f left join JDE_DB_Alan.vw_Mast m on f.ItemNumber = m.ItemNumber				
				)   
   ,comb as ( select * from OpenSO 
            union all
			select * from SaleSO
			union all
			select * from fc
			)
   
   select c.*,m.Description,m.FamilyGroup,m.Family,m.StockingType,m.UOM
    from comb c left join JDE_DB_Alan.vw_Mast m on c.Item_Number = m.ItemNumber
	where m.FamilyGroup in ('913') and m.Family in ('X06','X07')




----- ALWAYS ENTER YOUR CODE ABOVE THIS LINE -------- ----- ALWAYS ENTER YOUR CODE ABOVE THIS LINE -------- ----- ALWAYS ENTER YOUR CODE ABOVE THIS LINE --------
----- NEVER ENTER YOUR CODE BELOW THIS LINE --------- ----- NEVER ENTER YOUR CODE BELOW THIS LINE --------- ----- NEVER ENTER YOUR CODE BELOW THIS LINE ---------

 ---&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&------------------
-- END_EXIT:

-- last line of the script
set noexec off -- Turn execution back on; only needed in SSMS, so as to be able 
               -- to run this script again in the same session.



