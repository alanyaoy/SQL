
use JDE_DB_Alan
go


with cte as (
							select f.ItemNumber,convert(varchar(6),f.Date,112) as Period_YM,f.Value,'Adj_FC' as Typ_
							 from JDE_DB_Alan.FCPRO_Fcst f 
							 --where s.ItemNumber in (select ids from @ItemIDs)
							 --where f.ItemNumber in ('40.033.131')
							   where f.DataType1 in ('Adj_FC')				--- 26/2/2018
							union all
							select s.ItemNumber,convert(varchar(6),convert(datetime,concat(s.CYM,'01')),112) Period_YM,s.SalesQty,'Sales' as Typ_
							from JDE_DB_Alan.SlsHist_AWFHDMT_FCPro_upload s 
							--where s.ItemNumber in (select ids from @ItemIDs)
							--where s.ItemNumber in ('40.033.131')
						 ) 
						 ,comb_ as ( select cte.ItemNumber,cte.Typ_,cte.Period_YM,cte.Value,m.StandardCost,m.WholeSalePrice,p.Pareto,m.UOM,m.PrimarySupplier 					
										,m.PlannerNumber
										,m.SellingGroup,m.FamilyGroup,m.Family
										,case m.PlannerNumber when '20072' then 'Salmon Saeed'
															 when '20004' then 'Margaret Dost'	
															 when '20005' then 'Imelda Chan'
															 when '20071' then 'Domenic Cellucci'
															 else 'Unknown'
											end as Owner_
									from cte left join JDE_DB_Alan.Master_ML345 m on cte.ItemNumber = m.ItemNumber
										 left join JDE_DB_Alan.FCPRO_Fcst_Pareto p on cte.Itemnumber = p.ItemNumber
							  	    where 
								 		--m.PrimarySupplier in ( select data from JDE_DB_Alan.dbo.Split(@Supplier_id,','))
										-- cte.ItemNumber in ( select splitdata from JDE_DB_Alan.dbo.fnSplitString(@Item_id,','))
									--	cte.ItemNumber in ('82.691.901')
									--	cte.ItemNumber in ('22.689.091','22.745.091','22.748.091','22.749.091','6000030009001H','6000030009001HCL','6000030009002H','6000030009002HCL','6000030009003H','6000030009003HCL','6000030009004H','6000030009004HCL','6000030009005H','6000030009005HCL','6000030009006H','6000030009006HCL','6000030009007H','6000030009007HCL','6000030009008H','6000030009008HCL','6000030009009H','6000030009009HCL','6000030009010HCL','6000030009011H','6000030009011HCL','6000030009012H','6000030009012HCL','6000130009001H','6000130009001HCL','6000130009002H','6000130009002HCL','6000130009003H','6000130009003HCL','6000130009004H','6000130009004HCL','6000130009005H','6000130009005HCL','6000130009006H','6000130009006HCL','6000130009007H','6000130009007HCL','6000130009008H','6000130009008HCL','6000130009009H','6000130009009HCL','6000130009010H','6000130009010HCL','6000130009011H','6000130009011HCL','6000130009012H','6000130009012HCL','6001030009007H','6001030009007HCL','6001030009009H','6001030009009HCL','6001030009010H','6001030009010HCL','6001030009011H','6001030009011HCL','6001030009019H','6001030009019HCL','6001030009020H','6001030009020HCL','6001030009021H','6001030009021HCL','6001030009022H','6001030009022HCL','6001030009023H','6001030009023HCL','6001130009007H','6001130009007HCL','6001130009009H','6001130009009HCL','6001130009010H','6001130009010HCL','6001130009011H','6001130009011HCL','6001130009019H','6001130009019HCL','6001130009020H','6001130009020HCL','6001130009021H','6001130009021HCL','6001130009022H','6001130009022HCL','6001130009023H','6001130009023HCL','6004030009038HCL','6004030009041HCL','6004030009049HCL','6004030009050HCL','6004129009038HCL','6004129009041HCL','6004129009049HCL','6004129009050HCL','82.201.901','82.201.906','82.201.908','82.201.915','82.201.917','82.201.922','82.201.934','82.201.935','82.201.937','82.201.950','82.201.952','82.301.901','82.301.902','82.301.903','82.301.906','82.301.908','82.301.909','82.301.912','82.301.913','82.301.915','82.301.916','82.301.917','82.301.919','82.301.920','82.301.922','82.301.935','82.301.937','82.311.901','82.311.906','82.311.908','82.311.915','82.311.917','82.311.922','82.336.901','82.336.902','82.336.903','82.336.905','82.336.906','82.336.907','82.336.908','82.336.909','82.336.910','82.336.911','82.336.912','82.336.913','82.336.915','82.336.916','82.336.918','82.374.901','82.374.906','82.390.901','82.390.902','82.390.907','82.390.908','82.390.909','82.390.910','82.390.911','82.390.921','82.390.921CL','82.390.922','82.390.922CL','82.390.923','82.390.923CL','82.390.924','82.390.924CL','82.390.925','82.390.925CL','82.390.927','82.390.927CL','82.390.928','82.390.928CL','82.410.901','82.410.902','82.410.903','82.410.904','82.410.905','82.412.901','82.412.902','82.412.903','82.413.901','82.413.902','82.413.903','82.413.904','82.413.905','82.416.901','82.416.901CL','82.416.902','82.416.902CL','82.416.903','82.416.903CL','82.416.904','82.416.904CL','82.416.905','82.416.905CL','82.416.906','82.416.906CL','82.416.907','82.416.907CL','82.416.908','82.416.908CL','82.416.909','82.416.909CL','82.416.910','82.416.910CL','82.417.901','82.417.901CL','82.417.902','82.417.902CL','82.417.903','82.417.903CL','82.417.904','82.417.904CL','82.417.905','82.417.905CL','82.417.906','82.417.906CL','82.417.907','82.417.907CL','82.417.908','82.417.908CL','82.417.909','82.417.909CL','82.417.910','82.417.910CL','82.418.903CL','82.419.901','82.419.910CL','82.431.901','82.431.902','82.431.903','82.431.904','82.431.905','82.431.906','82.431.907','82.431.908','82.431.909','82.431.911','82.431.913','82.496.934','82.496.935','82.496.936','82.501.901','82.501.902','82.501.903','82.501.904','82.501.904CL','82.501.905','82.501.905CL','82.501.906','82.501.907','82.501.907CL','82.501.908','82.501.909','82.501.910','82.502.901','82.502.901CL','82.502.902','82.502.903','82.502.904','82.502.904CL','82.502.905','82.502.905CL','82.502.906','82.502.906CL','82.502.907','82.502.907CL','82.502.908','82.502.908CL','82.502.909','82.502.909CL','82.502.910','82.504.905CL','82.536.901','82.536.902','82.536.903','82.536.905','82.536.906','82.536.909','82.536.915','82.536.918','82.600.901','82.600.901CL','82.600.902','82.600.902CL','82.600.903','82.600.903CL','82.600.904','82.600.904CL','82.600.905','82.600.905CL','82.600.906','82.600.906CL','82.600.907','82.600.907CL','82.600.908','82.600.908CL','82.601.901','82.601.901CL','82.601.902','82.601.902CL','82.601.903','82.601.903CL','82.601.905','82.601.905CL','82.601.906','82.601.906CL','82.601.907','82.601.907CL','82.601.908','82.601.908CL','82.602.901','82.602.901CL','82.602.902','82.602.902CL','82.602.903','82.602.903CL','82.602.904','82.602.905','82.602.905CL','82.602.906','82.602.906CL','82.602.907','82.602.907CL','82.602.908','82.602.908CL','82.604.901','82.604.901CL','82.604.902','82.604.902CL','82.604.903','82.604.903CL','82.604.904','82.604.904CL','82.604.905','82.604.905CL','82.604.906','82.604.906CL','82.605.901','82.605.901CL','82.605.902','82.605.902CL','82.605.903','82.605.903CL','82.605.904','82.605.904CL','82.605.905','82.605.905CL','82.605.906','82.605.906CL','82.610.901','82.610.902','82.611.904','82.612.901','82.612.902','82.612.903','82.612.904','82.613.901','82.613.902','82.614.901','82.614.902','82.614.903','82.614.904','82.615.901','82.615.902','82.615.903','82.615.904','82.633.901','82.633.901CL','82.633.902','82.633.902CL','82.633.903','82.633.903CL','82.633.904','82.633.904CL','82.633.905','82.633.905CL','82.633.906','82.633.906CL','82.633.907','82.633.907CL','82.633.908','82.633.908CL','82.633.909','82.633.909CL','82.691.901','82.691.902','82.691.903','82.691.904','82.691.905','82.691.906','82.691.907','82.691.908','82.691.909','82.691.910','82.691.911','82.691.912','82.691.919','82.691.926','82.691.927','82.691.928','82.691.929','82.691.930','82.691.931','82.691.932','82.691.933','82.696.901','82.696.902','82.696.903','82.696.904','82.696.905','82.696.906','82.696.907','82.696.908','82.696.909','82.696.910','82.696.911','82.696.912','82.696.913','82.696.914','82.696.915','82.696.918','82.696.919','82.696.920','82.696.921','82.696.922','82.696.923','82.696.924','82.696.925','82.696.926','82.696.927','82.696.928','82.696.929','82.696.930','82.696.931','82.696.932','82.696.933','82.696.934','82.696.941','8328001H','8328001HCL','8328002H','8328002HCL','8SCA300BIH','8SCA300BIHCL','8SCA300COHCL','8SCA300LQH','8SCA300LQHCL','8SCA300OYH','8SCA300OYHCL','8SCA300PRH','8SCA300PRHCL','8SCA300SBH','8SCA300SBHCL','8SCA300SUH','8SCA300SUHCL','8SCA300TREHCL','8SCA3300BIH','8SCA3300BIHCL','8SCA3300COH','8SCA3300COHCL','8SCA3300LQH','8SCA3300LQHCL','8SCA3300OYH','8SCA3300OYHCL','8SCA3300PRH','8SCA3300PRHCL','8SCA3300SBH','8SCA3300SBHCL','8SCA3300SUH','8SCA3300SUHCL','8SCA3300TREH','8SCA3300TREHCL','CL.B1020.280.CW','CL.B1022.280.SD','CL.B1023.280.LI','CL.B1024.280.SN','CL.B1029.280.CC','CL.T1000.280.CW','CL.T1001.280.LW','CL.T1002.280.SD','CL.T1003.280.LI','CL.T1009.280.CC','FA.B1020.280.CW','FA.B1021.280.LW','FA.B1022.280.SD','FA.B1023.280.LI','FA.B1024.280.SN','FA.B1029.280.CC','FA.B1030.280.LU','FA.B1031.280.SL','FA.B1032.280.TW','FA.T1000.280.CW','FA.T1001.280.LW','FA.T1002.280.SD','FA.T1003.280.LI','FA.T1004.280.SN','FA.T1009.280.CC','FA.T1010.280.LU','FA.T1012.280.TW','0751031000202H','0751031000202HCL','0751031000207H','0751031000207HCL','0751031003001H','0751031003001HCL','0751031003030H','0751031003030HCL','0751031003061H','0751031003061HCL','0770531003531H','0770531003531HCL','0770531003532H','0770531003532HCL','0770531003535H','0770531003535HCL','0850520000202HCL','0850520000221HCL','0850520003001HCL','0850520003010HCL','0850525000202H','0850525000202HCL','0850525000207H','0850525000207HCL','0850525000220H','0850525000220HCL','0850525000221HCL','0850525000222H','0850525000222HCL','0850525000707H','0850525000707HCL','0850525000710HCL','0850525000720HCL','0850525002022HCL','0850525003001H','0850525003001HCL','0850525003010HCL','0850525003020H','0850525003020HCL','0850525003021H','0850525003021HCL','0850525003030H','0850525003030HCL','0850525003061H','0850525003061HCL','085052500M178H','085052500M178HCL','0850531000202H','0850531000202HCL','0850531000207H','0850531000207HCL','0850531000220H','0850531000220HCL','0850531000221H','0850531000221HCL','0850531000222H','0850531000222HCL','0850531000707H','0850531000707HCL','0850531000710HCL','0850531000720H','0850531000720HCL','0850531002022H','0850531002022HCL','0850531003001H','0850531003001HCL','0850531003010H','0850531003010HCL','0850531003020H','0850531003020HCL','0850531003021H','0850531003021HCL','0850531003030H','0850531003030HCL','0850531003061H','0850531003061HCL','085053100M178H','085053100M178HCL','085552500D064','085552500D064CL','085552500D088','085552500D088CL','085552500D137','085552500D137CL','085552500D212','085552500D212CL','085552500D249','085552500D249CL','085552500D337','085552500D337CL','22.747.091','43.205.532M','43.205.532MCL','43.205.535MCL','43.205.536M','43.205.536MCL','43.205.537MCL','43.205.563MCL','43.205.565CL','43.205.568MCL','43.205.569MCL','43.205.570MCL','43.205.574M','43.205.574MCL','43.205.582M','43.205.582MCL','43.205.584M','43.205.584MCL','43.205.635M','43.205.637M','43.205.663M','43.205.663MCL','43.207.532M','43.207.532MCL','43.207.535MCL','43.207.536M','43.207.536MCL','43.207.537MCL','43.207.565M','43.207.565MCL','43.207.582M','43.207.582MCL','43.207.584M','43.207.584MCL','43.207.635M','43.207.637M','43.211.001','43.211.001CL','43.211.002','43.211.002CL','43.211.003','43.211.004','43.211.004CL','43.211.005','43.211.005CL','43.211.006','43.211.006CL','43.212.001','43.212.002','43.212.002CL','43.212.003','43.212.004','43.212.004CL','43.295.530','43.295.530CL','43.295.532','43.295.532CL','43.295.535','43.295.535CL','43.295.536','43.295.536CL','43.295.537','43.295.537CL','43.471.535','43.477.536','43.477.537','43.479.532','43.525.101','43.525.102','43.525.103','43.525.105','43.525.107','43.525.403','43.525.404','43.525.405','43.530.101','43.530.102','43.530.103','43.530.105','43.530.107','43.530.403','43.530.404','43.530.405','S3000NET5250N001CL','S3000NET5250N002CL','S3000NET5250N003CL','S3000NET5250N010CL','S3000NET5250N012CL','S3000NET5250N025CL','S3000NET5250N201CL','S3000NET5250N301CL','S3000NET5250N901CL','S3000NET5250N903CL','S3000NET5250N904CL','S3000NET5300N001CL','S3000NET5300N002CL','S3000NET5300N003CL','S3000NET5300N010CL','S3000NET5300N012CL','S3000NET5300N025CL','S3000NET5300N0ALCL','S3000NET5300N0PWCL','S3000NET5300N0SSCL','S3000NET5300N201CL','S3000NET5300N301CL','S3000NET5300N901CL','S3000NET5300N902CL','S3000NET5300N903CL','S3000NET5300N904CL','S3000NET5300NAMBCL','S3000NET5300NMMSCL','S3000NET5300NMTSCL','S3000NET5300NPMBCL','S3000NET5300NSAPCL','S3000NET5300NWWPCL','S3000RR3250RR10CL','S3000RR3250RR13CL','S3000RR3250RR23CL','S3000RR3250RR28CL','S3000RR3250RR44CL','S3000RR3250RR46CL','S3000RR3250RR71CL','S3000RR3250RR72CL','S3000RR3250RR84CL','S3000RR3250RR90CL','S3000RR3250RR94CL','S3000RR3250RR98CL','S3000RR3250RRE3CL','S3000RR3250RRE4CL','S3000RR3300RR10CL','S3000RR3300RR12CL','S3000RR3300RR71CL','S3000RR3300RR72CL','S3000RR3300RR84CL','S3000RR3300RR90CL','S3000RR3300RR94CL','S3000RR3300RRE4CL','SSDLS5300ATSCL','SSDLS5300PSCL','SSDLS5300SDCL','SSDLS5300SMBCL','32.379.200','32.455.155','24.7121.0155','24.7100.0199','32.340.000','24.7122.0155','24.7127.0155','24.7120.0155','24.7200.0001','24.7125.0155','24.7002.0001','24.7121.1858','24.7110.0155','24.7100.1858','32.455.855','24.7122.1858','24.7120.1858','24.7127.1858','24.7124.0155','24.7102.0199','24.7201.0000','24.7100.7052A','24.7125.1858','24.7121.0952A','24.5411.0000','24.5398.0000','24.5404.0000','24.7127.0952','24.7100.4459A','24.5358.0000','32.455.460','24.7102.1858','24.7334.0199','24.5403.0000','24.7128.0155','24.7121.4459A','24.7121.0952','24.7002.0001T','24.7127.4459','32.455.462','24.7219.0952','24.7120.0952A','24.7002.0000T','24.5399.0000','24.5426.0204','24.7122.0952A','24.7200.0001T','32.341.155','24.7110.1858','24.7201.0000T','24.7125.0952A','24.7121.4459','24.5353.0204','32.455.461','24.5427.0204','24.7120.4459A','24.7128.0155A','24.7122.4459A','24.7364.0199','24.7333.0199','24.7124.1858','24.7120.0952','24.7200.0000','24.7125.4459A','24.7219.0199','24.7002.0000','24.5414.0000','24.7122.0952','24.5415.0000','24.5397.0000','24.7202.0000','24.5425.0204','24.7120.4459','24.7122.4459','24.5416.0000','24.7128.1858A','24.7219.1858','24.7124.0952','24.7202.0001','24.5418.0000','24.7334.1858','24.5349.0204','24.7124.4459','24.7334.0952','24.7219.4459','24.5417.0000','24.5405.0000','24.7110.0952','24.7334.4459','32.341.855','24.7333.1858','24.7102.7052A','24.7114.0155','24.7110.0952A','24.7128.0952A','24.7333.0952','24.7128.1858','24.5396.0000','24.5426.1858','24.7114.1858','24.5353.1858','24.5427.1858','24.7110.4459','24.5427.4459','24.5424.0204','24.5426.4459','24.5349.1858','24.5413.0000','24.7364.1858','24.7363.0199','32.455.465','24.7110.4459A','24.7333.4459','24.7128.0952','24.7124.0952A','24.7200.0000T','24.7125.0952','24.5353.4459','24.7219.4464','24.5425.1858','24.7363.1858','24.5425.4459','32.341.176','24.7364.0952','24.7102.4459A','24.5354.1858','24.5427.0952','24.5354.0204','24.5426.0952','24.7114.0952A','24.7219.4460','24.5412.0000','24.5353.0952','24.7125.4459','24.7219.4462','24.7364.4459','24.5349.4459','24.7128.4459A','24.7124.4459A','24.5425.0952','24.7128.4459','24.5360.1858','24.5424.1858','24.7114.4459A','24.5349.0952','24.7307.1858','24.7201.0002','24.5424.4459','24.5354.0952','24.5424.0952','24.5354.4459','24.7219.4465','24.5361.1858','24.5360.0204','24.7363.0952','24.7300.7060','24.7196.7060A','24.7363.4459','24.7116.0155','24.7193.0199A','24.7195.0199A','24.7195.1858A','24.5362.0204','24.5110.7178','24.5362.1858','24.5361.0204','24.5363.1858','24.5363.0204','24.7102.7052','24.7192.7060A')
									
									-- 982 fabric -- 494 SKUs ( 24 months )
									--cte.ItemNumber in ('22.689.091','22.745.091','22.748.091','22.749.091','6000030009001H','6000030009001HCL','6000030009002H','6000030009002HCL','6000030009003H','6000030009003HCL','6000030009004H','6000030009004HCL','6000030009005H','6000030009005HCL','6000030009006H','6000030009006HCL','6000030009007H','6000030009007HCL','6000030009008H','6000030009008HCL','6000030009009H','6000030009009HCL','6000030009010HCL','6000030009011H','6000030009011HCL','6000030009012H','6000030009012HCL','6000130009001H','6000130009001HCL','6000130009002H','6000130009002HCL','6000130009003H','6000130009003HCL','6000130009004H','6000130009004HCL','6000130009005H','6000130009005HCL','6000130009006H','6000130009006HCL','6000130009007H','6000130009007HCL','6000130009008H','6000130009008HCL','6000130009009H','6000130009009HCL','6000130009010H','6000130009010HCL','6000130009011H','6000130009011HCL','6000130009012H','6000130009012HCL','6001030009007H','6001030009007HCL','6001030009009H','6001030009009HCL','6001030009010H','6001030009010HCL','6001030009011H','6001030009011HCL','6001030009019H','6001030009019HCL','6001030009020H','6001030009020HCL','6001030009021H','6001030009021HCL','6001030009022H','6001030009022HCL','6001030009023H','6001030009023HCL','6001130009007H','6001130009007HCL','6001130009009H','6001130009009HCL','6001130009010H','6001130009010HCL','6001130009011H','6001130009011HCL','6001130009019H','6001130009019HCL','6001130009020H','6001130009020HCL','6001130009021H','6001130009021HCL','6001130009022H','6001130009022HCL','6001130009023H','6001130009023HCL','6004030009038HCL','6004030009041HCL','6004030009049HCL','6004030009050HCL','6004129009038HCL','6004129009041HCL','6004129009049HCL','6004129009050HCL','82.201.901','82.201.906','82.201.908','82.201.915','82.201.917','82.201.922','82.201.934','82.201.935','82.201.937','82.201.950','82.201.952','82.301.901','82.301.902','82.301.903','82.301.906','82.301.908','82.301.909','82.301.912','82.301.913','82.301.915','82.301.916','82.301.917','82.301.919','82.301.920','82.301.922','82.301.935','82.301.937','82.311.901','82.311.906','82.311.908','82.311.915','82.311.917','82.311.922','82.336.901','82.336.902','82.336.903','82.336.905','82.336.906','82.336.907','82.336.908','82.336.909','82.336.910','82.336.911','82.336.912','82.336.913','82.336.915','82.336.916','82.336.918','82.374.901','82.374.906','82.390.901','82.390.902','82.390.907','82.390.908','82.390.909','82.390.910','82.390.911','82.390.921','82.390.921CL','82.390.922','82.390.922CL','82.390.923','82.390.923CL','82.390.924','82.390.924CL','82.390.925','82.390.925CL','82.390.927','82.390.927CL','82.390.928','82.390.928CL','82.410.901','82.410.902','82.410.903','82.410.904','82.410.905','82.412.901','82.412.902','82.412.903','82.413.901','82.413.902','82.413.903','82.413.904','82.413.905','82.416.901','82.416.901CL','82.416.902','82.416.902CL','82.416.903','82.416.903CL','82.416.904','82.416.904CL','82.416.905','82.416.905CL','82.416.906','82.416.906CL','82.416.907','82.416.907CL','82.416.908','82.416.908CL','82.416.909','82.416.909CL','82.416.910','82.416.910CL','82.417.901','82.417.901CL','82.417.902','82.417.902CL','82.417.903','82.417.903CL','82.417.904','82.417.904CL','82.417.905','82.417.905CL','82.417.906','82.417.906CL','82.417.907','82.417.907CL','82.417.908','82.417.908CL','82.417.909','82.417.909CL','82.417.910','82.417.910CL','82.418.903CL','82.419.901','82.419.910CL','82.431.901','82.431.902','82.431.903','82.431.904','82.431.905','82.431.906','82.431.907','82.431.908','82.431.909','82.431.911','82.431.913','82.496.934','82.496.935','82.496.936','82.501.901','82.501.902','82.501.903','82.501.904','82.501.904CL','82.501.905','82.501.905CL','82.501.906','82.501.907','82.501.907CL','82.501.908','82.501.909','82.501.910','82.502.901','82.502.901CL','82.502.902','82.502.903','82.502.904','82.502.904CL','82.502.905','82.502.905CL','82.502.906','82.502.906CL','82.502.907','82.502.907CL','82.502.908','82.502.908CL','82.502.909','82.502.909CL','82.502.910','82.504.905CL','82.536.901','82.536.902','82.536.903','82.536.905','82.536.906','82.536.909','82.536.915','82.536.918','82.600.901','82.600.901CL','82.600.902','82.600.902CL','82.600.903','82.600.903CL','82.600.904','82.600.904CL','82.600.905','82.600.905CL','82.600.906','82.600.906CL','82.600.907','82.600.907CL','82.600.908','82.600.908CL','82.601.901','82.601.901CL','82.601.902','82.601.902CL','82.601.903','82.601.903CL','82.601.905','82.601.905CL','82.601.906','82.601.906CL','82.601.907','82.601.907CL','82.601.908','82.601.908CL','82.602.901','82.602.901CL','82.602.902','82.602.902CL','82.602.903','82.602.903CL','82.602.904','82.602.905','82.602.905CL','82.602.906','82.602.906CL','82.602.907','82.602.907CL','82.602.908','82.602.908CL','82.604.901','82.604.901CL','82.604.902','82.604.902CL','82.604.903','82.604.903CL','82.604.904','82.604.904CL','82.604.905','82.604.905CL','82.604.906','82.604.906CL','82.605.901','82.605.901CL','82.605.902','82.605.902CL','82.605.903','82.605.903CL','82.605.904','82.605.904CL','82.605.905','82.605.905CL','82.605.906','82.605.906CL','82.610.901','82.610.902','82.611.904','82.612.901','82.612.902','82.612.903','82.612.904','82.613.901','82.613.902','82.614.901','82.614.902','82.614.903','82.614.904','82.615.901','82.615.902','82.615.903','82.615.904','82.633.901','82.633.901CL','82.633.902','82.633.902CL','82.633.903','82.633.903CL','82.633.904','82.633.904CL','82.633.905','82.633.905CL','82.633.906','82.633.906CL','82.633.907','82.633.907CL','82.633.908','82.633.908CL','82.633.909','82.633.909CL','82.691.901','82.691.902','82.691.903','82.691.904','82.691.905','82.691.906','82.691.907','82.691.908','82.691.909','82.691.910','82.691.911','82.691.912','82.691.919','82.691.926','82.691.927','82.691.928','82.691.929','82.691.930','82.691.931','82.691.932','82.691.933','82.696.901','82.696.902','82.696.903','82.696.904','82.696.905','82.696.906','82.696.907','82.696.908','82.696.909','82.696.910','82.696.911','82.696.912','82.696.913','82.696.914','82.696.915','82.696.918','82.696.919','82.696.920','82.696.921','82.696.922','82.696.923','82.696.924','82.696.925','82.696.926','82.696.927','82.696.928','82.696.929','82.696.930','82.696.931','82.696.932','82.696.933','82.696.934','82.696.941','8328001H','8328001HCL','8328002H','8328002HCL','8SCA300BIH','8SCA300BIHCL','8SCA300COHCL','8SCA300LQH','8SCA300LQHCL','8SCA300OYH','8SCA300OYHCL','8SCA300PRH','8SCA300PRHCL','8SCA300SBH','8SCA300SBHCL','8SCA300SUH','8SCA300SUHCL','8SCA300TREHCL','8SCA3300BIH','8SCA3300BIHCL','8SCA3300COH','8SCA3300COHCL','8SCA3300LQH','8SCA3300LQHCL','8SCA3300OYH','8SCA3300OYHCL','8SCA3300PRH','8SCA3300PRHCL','8SCA3300SBH','8SCA3300SBHCL','8SCA3300SUH','8SCA3300SUHCL','8SCA3300TREH','8SCA3300TREHCL','CL.B1020.280.CW','CL.B1022.280.SD','CL.B1023.280.LI','CL.B1024.280.SN','CL.B1029.280.CC','CL.T1000.280.CW','CL.T1001.280.LW','CL.T1002.280.SD','CL.T1003.280.LI','CL.T1009.280.CC','FA.B1020.280.CW','FA.B1021.280.LW','FA.B1022.280.SD','FA.B1023.280.LI','FA.B1024.280.SN','FA.B1029.280.CC','FA.B1030.280.LU','FA.B1031.280.SL','FA.B1032.280.TW','FA.T1000.280.CW','FA.T1001.280.LW','FA.T1002.280.SD','FA.T1003.280.LI','FA.T1004.280.SN','FA.T1009.280.CC','FA.T1010.280.LU','FA.T1012.280.TW')
								
									-- 986 fabric -- 231 SKUs ( 24 months ) + 190 SKUs ( hardware )
									--cte.ItemNumber in  ('0751031000202H','0751031000202HCL','0751031000207H','0751031000207HCL','0751031003001H','0751031003001HCL','0751031003030H','0751031003030HCL','0751031003061H','0751031003061HCL','0770531003531H','0770531003531HCL','0770531003532H','0770531003532HCL','0770531003535H','0770531003535HCL','0850520000202HCL','0850520000221HCL','0850520003001HCL','0850520003010HCL','0850525000202H','0850525000202HCL','0850525000207H','0850525000207HCL','0850525000220H','0850525000220HCL','0850525000221HCL','0850525000222H','0850525000222HCL','0850525000707H','0850525000707HCL','0850525000710HCL','0850525000720HCL','0850525002022HCL','0850525003001H','0850525003001HCL','0850525003010HCL','0850525003020H','0850525003020HCL','0850525003021H','0850525003021HCL','0850525003030H','0850525003030HCL','0850525003061H','0850525003061HCL','085052500M178H','085052500M178HCL','0850531000202H','0850531000202HCL','0850531000207H','0850531000207HCL','0850531000220H','0850531000220HCL','0850531000221H','0850531000221HCL','0850531000222H','0850531000222HCL','0850531000707H','0850531000707HCL','0850531000710HCL','0850531000720H','0850531000720HCL','0850531002022H','0850531002022HCL','0850531003001H','0850531003001HCL','0850531003010H','0850531003010HCL','0850531003020H','0850531003020HCL','0850531003021H','0850531003021HCL','0850531003030H','0850531003030HCL','0850531003061H','0850531003061HCL','085053100M178H','085053100M178HCL','085552500D064','085552500D064CL','085552500D088','085552500D088CL','085552500D137','085552500D137CL','085552500D212','085552500D212CL','085552500D249','085552500D249CL','085552500D337','085552500D337CL','22.747.091','43.205.532M','43.205.532MCL','43.205.535MCL','43.205.536M','43.205.536MCL','43.205.537MCL','43.205.563MCL','43.205.565CL','43.205.568MCL','43.205.569MCL','43.205.570MCL','43.205.574M','43.205.574MCL','43.205.582M','43.205.582MCL','43.205.584M','43.205.584MCL','43.205.635M','43.205.637M','43.205.663M','43.205.663MCL','43.207.532M','43.207.532MCL','43.207.535MCL','43.207.536M','43.207.536MCL','43.207.537MCL','43.207.565M','43.207.565MCL','43.207.582M','43.207.582MCL','43.207.584M','43.207.584MCL','43.207.635M','43.207.637M','43.211.001','43.211.001CL','43.211.002','43.211.002CL','43.211.003','43.211.004','43.211.004CL','43.211.005','43.211.005CL','43.211.006','43.211.006CL','43.212.001','43.212.002','43.212.002CL','43.212.003','43.212.004','43.212.004CL','43.295.530','43.295.530CL','43.295.532','43.295.532CL','43.295.535','43.295.535CL','43.295.536','43.295.536CL','43.295.537','43.295.537CL','43.471.535','43.477.536','43.477.537','43.479.532','43.525.101','43.525.102','43.525.103','43.525.105','43.525.107','43.525.403','43.525.404','43.525.405','43.530.101','43.530.102','43.530.103','43.530.105','43.530.107','43.530.403','43.530.404','43.530.405','S3000NET5250N001CL','S3000NET5250N002CL','S3000NET5250N003CL','S3000NET5250N010CL','S3000NET5250N012CL','S3000NET5250N025CL','S3000NET5250N201CL','S3000NET5250N301CL','S3000NET5250N901CL','S3000NET5250N903CL','S3000NET5250N904CL','S3000NET5300N001CL','S3000NET5300N002CL','S3000NET5300N003CL','S3000NET5300N010CL','S3000NET5300N012CL','S3000NET5300N025CL','S3000NET5300N0ALCL','S3000NET5300N0PWCL','S3000NET5300N0SSCL','S3000NET5300N201CL','S3000NET5300N301CL','S3000NET5300N901CL','S3000NET5300N902CL','S3000NET5300N903CL','S3000NET5300N904CL','S3000NET5300NAMBCL','S3000NET5300NMMSCL','S3000NET5300NMTSCL','S3000NET5300NPMBCL','S3000NET5300NSAPCL','S3000NET5300NWWPCL','S3000RR3250RR10CL','S3000RR3250RR13CL','S3000RR3250RR23CL','S3000RR3250RR28CL','S3000RR3250RR44CL','S3000RR3250RR46CL','S3000RR3250RR71CL','S3000RR3250RR72CL','S3000RR3250RR84CL','S3000RR3250RR90CL','S3000RR3250RR94CL','S3000RR3250RR98CL','S3000RR3250RRE3CL','S3000RR3250RRE4CL','S3000RR3300RR10CL','S3000RR3300RR12CL','S3000RR3300RR71CL','S3000RR3300RR72CL','S3000RR3300RR84CL','S3000RR3300RR90CL','S3000RR3300RR94CL','S3000RR3300RRE4CL','SSDLS5300ATSCL','SSDLS5300PSCL','SSDLS5300SDCL','SSDLS5300SMBCL','32.379.200','32.455.155','24.7121.0155','24.7100.0199','32.340.000','24.7122.0155','24.7127.0155','24.7120.0155','24.7200.0001','24.7125.0155','24.7002.0001','24.7121.1858','24.7110.0155','24.7100.1858','32.455.855','24.7122.1858','24.7120.1858','24.7127.1858','24.7124.0155','24.7102.0199','24.7201.0000','24.7100.7052A','24.7125.1858','24.7121.0952A','24.5411.0000','24.5398.0000','24.5404.0000','24.7127.0952','24.7100.4459A','24.5358.0000','32.455.460','24.7102.1858','24.7334.0199','24.5403.0000','24.7128.0155','24.7121.4459A','24.7121.0952','24.7002.0001T','24.7127.4459','32.455.462','24.7219.0952','24.7120.0952A','24.7002.0000T','24.5399.0000','24.5426.0204','24.7122.0952A','24.7200.0001T','32.341.155','24.7110.1858','24.7201.0000T','24.7125.0952A','24.7121.4459','24.5353.0204','32.455.461','24.5427.0204','24.7120.4459A','24.7128.0155A','24.7122.4459A','24.7364.0199','24.7333.0199','24.7124.1858','24.7120.0952','24.7200.0000','24.7125.4459A','24.7219.0199','24.7002.0000','24.5414.0000','24.7122.0952','24.5415.0000','24.5397.0000','24.7202.0000','24.5425.0204','24.7120.4459','24.7122.4459','24.5416.0000','24.7128.1858A','24.7219.1858','24.7124.0952','24.7202.0001','24.5418.0000','24.7334.1858','24.5349.0204','24.7124.4459','24.7334.0952','24.7219.4459','24.5417.0000','24.5405.0000','24.7110.0952','24.7334.4459','32.341.855','24.7333.1858','24.7102.7052A','24.7114.0155','24.7110.0952A','24.7128.0952A','24.7333.0952','24.7128.1858','24.5396.0000','24.5426.1858','24.7114.1858','24.5353.1858','24.5427.1858','24.7110.4459','24.5427.4459','24.5424.0204','24.5426.4459','24.5349.1858','24.5413.0000','24.7364.1858','24.7363.0199','32.455.465','24.7110.4459A','24.7333.4459','24.7128.0952','24.7124.0952A','24.7200.0000T','24.7125.0952','24.5353.4459','24.7219.4464','24.5425.1858','24.7363.1858','24.5425.4459','32.341.176','24.7364.0952','24.7102.4459A','24.5354.1858','24.5427.0952','24.5354.0204','24.5426.0952','24.7114.0952A','24.7219.4460','24.5412.0000','24.5353.0952','24.7125.4459','24.7219.4462','24.7364.4459','24.5349.4459','24.7128.4459A','24.7124.4459A','24.5425.0952','24.7128.4459','24.5360.1858','24.5424.1858','24.7114.4459A','24.5349.0952','24.7307.1858','24.7201.0002','24.5424.4459','24.5354.0952','24.5424.0952','24.5354.4459','24.7219.4465','24.5361.1858','24.5360.0204','24.7363.0952','24.7300.7060','24.7196.7060A','24.7363.4459','24.7116.0155','24.7193.0199A','24.7195.0199A','24.7195.1858A','24.5362.0204','24.5110.7178','24.5362.1858','24.5361.0204','24.5363.1858','24.5363.0204','24.7102.7052','24.7192.7060A')

							       -- 982 fabric - LUx - 30 SKUs -- 
								  -- cte.ItemNumber in  ('82.512.901','82.512.902','82.512.903','82.516.901','82.516.902','82.516.903','82.516.904','82.516.905','82.516.906','82.516.907','82.516.908','82.517.901','82.517.902','82.517.903','82.517.904','82.517.905','82.517.906','82.517.907','82.517.908','82.518.901','82.518.902','82.519.901','82.519.902','82.515.901','82.515.902','82.515.903','82.515.904','82.515.905','82.515.906','82.515.907')   
						
						          --- 986 fabric --- need to bring fc for below code back ---
								 cte.ItemNumber in ('0751031000202H','0751031000202HCL','0751031000207H','0751031000207HCL','0751031003001H','0751031003001HCL','0751031003030H','0751031003030HCL','0751031003061H','0751031003061HCL','0770531003531H','0770531003531HCL','0770531003532H','0770531003532HCL','0770531003535H','0770531003535HCL','0850520000202HCL','0850520000221HCL','0850520003001HCL','0850520003010HCL','0850525000202H','0850525000202HCL','0850525000207H','0850525000207HCL','0850525000220H','0850525000220HCL','0850525000221HCL','0850525000222H','0850525000222HCL','0850525000707H','0850525000707HCL','0850525000710HCL','0850525000720HCL','0850525002022HCL','0850525003001H','0850525003001HCL','0850525003010HCL','0850525003020H','0850525003020HCL','0850525003021H','0850525003021HCL','0850525003030H','0850525003030HCL','0850525003061H','0850525003061HCL','085052500M178H','085052500M178HCL','0850531000202H','0850531000202HCL','0850531000207H','0850531000207HCL','0850531000220H','0850531000220HCL','0850531000221H','0850531000221HCL','0850531000222H','0850531000222HCL','0850531000707H','0850531000707HCL','0850531000710HCL','0850531000720H','0850531000720HCL','0850531002022H','0850531002022HCL','0850531003001H','0850531003001HCL','0850531003010H','0850531003010HCL','0850531003020H','0850531003020HCL','0850531003021H','0850531003021HCL','0850531003030H','0850531003030HCL','0850531003061H','0850531003061HCL','085053100M178H','085053100M178HCL','085552500D064','085552500D064CL','085552500D088','085552500D088CL','085552500D137','085552500D137CL','085552500D212','085552500D212CL','085552500D249','085552500D249CL','085552500D337','085552500D337CL','22.747.091','43.205.532M','43.205.532MCL','43.205.535MCL','43.205.536M','43.205.536MCL','43.205.537MCL','43.205.563MCL','43.205.565CL','43.205.568MCL','43.205.569MCL','43.205.570MCL','43.205.574M','43.205.574MCL','43.205.582M','43.205.582MCL','43.205.584M','43.205.584MCL','43.205.635M','43.205.637M','43.205.663M','43.205.663MCL','43.207.532M','43.207.532MCL','43.207.535MCL','43.207.536M','43.207.536MCL','43.207.537MCL','43.207.565M','43.207.565MCL','43.207.582M','43.207.582MCL','43.207.584M','43.207.584MCL','43.207.635M','43.207.637M','43.211.001','43.211.001CL','43.211.002','43.211.002CL','43.211.003','43.211.004','43.211.004CL','43.211.005','43.211.005CL','43.211.006','43.211.006CL','43.212.001','43.212.002','43.212.002CL','43.212.003','43.212.004','43.212.004CL','43.295.530','43.295.530CL','43.295.532','43.295.532CL','43.295.535','43.295.535CL','43.295.536','43.295.536CL','43.295.537','43.295.537CL','43.471.535','43.477.536','43.477.537','43.479.532','S3000NET5250N001CL','S3000NET5250N002CL','S3000NET5250N003CL','S3000NET5250N010CL','S3000NET5250N012CL','S3000NET5250N025CL','S3000NET5250N201CL','S3000NET5250N301CL','S3000NET5250N901CL','S3000NET5250N903CL','S3000NET5250N904CL','S3000NET5300N001CL','S3000NET5300N002CL','S3000NET5300N003CL','S3000NET5300N010CL','S3000NET5300N012CL','S3000NET5300N025CL','S3000NET5300N0ALCL','S3000NET5300N0PWCL','S3000NET5300N0SSCL','S3000NET5300N201CL','S3000NET5300N301CL','S3000NET5300N901CL','S3000NET5300N902CL','S3000NET5300N903CL','S3000NET5300N904CL','S3000NET5300NAMBCL','S3000NET5300NMMSCL','S3000NET5300NMTSCL','S3000NET5300NPMBCL','S3000NET5300NSAPCL','S3000NET5300NWWPCL','S3000RR3250RR10CL','S3000RR3250RR13CL','S3000RR3250RR23CL','S3000RR3250RR28CL','S3000RR3250RR44CL','S3000RR3250RR46CL','S3000RR3250RR71CL','S3000RR3250RR72CL','S3000RR3250RR84CL','S3000RR3250RR90CL','S3000RR3250RR94CL','S3000RR3250RR98CL','S3000RR3250RRE3CL','S3000RR3250RRE4CL','S3000RR3300RR10CL','S3000RR3300RR12CL','S3000RR3300RR71CL','S3000RR3300RR72CL','S3000RR3300RR84CL','S3000RR3300RR90CL','S3000RR3300RR94CL','S3000RR3300RRE4CL','SSDLS5300ATSCL','SSDLS5300PSCL','SSDLS5300SDCL','SSDLS5300SMBCL')
							)

					 ,staging as 
								(select comb_.*
										,c.LongDescription as SellingGroup_
										,d.LongDescription as FamilyGroup_
										,e.LongDescription as Family_0
										--,tbl.Family as Family_1
										--,f.StandardCost,f.WholeSalePrice
								from comb_ left join JDE_DB_Alan.MasterSellingGroup c on comb_.SellingGroup = c.Code
										 left join JDE_DB_Alan.MasterFamilyGroup d on comb_.FamilyGroup = d.Code
										 left join JDE_DB_Alan.MasterFamily e on comb_.Family = e.Code
								 )

					 ,comb as ( select * from staging )

					 ,fl as (	select comb.ItemNumber,'HD' as BranchPlant,comb.UOM,'BF' as ForcastType
							,comb.Period_YM
							,convert(date,dateadd(d,-1,dateadd(mm,0,convert(datetime,comb.Period_YM+'01',103))),103) as Period_YMD_1		-- to get 'Jde FC Date' Format ie 31/Month/Year,however when FC loaded into Jde, Jde will automatically add 1 day and push FC to Following month, ie 31/1/2018 FC will be push into Month slot of 1/Feb/2018, so here you need to change date again
							,convert(date,dateadd(d,-1,dateadd(mm,1,convert(datetime,comb.Period_YM+'01',103))),103) as Period_YMD_2        -- Current month + 1 month minus 1 day to get last day of same month , to get 'Jde FC Date' Format ie 31/Month/Year, get last day of last month 
							,convert(varchar(10),convert(date,dateadd(d,-1,dateadd(mm,1,convert(datetime,comb.Period_YM+'01',105))),103),103) Period_YMD_3 
							,comb.Typ_
							,comb.Value as Qty
							,comb.Value * comb.WholeSalePrice as Amt_Actual
							,0 as Amt
							,0 as CustomerNumber,'N' as BypassForcing,comb.Pareto 			
							,comb.PlannerNumber,comb.primarysupplier,comb.Owner_
							,comb.Family_0
							from comb

						where comb.Typ_ in ('Adj_FC')
						--where comb.Typ_ in (select splitdata from JDE_DB_Alan.dbo.fnSplitString(@DataType,',')) 
						--  where comb.Typ_ in (select splitdata from JDE_DB_Alan.dbo.fnSplitString(@DataType,',')) 
						--order by Pareto asc,comb.ItemNumber,comb.Typ_,comb.Period_YM

						)

					 select fl.ItemNumber,fl.BranchPlant,fl.UOM,fl.ForcastType
							--,fl.Period_YM
							--,fl.Period_YMD_1,fl.Period_YMD_2
							,fl.Period_YMD_3,fl.Qty,fl.Amt,fl.CustomerNumber,fl.BypassForcing
							--,fl.Amt_Actual,fl.Pareto
					  from fl
					  where fl.Typ_ in ('Adj_FC')
					  order by Pareto asc,fl.ItemNumber,fl.Typ_,fl.Period_YM
					  option (maxrecursion 0)
				
				              

					--,z as (  select fl.ItemNumber,fl.BranchPlant,fl.UOM,fl.ForcastType
							--,fl.Period_YM
							--,fl.Period_YMD_1,fl.Period_YMD_2
						--	,fl.Period_YMD_3,fl.Qty,fl.Amt,fl.CustomerNumber,fl.BypassForcing
							--,fl.Amt_Actual,fl.Pareto
					--  from fl
					--  where fl.Typ_ in ('Adj_FC')
					--  order by Pareto asc,fl.ItemNumber,fl.Typ_,fl.Period_YM
					 -- option (maxrecursion 0)
					 --   )

					--select * from z
					--select distinct z.ItemNumber from z
					--,t as(	select z.ItemNumber,count(z.period_YM) as cnt from z
					      
						--where z.ItemNumber in ('82.691.901')
					--	group by z.ItemNumber
						--order by z.ItemNumber,z.Period_YM
						--having count(z.period_YM) <24
					--	 )

					--select * from t